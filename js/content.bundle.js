(()=>{let e,n=0,t="",o=!1;function r(e,n){const t=document.querySelector(e);t&&(t.click(),setTimeout(n,800))}let a=!1;function c(e){return e.replace(/\r?\n/g," ").replace(/\{([^{}]+)\}/g,((e,n)=>{const t=n.split("|");return t[Math.floor(Math.random()*t.length)]}))}function i(){const e=setInterval((()=>{const n=document.getElementById("messageView");n&&(clearInterval(e),function(e){const n=new MutationObserver((function(e){e.forEach((function(e){"childList"===e.type&&e.addedNodes.length>0&&e.addedNodes.forEach((function(e){setTimeout((()=>{var n;(n=e.querySelectorAll('[data-id="div_LastReceivedMsg_Text"]')).length>0&&n.forEach((e=>{e&&(e.parentElement.parentElement.classList.remove("chat-message"),setTimeout((function(){e.parentElement.parentElement.classList.add("chat-message")}),3e3))}))}),100)}))}))}));n.observe(e,{childList:!0,subtree:!0})}(n))}),1e3)}function s(){document.body.classList.toggle("blur-active"),localStorage.setItem("blurActive",document.body.classList.contains("blur-active"));document.getElementById("blurToggle").innerHTML=document.body.classList.contains("blur-active")?'<span style="font-size: 26px; color: red; font-weight: bold;" class="fa fa-eye"></span>':'<span style="font-size: 26px; color: white; font-weight: bold;" class="fa fa-eye"></span>'}function l(){!function(){const e=document.createElement("button");e.id="blurToggle",e.textContent="Toggle Blur",document.body.insertAdjacentElement("afterbegin",e),e.offsetHeight}(),function(){const e="true"===localStorage.getItem("blurActive");e&&document.body.classList.add("blur-active");const n=document.getElementById("blurToggle");n&&(n.innerHTML=e?'<span style="font-size: 26px; color: red; font-weight: bold;" class="fa fa-eye"></span>':'<span style="font-size: 26px; font-weight: bold; color: white;" class="fa fa-eye"></span>')}();document.getElementById("blurToggle").addEventListener("click",s)}chrome.runtime.onMessage.addListener(((e,n,t)=>{"Thu hồi kết bạn"===e.command?(a=!1,r('[data-translate-inner="STR_TAB_CONTACT"]',(()=>{r('[data-translate-inner="STR_CONTACT_TAB_INVITATION_FRIEND_MANAGE"]',(()=>{setTimeout((()=>{!async function(){for(;!a;){const e=document.querySelectorAll('[data-translate-inner="STR_RECALL_REQUEST"]');if(0===e.length){a=!0;break}const n=e[0];try{const e=n.parentElement.parentElement.parentElement;if(e){e.style.transition="background-color 0.5s ease-in-out",e.style.backgroundColor="rgba(185, 28, 28, 0.5)",e.style.boxShadow="0 0 10px rgba(185, 28, 28, 0.3)",e.style.animation="pulse 1s infinite";const n=document.styleSheets[0];n.insertRule("\n                                @keyframes pulse {\n                                    0% { transform: scale(1); }\n                                    50% { transform: scale(1.02); }\n                                    100% { transform: scale(1); }\n                                }\n                            ",n.cssRules.length)}n.click(),await new Promise((e=>setTimeout(e,500)));const t=document.querySelector(".zl-modal__footer .btn-danger");t&&t.click(),await new Promise((e=>setTimeout(e,2e3)))}catch(e){console.error("Error processing recall request:",e),a=!0}}}()}),200)}))})),t({status:"started"})):"Dừng thu hồi"===e.command&&(a=!0,t({status:"stopped"}))})),chrome.runtime.onMessage.addListener(((e,n,t)=>{"Kết bạn theo gợi ý"===e.command?(a=!1,r('[data-translate-inner="STR_TAB_CONTACT"]',(()=>{r('[data-translate-inner="STR_CONTACT_TAB_INVITATION_FRIEND_MANAGE"]',(()=>{r('[data-translate-inner="STR_CONTACT_TAB_TITLE_RECOMMEND_FRIEND"]',(()=>{setTimeout((()=>{!async function(){for(;!a;){const e=document.querySelectorAll('[data-translate-inner="STR_ADD_FRIEND"]');if(0===e.length){a=!0;break}const n=e[0];try{const e=n.parentElement.parentElement.parentElement;if(e){e.style.transition="background-color 0.5s ease-in-out",e.style.backgroundColor="rgba(0, 255, 0, 0.5)",e.style.boxShadow="0 0 10px rgba(0, 255, 0, 0.5)",e.style.animation="pulse 1s infinite";const n=document.styleSheets[0];n.insertRule("\n                                @keyframes pulse {\n                                    0% { transform: scale(1); }\n                                    50% { transform: scale(1.02); }\n                                    100% { transform: scale(1); }\n                                }\n                            ",n.cssRules.length)}n.click(),await new Promise((e=>setTimeout(e,500))),r('[data-translate-inner="STR_PROFILE_ADD_FRIEND"]',(()=>{})),await new Promise((e=>setTimeout(e,2e3)))}catch(e){console.error("Error processing recall request:",e),a=!0}}}()}),200)}))}))})),t({status:"started"})):"Dừng kết bạn"===e.command&&(a=!0,t({status:"stopped"}))})),window.onload=function(){i()},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",l):l(),setInterval((()=>{$("#frameMain_th").width()>10?$("#container.WEB").animate({width:"54%"},"slow"):$("#container.WEB").animate({width:"100%"},"slow")}),1e3),setTimeout((()=>{$("#container.WEB").stop(!0,!0),$("#frameMain_th").stop(!0,!0);var e=$("#frameMain_th").width();if(0==e){$("#container.WEB").animate({width:"54%"},"slow");const e=document.getElementById("toggleExtensionBtn");e&&($(e).animate({right:"45%"},"slow"),e.innerHTML='<i class="fa fa-chevron-right"></i>'),$("#frameMain_th").animate({width:"45%"},"fast",(function(){document.getElementById("frameMain_th").style.setProperty("width","45%","important")})),$("#frameMain_th").animate({right:"0"},"slow"),chrome.runtime.sendMessage({message:"getActiveTab"},(e=>{if(chrome.runtime.lastError)console.error(chrome.runtime.lastError.message);else if(e.tab){e.tab,chrome.storage.local.set({tabZalo:e.tab},(function(){chrome.runtime.lastError?console.error(chrome.runtime.lastError.message):e.tab}));L();localStorage.getItem("sh_zlast_uid")}}))}}),2e3);var d=document.createElement("iframe");function u(e){var n=document.querySelector("style[data-zl-modal-style]");n||((n=document.createElement("style")).setAttribute("data-zl-modal-style",""),document.head.appendChild(n)),n.textContent=e?".zl-modal { display: none !important; }":".zl-modal { display: block !important; }"}function m(){if(document.getElementById("toggleExtensionBtn"))return;const e=document.createElement("div");e.id="toggleExtensionBtn",e.innerHTML='<i class="fa fa-chevron-right"></i>',Object.assign(e.style,{position:"fixed",top:"50%",right:"0",transform:"translateY(-50%)",width:"24px",height:"40px",backgroundColor:"goldenrod",color:"white",zIndex:"2147483647",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"16px",borderTopLeftRadius:"10px",borderBottomLeftRadius:"10px",boxShadow:"0 0 4px rgba(0,0,0,0.3)"});const n=document.getElementById("frameMain_th");n&&n.offsetWidth>10?(e.style.right="45%",e.innerHTML='<i class="fa fa-chevron-right"></i>'):(e.style.right="0",e.innerHTML='<i class="fa fa-chevron-left"></i>'),e.addEventListener("click",(()=>{const e=document.getElementById("frameMain_th"),n=document.querySelector("#container.WEB"),t=document.getElementById("toggleExtensionBtn"),o=e.offsetWidth;$("#container.WEB").stop(!0,!1),$("#frameMain_th").stop(!0,!1),$(t).stop(!0,!1),o>10?($(e).animate({right:"-800px",width:"0%"},"slow"),$(t).animate({right:"0"},"slow"),$(n).animate({width:"100%"},"slow"),t.innerHTML='<i class="fa fa-chevron-left"></i>'):($(e).show().animate({right:"0",width:"45%"},"slow",(function(){this.style.setProperty("width","45%","important")})),$(t).animate({right:"45%"},"slow"),$(n).animate({width:"54%"},"slow"),t.innerHTML='<i class="fa fa-chevron-right"></i>')})),document.body.appendChild(e)}function g(e){return new Promise((n=>setTimeout(n,e)))}async function b(e,n,t){const o=document.getElementById("contact-search-input");if(o){o.value=e;const r=new Event("input",{bubbles:!0});o.dispatchEvent(r),await g(1e3);const a=document.querySelector('[data-translate-inner="STR_CHAT_SEARCH"]');a&&a.click();const c=document.querySelector('[data-translate-inner="STR_VIEW_MORE_FRIEND"]');c&&c.click(),function(e,n){const t=document.getElementById("searchResultList");if(t){const e=t.querySelector(".virtualized-scroll > div");e&&function(e,n=500){const t=e.scrollTop,o=e.scrollHeight-e.clientHeight,r=o-t,a=performance.now();requestAnimationFrame((function c(i){const s=i-a;if(s>n)return void(e.scrollTop=o);const l=s/n,d=l<.5?4*l*l*l:1-Math.pow(-2*l+2,3)/2;e.scrollTop=t+r*d,requestAnimationFrame(c)}))}(e,1e3)}const o=document.querySelector(".ReactVirtualized__Grid__innerScrollContainer");if(!o)return void console.error("Container not found");const r=e.startsWith("g")?"group-item-":"friend-item-";let a=0;const c=200,i=500;function s(){const t=`${r}${e}`,o=document.getElementById(t);return!!o&&(o.click(),setTimeout((function(){chrome.runtime.sendMessage({task:"OPEN_CHAT_SUCCESS"})}),1e3),setTimeout((function(){E(n,e,"BAN_BE")}),2e3),!0)}function l(){s()||(a+=c,o.scrollTop=a,setTimeout((()=>{a<o.scrollHeight&&l()}),i))}l()}(t,n)}}function h(t,o,r,a,i){const s=document.querySelector('[data-id="btn_Main_AddFrd"]');s?(s.click(),function(t,o,r,a,i){s=async function(s){""!=s&&await async function(e){return new Promise(((n,t)=>{const o=document.querySelector(".z-input-phone.findFriend__input.phone-input");if(!o)return console.error("Phone input container not found"),void t("Phone input container not found");const r=o.querySelector(".phone-iso-picker");if(!r)return console.error("Country picker not found"),void t("Country picker not found");r.click(),setTimeout((async()=>{const o=document.querySelector(".country-picker__list");if(!o)return console.error("Country list not found"),void t("Country list not found");const r=document.querySelector('[data-translate-placeholder="STR_SEARCH_COUNTRY"]');await function(e,n,t=100){return new Promise((o=>{let r=0;const a=setInterval((()=>{if(r<n.length){e.value+=n[r];const t=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(t),r++}else clearInterval(a),o()}),t)}))}(r,e,50);const a=Array.from(o.querySelectorAll(".country-picker__list__item")).find((n=>n.querySelector(".country-picker__list__item__code").textContent===e));if(!a)return console.error(`Country with code ${e} not found`),void t(`Country with code ${e} not found`);a.scrollIntoView({behavior:"smooth",block:"nearest"}),setTimeout((()=>{a.click(),n()}),500)}),500)}))}(s);const l=document.querySelector('[data-id="txt_Main_AddFrd_Phone"]');if(l){l.removeAttribute("readonly"),l.removeAttribute("disabled"),l.value=t;const s=new Event("change",{bubbles:!0});l.dispatchEvent(s),function(t,o,r,a,i){const s=document.querySelector('[data-id="btn_Main_AddFrd_Search"]');s?(s.click(),w((function(){var s=document.querySelector(".error__msg");if(s){let e=s.textContent;var l={status:"block",phone:t,message:e};chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:l})}else a?function(t,o){chrome.storage.local.get(["settings"],(async function(r){if(r.settings)if(r.settings.isDoiTen)setTimeout((()=>{const r=document.querySelector('[data-id="btn_UserProfile_EditAlias"]');r?(r.click(),setTimeout((()=>{const r=document.querySelector('[data-id="txt_AliasPopup_Alias"]');if(r){let a=`${t} - ${r.value}`;1==n&&(a=`${e[1]} - ${e[0]} - ${e[2]}`),r.value=a;const i=new Event("input",{bubbles:!0,cancelable:!0});r.dispatchEvent(i);const s=document.querySelector('[data-translate-inner="STR_CONFIRM"]');s?(s.click(),setTimeout((async()=>{const e=document.querySelector('[data-translate-inner="STR_PROFILE_ADD_FRIEND"]');if(f=await T(),await g(1e3),e)e.click(),setTimeout((function(){chrome.runtime.sendMessage({task:"OPEN_CHAT_SUCCESS"})}),1e3),setTimeout((function(){p(c(o.replace(/#anhchi/g,f)),t)}),2e3);else{if(document.querySelector('[data-translate-inner="STR_UNDO_REQUEST"]')){const e={status:"error",phone:t,message:"Số điện thoại này đã gởi kết bạn trước đó."};chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:e})}else if(document.querySelector('[data-translate-inner="STR_CHAT"]')){const e={status:"ok",phone:t,message:"Số điện thoại này đã là bạn bè."};chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:e})}else{const e={status:"error",phone:t,message:"Lỗi, Số điện thoại này chặn kết bạn."};chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:e})}const e=document.querySelector('[data-id="btn_Main_AddFrd"]');e&&e.click()}}),1e3)):console.error("Xác nhận button not found")}else console.error("Input edit name not found")}),1e3)):console.error("Edit button not found")}),1e3);else{const e=document.querySelector('[data-translate-inner="STR_PROFILE_ADD_FRIEND"]');if(f=await T(),await g(1e3),e)e.click(),setTimeout((function(){chrome.runtime.sendMessage({task:"OPEN_CHAT_SUCCESS"})}),1e3),setTimeout((function(){p(c(o.replace(/#anhchi/g,f)),t)}),2e3);else{if(document.querySelector('[data-translate-inner="STR_UNDO_REQUEST"]')){const e={status:"error",phone:t,message:"Số điện thoại này đã gởi kết bạn trước đó."};chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:e})}else if(document.querySelector('[data-translate-inner="STR_CHAT"]')){const e={status:"ok",phone:t,message:"Số điện thoại này đã là bạn bè."};chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:e})}else{const e={status:"error",phone:t,message:"Lỗi, Số điện thoại này chặn kết bạn."};chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:e})}const e=document.querySelector('[data-id="btn_Main_AddFrd"]');e&&e.click()}}}))}(t,o):async function(e,n,t,o){const r=document.querySelector('[data-translate-inner="STR_CHAT"]');if(r){if(t){var a=document.querySelector(".pi-mini-info-section__name").textContent,c={status:"ok",phone:{phone:e,username:a},message:"OK"};chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:c});const n=document.querySelector('[data-id="btn_Main_AddFrd"]');return void(n&&n.click())}f=await T(),await g(1e3),r.click(),setTimeout((function(){chrome.runtime.sendMessage({task:"OPEN_CHAT_SUCCESS"})}),1e3),chrome.storage.local.get(["settings"],(function(t){if(t.settings){let r=1e3*t.settings.delay3;setTimeout((function(){E(n,e,"KHACH_HANG",o)}),r)}}))}else{c={status:"error",phone:e,message:"Số điện thoại này chưa đăng ký tài khoản hoặc không cho phép tìm kiếm."},chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:c});const n=document.querySelector('[data-id="btn_Main_AddFrd"]');n&&n.click()}}(t,o,r,i)}),1e3)):console.error("Search Button not found")}(t,o,r,a,i)}else console.error("Không tìm thấy chỗ điền")},l="",chrome.storage.local.get(["countryCode"],(function(e){e.countryCode?(e.countryCode,s(e.countryCode)):s(l)}));var s,l}(t,o,r,a,i)):console.error("Button not found")}d.id="frameMain_th",d.src=chrome.runtime.getURL("../page/login.html"),document.body.insertBefore(d,document.body.firstChild),document.addEventListener("drop",(e=>{})),u(!0),chrome.runtime.onMessage.addListener(((e,n,t)=>{var o;if("CHANGE_PAGE"===e.task&&(o=e.page,d.src=chrome.runtime.getURL(o),o.includes("popup")&&setTimeout((()=>{L(),localStorage.getItem("sh_zlast_uid")}),800)),"click_send_button"===e.task){const e=document.querySelector('[data-translate-title="STR_SEND"]');e&&e.click()}"SHOW_HIDE_APP"===e.task&&function(e){var n=e.status;const t=document.getElementById("blurToggle"),o=document.querySelector(".zl-modal");!0===n?(t.style.display="none",o&&o.style.setProperty("left","0","important")):(o&&o.style.setProperty("left","-450px","important"),t.style.display="block");const r=document.getElementById("toggleExtensionBtn");$("#container.WEB").stop(!0,!0),$("#frameMain_th").stop(!0,!0),r&&$(r).stop(!0,!0),0==$("#frameMain_th").width()?($("#container.WEB").animate({width:"54%"},"slow"),r&&($(r).animate({right:"45%"},"slow"),r.innerHTML='<i class="fa fa-chevron-right"></i>'),$("#frameMain_th").css("display","none").animate({width:"0%"},0).fadeIn("fast",(function(){$(this).animate({width:"45%"},"slow",(function(){this.style.setProperty("width","45%","important")}))})).animate({right:"0"},"slow")):(r&&($(r).animate({right:"0"},"slow"),r.innerHTML='<i class="fa fa-chevron-left"></i>'),$("#frameMain_th").animate({right:"-800px"},"slow",(function(){$(this).fadeOut("fast",(function(){this.style.setProperty("width","0%","important")}))})),$("#container.WEB").animate({width:"100%"},"slow"))}(e)})),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",m):m();let f="";function p(e,n){if(""!==e){const n=document.querySelector('[data-translate-placeholder="STR_PROFILE_ENTER_GREETING"]');if(n){n.placeholder="",n.contentEditable="true",n.classList.remove("empty"),n.value=e;const t=new Event("input",{bubbles:!0,cancelable:!0});n.dispatchEvent(t)}}const t=document.querySelector('[data-translate-inner="STR_PROFILE_ADD_FRIEND"]');if(t){var o=document.querySelector(".pi-mini-info-section__name").textContent,r={status:"ok",phone:n,type:"KHACH_HANG",message:`Đã gửi kết bạn đến: ${o}`};chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:r}),t.click()}}function _(e){const n=document.querySelectorAll(".popover-v3 .zmenu-item");for(let t of n)if(t.innerText.trim()===e)return t.click(),!0;return!1}function v(e,n){return e.replace(/#([\w-]+)(?::([\w\d]+))?/g,((e,t,o)=>{if(/^\d$/.test(t))return e;return function(e,n){if(!e)return"";const t=e.trim().split(/\s+/);if(!n||"full"===n)return e;if("first"===n)return t[0];if("last"===n)return t[t.length-1];const o=n.match(/^first(\d+)$/),r=n.match(/^last(\d+)$/);if(o){const e=parseInt(o[1],10);return t.slice(0,e).join(" ")}if(r){const e=parseInt(r[1],10);return t.slice(-e).join(" ")}return e}(n[t]||"",o)}))}function y(e){const n=document.getElementById("ava_chat_box_view");n&&(n.click(),setTimeout((()=>{const n=document.querySelector('[data-translate-inner="STR_DELETE_FRIEND"]');n&&(n.click(),setTimeout((()=>{const n=document.querySelector('[data-id="btn_ConfirmDel_Del"]');n&&(n.click(),setTimeout((()=>{!function(){const e=document.querySelector(".zl-modal__container .modal-header-icon i.fa-close");if(e){e.click();const n=new MouseEvent("mousedown",{bubbles:!0,cancelable:!0}),t=new MouseEvent("mouseup",{bubbles:!0,cancelable:!0});e.dispatchEvent(n),e.dispatchEvent(t)}}();var n=document.querySelector(".header-title").textContent.trim(),t={status:"ok",phone:e,type:"BAN_BE",message:`Đã hủy kết bạn: ${n} thành công.`};chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:t})}),500))}),1e3))}),1e3))}async function E(r,a,i,s){if(o)return void y(a);const l=document.getElementById("richInput");e=s,l.placeholder="",l.contentEditable="true",l.classList.remove("empty"),f=await T(),chrome.storage.local.get(["IS_PHAT_CODE","IS_GUI_HOA_DON","settings"],(function(o){var d=o.IS_PHAT_CODE;n=o.IS_GUI_HOA_DON;var u=o.settings.isKetBanNhom;1==d&&(r=s[1]);var m=0;r.startsWith("@@")?(m=2,r=r.substring(2)):r.startsWith("@")&&(m=1,r=r.substring(1));var g=document.querySelector(".header-title").textContent;l.textContent="";var b=S(r);const h={anhchi:f,khachhang:g};if(1==n&&(b=b.replace(/#(\d+)/g,((n,t)=>e[parseInt(t,10)]))),b=v(b,h),1==u)return r=v(r,h),void function(e,n){const t=document.querySelector('[data-translate-inner="STR_FRIEND_REQ_SEND"]');if(t)t.click(),setTimeout((function(){const t=document.querySelector('[data-translate-placeholder="STR_PROFILE_ENTER_GREETING"]');if(t){t.placeholder="",t.contentEditable="true",t.classList.remove("empty"),t.value=n;const o=new Event("input",{bubbles:!0,cancelable:!0});t.dispatchEvent(o),setTimeout((function(){const n=document.querySelector('[data-translate-inner="STR_PROFILE_ADD_FRIEND"]');if(n){n.click();var t={status:"ok",phone:e,type:"BAN_BE",message:"Đã gửi kết bạn thành công."};chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:t}),setTimeout((function(){chrome.storage.local.get(["TAG_PHANLOAI"],(function(e){const n=document.querySelector('[data-translate-title="STR_LABEL_CLASS"]');var t=e.TAG_PHANLOAI;"-1"!=t&&(n.click(),_(t))}))}),1e3)}else t={status:"error",phone:e,type:"BAN_BE",message:"Gởi kết bạn thất bại."},chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:t})}),1500)}}),1e3);else{var o={status:"error",phone:e,type:"BAN_BE",message:"Gởi kết bạn thất bại."};chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:o})}}(a,r);var p=c(b).trim();1===m?(l.innerHTML=" ",r=v(r,h),1==n&&(r=r.replace(/#(\d+)/g,((e,n)=>s[parseInt(n,10)]))),t=c(r)):2===m?(l.innerHTML=p,r=v(r,h),1==n&&(r=r.replace(/#(\d+)/g,((e,n)=>s[parseInt(n,10)]))),t=c(r)):(l.innerHTML=p,t="");const y=new Event("input",{bubbles:!0,cancelable:!0});l.dispatchEvent(y);const E=document.querySelector('[data-translate-title="STR_SEND"]');if(E)if("BAN_BE"===i){E.click(),setTimeout((function(){chrome.storage.local.get(["TAG_PHANLOAI"],(function(e){var n=document.querySelector("i.fa.fa-solid-tag");n||(n=document.querySelector('[data-translate-title="STR_LABEL_CLASS"]'));var t=e.TAG_PHANLOAI;"-1"!=t&&(n.click(),_(t))}))}),10),setTimeout((()=>{var e=$("#messageViewContainer").text();if(e.toLowerCase().includes("chặn không nhận tin nhắn từ người lạ."))var n={status:"error",phone:a,type:i,message:`${g}/${a} chặn nhận tin nhắn từ người lạ.`};else if(e.toLowerCase().includes("tài khoản đã ngừng hoạt động."))n={status:"error",phone:a,type:i,message:`${g}/${a} Tài khoản đã ngừng hoạt động.`};else if(e.toLowerCase().includes("tài khoản này đang bị vô hiệu hóa và tạm thời không thể nhận tin nhắn"))n={status:"error",phone:a,type:i,message:`${g}/${a} Tài khoản này đang bị vô hiệu hóa và tạm thời không thể nhận tin nhắn.`};else n={status:"ok",phone:a,type:i,message:`Đã gửi tin nhắn đến: ${g}`};chrome.storage.local.get(["settings"],(function(e){if(e.settings){let n=e.settings.isTuDongKetBan;e.settings.isDoiTen;1==n&&w(k,1500)}})),chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:n})}),1500)}else"KHACH_HANG"==i&&chrome.storage.local.get(["settings"],(function(t){if(t.settings){t.settings.isDoiTen?setTimeout((()=>{const t=document.querySelector('[data-translate-title="Chỉnh sửa"]');t?(t.click(),setTimeout((()=>{const t=document.querySelector('[data-id="txt_AliasPopup_Alias"]');if(t){let o=`${a} - ${t.value}`;1==n&&(o=`${e[1]} - ${e[0]} - ${e[2]}`),t.value=o;const r=new Event("input",{bubbles:!0,cancelable:!0});t.dispatchEvent(r);const c=document.querySelector('[data-translate-inner="STR_CONFIRM"]');c?(c.click(),setTimeout((()=>{E.click(),setTimeout((()=>{if($("#messageViewContainer").text().toLowerCase().includes("chặn không nhận tin nhắn từ người lạ."))var e={status:"error",phone:a,type:i,message:`${g}/${a} chặn nhận tin nhắn từ người lạ.`};else e={status:"ok",phone:a,type:i,message:`Đã gửi tin nhắn đến: ${g}`};chrome.storage.local.get(["settings"],(function(e){if(e.settings){1==e.settings.isTuDongKetBan&&w(k,1500)}})),chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:e})}),1e3)}),1e3)):console.error("Xác nhận button not found")}else console.error("Input edit name not found")}),1e3)):console.error("Edit button not found")}),1e3):(E.click(),setTimeout((()=>{if($("#messageViewContainer").text().toLowerCase().includes("chặn không nhận tin nhắn từ người lạ."))var e={status:"error",phone:a,type:i,message:`${g}/${a} chặn nhận tin nhắn từ người lạ.`};else e={status:"ok",phone:a,type:i,message:`Đã gửi tin nhắn đến: ${g}`};chrome.storage.local.get(["settings"],(function(e){if(e.settings){1==e.settings.isTuDongKetBan&&w(k,1500)}})),chrome.runtime.sendMessage({task:"TRANGTHAI_SEND_MESSAGE",data:e})}),1e3))}}))}))}function k(){const e=document.querySelector('[data-translate-inner="STR_FRIEND_REQ_SEND"]');e&&(e.click(),setTimeout((function(){if(""!==t){const e=document.querySelector('[data-translate-placeholder="STR_PROFILE_ENTER_GREETING"]');if(e){e.placeholder="",e.contentEditable="true",e.classList.remove("empty"),e.value=t;const n=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(n)}}setTimeout((()=>{const e=document.querySelector('[data-translate-inner="STR_PROFILE_ADD_FRIEND"]');e&&(e.click(),setTimeout((function(){chrome.storage.local.get(["TAG_PHANLOAI"],(function(e){var n=e.TAG_PHANLOAI;const t=document.querySelector('[data-translate-title="STR_LABEL_CLASS"]');"-1"!=n&&(t.click(),_(n))}))}),1e3))}),1e3)}),1e3))}function S(e){const n=e.split("\n");let t="";return n.forEach(((e,n)=>{t+=`<div id="input_line_${n}"><span class="" data-mention="${e}" id="input_part_${n}" style="white-space: pre-wrap;">${e}</span></div>`})),t}function w(e,n){setTimeout(e,n)}async function T(){const e=document.querySelector(".pi-info-section__info-list");if(!e)return"Anh/Chị";const n=Array.from(e.querySelectorAll(".pi-info-item")).find((e=>"Giới tính"===e.querySelector(".pi-info-item__title")?.textContent.trim()));if(!n)return"Anh/Chị";const t=n.querySelector(".pi-info-item__desc")?.textContent.trim();return"Nam"===t?"Anh":"Nữ"===t?"Chị":"Anh/Chị"}function A(e){const n=e.target;if(n!==document.body)if("mouseover"===e.type){n.style.border="1px solid #9254de",n.style.borderRadius="8px",n.style.backgroundColor="#9a3bda";!function(e,n){const t=document.createElement("div");t.className="mytooltip",t.textContent=n,document.body.appendChild(t);const o=e.getBoundingClientRect(),r=window.pageXOffset||document.documentElement.scrollLeft,a=window.pageYOffset||document.documentElement.scrollTop;t.style.left=o.left+r+"px",t.style.top=o.top+a+"px"}(n,x(n))}else n.style.border="",n.style.borderRadius="0px",n.style.backgroundColor="",function(){const e=document.querySelector(".mytooltip");e&&e.remove()}()}function I(e){const n=e.target;if(n!==document.body){const e=x(n);document.body.removeEventListener("mouseover",A),document.body.removeEventListener("mouseout",A),document.body.removeEventListener("click",I,!0),chrome.runtime.sendMessage({task:"CHON_XONG_NOIDUNG",data:e})}}function x(e){if(""!==e.id)return`//*[@id="${e.id}"]`;if(e===document.body)return"/html/"+e.tagName.toLowerCase();let n=0;const t=e.parentNode.childNodes;for(let o=0;o<t.length;o++){const r=t[o];if(r===e)return`${x(e.parentNode)}/${e.tagName.toLowerCase()}[${n+1}]`;1===r.nodeType&&r.tagName===e.tagName&&n++}}function R(e,n){const t=`[${e}="${n}"]`,o=document.querySelector(t);o&&o.click()}let N=!1;async function C(e,n,t,o,r,a){if(N)return;const c=document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;if(!c)return;c.textContent;const i=new MouseEvent("mouseover",{view:window,bubbles:!0,cancelable:!0});c.dispatchEvent(i),await new Promise((e=>setTimeout(e,1500)));const s=document.getElementById("messageViewContainer").querySelectorAll('[data-translate-title="STR_FORWARD_MSG"]');if(s.length>0){s.forEach((e=>e.click())),await new Promise((e=>setTimeout(e,500)));const b=function(){const e=document.querySelectorAll("#zl-modal__dialog-body");let n=null;for(const t of e){const e=t.querySelector("#richInput");if(e){n=e;break}}return n}();if(b){b.placeholder="",b.contentEditable="true",b.classList.remove("empty"),b.textContent="";var l=S(r);b.innerHTML=l;const A=new Event("input",{bubbles:!0,cancelable:!0});b.dispatchEvent(A)}o&&o.length>0&&!a&&(await function(e,n){const t=document.querySelector(".zl-modal__container");if(t){const o=`[${e}="${n}"]`,r=t.querySelector(o);r&&r.click()}}("data-translate-inner","STR_LABEL_CLASS_2"),await new Promise((e=>setTimeout(e,500))),await function(e){const n=document.querySelector(".popover-v3");n&&(e.forEach((e=>{const t=Array.from(n.querySelectorAll(".zmenu-item .truncate")).find((n=>n.textContent.trim()===e));t&&t.closest(".zmenu-item").click()})),n.style.display="none")}(o),await new Promise((e=>setTimeout(e,500)))),await R("data-translate-inner","STR_CONTACT_FRIENDS"),await new Promise((e=>setTimeout(e,500)));const h=await(g='div[data-id="div_SpamMsg_Thread"]',new Promise(((e,n)=>{const t=document.querySelector(g);if(t)return e(t);const o=new MutationObserver((n=>{n.forEach((n=>{const t=Array.from(n.addedNodes);for(const n of t)if(1===n.nodeType&&n.matches(g))return o.disconnect(),e(n)}))}));o.observe(document.documentElement,{childList:!0,subtree:!0}),setTimeout((()=>{o.disconnect(),n(new Error(`Element with selector "${g}" not found within the time limit.`))}),3e4)}))),f=h.querySelector(".ReactVirtualized__Grid__innerScrollContainer"),p=h.querySelector(".ReactVirtualized__Grid");let _=[],v=-1,y=0;const E=t,k=1,w=48,T=29;function d(e){e.closest(".share-msg__conv-item").click()}function u(){const e=Array.from(f.querySelectorAll(".share-msg__conv-item__check-box"));let n=!1;return e.forEach((e=>{_.includes(e)||(_.push(e),n=!0)})),n}function m(e){return new Promise((n=>{const t=setInterval((()=>{const o=e-p.scrollTop,r=Math.sign(o)*Math.min(Math.abs(o),w/2);p.scrollTop+=r,Math.abs(p.scrollTop-e)<=Math.abs(r)&&(clearInterval(t),n())}),2)}))}p.addEventListener("scroll",(()=>{setTimeout(u,50)})),await async function(e){const{startingIndex:n,currentPosition:t}=function(e){const n=Array.from(f.querySelectorAll(".share-msg__char-item"));let t=0,o=0;for(let r=0;r<n.length;r++){const a=parseInt(n[r].style.top.replace("px",""),10),c=r===n.length-1?1/0:parseInt(n[r+1].style.top.replace("px",""),10);if(a<=e*w&&c>e*w){t=Math.floor((e*w-a)/w),o=a+T;break}}return{startingIndex:t+e,currentPosition:o}}(e);for(v=n-1,p.scrollTop=t;y<E;){if(N)return;for(u();v+k>=_.length;){if(N)return;await m(p.scrollTop+w*k),await new Promise((e=>setTimeout((()=>{u(),e()}),5)))}for(let e=0;e<k;e++){if(N)return;if(v++,!(v<_.length&&y<E))break;d(_[v]),y++}}R("data-translate-inner","STR_FORWARD"),await new Promise((e=>setTimeout(e,3e3)))}(n)}var g}function L(){const e=document.querySelector(".nav__tabs__zalo.web");return{name:e.getAttribute("title"),avatarUrl:e.querySelector(".zavatar img").getAttribute("src")}}async function M(e,n){const t=await le(`zdb_${e}`),o=indexedDB.open(t);o.onsuccess=e=>{const t=e.target.result;let o=t.transaction(["friend"],"readonly"),r=o.objectStore("friend"),a=r.getAll();a.onsuccess=e=>{const c=e.target.result;o=t.transaction(["label"],"readonly"),r=o.objectStore("label"),a=r.getAll(),a.onsuccess=e=>{let t=e.target.result;const o={};c.forEach((e=>{o[e.userId]=e.userId})),c.forEach((e=>{t.forEach((n=>{n.conversations.some((n=>o[n]===e.userId))&&(e.tag=n.text)}))})),"excel"==n?chrome.runtime.sendMessage({task:"DATA_LIST_FRIEND_RECEIVED_EXPORT",friends:c}):"txt"==n?chrome.runtime.sendMessage({task:"DATA_LIST_FRIEND_RECEIVED_EXPORT_TXT",friends:c}):chrome.runtime.sendMessage({task:"DATA_LIST_FRIEND_RECEIVED_EXPORT_TXT_TEN",friends:c})}},a.onerror=e=>{console.error("Error reading all entries:",e)}},o.onerror=e=>{console.error("Error opening database:",e)}}async function D(e,n){const t=await le(`zdb_${e}`),o=indexedDB.open(t);o.onsuccess=t=>{const o=t.target.result;let r=o.transaction(["friend"],"readonly"),a=r.objectStore("friend"),c=a.getAll();c.onsuccess=t=>{var i=t.target.result;i=i.filter((e=>!(0===e.isValid||1===e.isBlocked||0!==e.accountStatus))),r=o.transaction(["label"],"readonly"),a=r.objectStore("label"),a.getAll().onsuccess=t=>{let s=t.target.result;const l={};i.forEach((e=>{l[e.userId]=e.userId})),i.forEach((e=>{e.tag="Không có nhãn"})),s.forEach((e=>{i.forEach((n=>{e.conversations.some((e=>l[e]===n.userId))&&(n.tag=e.text)}))})),i.length=0,r=o.transaction(["group"],"readonly"),a=r.objectStore("group"),c=a.getAll(),c.onsuccess=t=>{const o=t.target.result;o.forEach((e=>{e.tag="NHÓM VÀ CỘNG ĐỒNG"})),o.forEach((t=>{if("1"==n)t.creatorId==e?i.push(t):t.topMember.forEach((n=>{n.id==e&&n.isAdmin&&i.push(t)}));else{if(t.creatorId==e)return;{let n=!0;t.topMember.forEach((t=>{t.id==e&&t.isAdmin&&(n=!1)})),n&&i.push(t)}}})),chrome.runtime.sendMessage({task:"DATA_LIST_FRIEND_RECEIVED",friends:i,isGroup:1})}}},c.onerror=e=>{console.error("Error reading all entries:",e)}},o.onerror=e=>{console.error("Error opening database:",e)}}function z({running:e}){const n=document.querySelector(".n2-custome-zalo-theme");if(n&&document.head.removeChild(n),e){const e=document.createElement("style");e.classList.add(B),e.innerHTML='\n    :root {\n      --n2-sidebar-bg-color: #333;\n      --n2-main-bg-color: #444;\n      --n2-primary-color: #e4e6eb;\n      --n2-neutral-color: #234;\n      --primary-text: #e4e6eb;\n      --NG60: #e4e6eb;\n      --N300: #e4e6eb;\n      --NG10: #333;\n      --NG70: #e4e6eb;\n      --WA100: #444;\n      --n2-loading-bg-color: #333;\n      --n2-sidebar-hover-bg-color: #444;\n      --n2-hr-color: #222;\n      --n2-white-opacity-bg-color: rgba(244, 244, 244, 0.4);\n      --n2-359bed-opacity-color: rgba(53, 155, 237, 0.3);\n      --n2-mention-color: #eff;\n      --n2-mention-bg-color: rgba(0, 139, 139, 0.4);\n      --n2-not-me-msg-background: #233;\n      --n2-not-me-msg-box-shadow: #141e1e;\n      --n2-me-msg-background: #277dbf;\n      --n2-me-msg-box-shadow: #216aa1;\n      --n2-sender-name-color: #9f8424;\n      --n2-time-color: #bbb;\n      --neutral-300: #e4e6eb;\n      --neutral-400: #d5d8e0;\n      --neutral-500: #9ba2b5;\n      --black-base: var(--neutral-300);\n      --black-600: var(--neutral-400);\n      --neutral-base: #e4e6eb;\n      --grey-base: #444;\n      --grey-600: #2b2b2b;\n      --item-wa-hover: #2b2b2b;\n      --lst-item-hover: #2b2b2b;\n      --lst-item-select: #2b2b2b;\n      --text-primary: #e4e6eb;\n      --layer-background-selected: #2b2b2b;\n      --layer-background-hover: #2b2b2b;\n      --layer-background-disabled: #444;\n      --text-secondary: #c8bccb;\n      --layer-background: #333;\n      --layer-background-subtle: #444;\n      --button-neutral-text: #e4e6eb;\n      --button-neutral-normal: #234;\n      --button-tertiary-neutral-focus-bg: #234;\n      --button-neutral-hover: #111a22;\n      --surface-background-subtle: #333;\n      --blue-message: #444;\n      --WA80: #333;\n      --layer-information-background: #444;\n      --layer-background-inverse: #201D1D;\n      --button-tertiary-neutral-text: #e7e7e7;\n    }\n    body,\n    html {\n      background-color: #444;\n      color: #e4e6eb;\n      text-shadow: 0 0 1px currentColor;\n    }\n    ::selection {\n      background: #ff9100;\n      color: #000;\n    }\n    \n    .list-chat-box-banner{\n       background-color: var(--layer-background-inverse);\n    }\n    #loading-page {\n      background-color: var(--n2-loading-bg-color);\n      color: var(--n2-primary-color);\n    }\n    aside {\n      border-color: var(--n2-hr-color);\n    }\n    .btn,\n    .subtitle {\n      color: #fff;\n    }\n    #app #chatOnboard,\n    #app #chatOnboard .chat-onboard,\n    #app #chatOnboard .chat-onboard * {\n      background-color: var(--n2-sidebar-bg-color);\n      color: var(--n2-primary-color);\n    }\n    #chatViewContainer {\n      color: var(--n2-primary-color);\n    }\n    .message-view__blur__overlay {\n      background-color: #222;\n    }\n    #chatViewContainer #header,\n    #chatViewContainer #header .title.header-title,\n    #chatViewContainer #header .icon-only {\n      background-color: #2b2b2b;\n      color: var(--n2-primary-color);\n    }\n    #chatViewContainer #header .truncate {\n      background-color: brown;\n      padding: 0.2em 0.8em;\n      border-radius: 3px;\n      color: var(--n2-primary-color) !important;\n    }\n    .leftbar-tab {\n      color: #e4e6eb;\n    }\n    #filter-tags-sb .filter-tag-item.--activated {\n      color: #e4e6eb;\n    }\n    .main-title-container .lock-icon {\n      background-color: rgba(0, 0, 0, 0);\n    }\n    .chat-message,\n    .chat-message a {\n      color: var(--n2-primary-color);\n    }\n    .card {\n      border-radius: 0.3em;\n    }\n    .chat-message.highlighted .card:not(.card--group-photo) {\n      background-color: var(--n2-not-me-msg-background);\n      border: solid 2px #ff4500;\n    }\n    .me.chat-message.highlighted .card:not(.card--group-photo) {\n      background-color: var(--n2-me-msg-background);\n    }\n    .chat-message .card-sender-name,\n    .chat-message .card.card--text.show-sender > .card-sender-name {\n      color: var(--n2-sender-name-color);\n    }\n    .card,\n    .card[data-id="div_ReceivedMsg_Text"],\n    .card[data-id="div_LastReceivedMsg_Text"],\n    .card.card--oa > .oa-msg-child,\n    .card.card--oa > .oa-msg-header,\n    .img-msg-v2.-bg-v-1 .img-msg-v2__bub > .img-msg-v2__th,\n    .img-msg-v2.-caption.-me > .img-msg-v2__bub,\n    .card.card--text:not(.me) {\n      background-color: var(--n2-not-me-msg-background);\n      color: var(--n2-primary-color);\n      box-shadow: 0 0 3px var(--n2-not-me-msg-box-shadow);\n    }\n    .card.me,\n    .card.me[data-id="div_SentMsg_Text"],\n    .card.me[data-id="div_LastSentMsg_Text"],\n    .chat-message.me .img-msg-v2.-bg-v-1 .img-msg-v2__bub > .img-msg-v2__th,\n    .chat-message.me .img-msg-v2.-caption.-me > .img-msg-v2__bub,\n    .card.card--text.me {\n      background-color: var(--n2-me-msg-background);\n      box-shadow: 0 0 3px var(--n2-me-msg-box-shadow);\n      color: var(--n2-primary-color);\n    }\n    .call-msg {\n      border-style: none;\n    }\n    .card.card--sticker {\n      background-color: rgba(0, 0, 0, 0);\n      box-shadow: none;\n    }\n    .card-send-time {\n      color: var(--neutral-500);\n    }\n    a.mention-name,\n    .card.card--text .mention-name,\n    .card.card--text a.mention-name {\n      padding: 0em 0.2em;\n      color: var(--n2-mention-color);\n      display: inline-flex;\n      align-items: center;\n      justify-content: center;\n      text-decoration: none;\n      font-weight: 600;\n    }\n    .card .rel.quote-banner {\n      background-color: var(--n2-white-opacity-bg-color) !important;\n    }\n    .card .rel.quote-banner .quote-banner-content .quote-text {\n      color: var(--n2-primary-color);\n    }\n    .card .message-reaction-container .reacts-list,\n    .img-msg-v2 .reacts-list {\n      background-color: var(--n2-sidebar-bg-color);\n    }\n    .card .message-reaction-container .msg-reaction-icon {\n      background-color: var(--n2-sidebar-bg-color);\n    }\n    .card.card--text a,\n    .card.card--link a {\n      padding: 0.1em 0.5em;\n      color: var(--n2-primary-color);\n      text-decoration: underline;\n    }\n    .chat-input,\n    .chat-input__content {\n      background-color: var(--n2-hr-color);\n      border-color: var(--n2-hr-color);\n    }\n    .chat-input.highlight,\n    .chat-input__content.highlight {\n      background-color: var(--n2-sidebar-bg-color);\n      border-color: var(--n2-hr-color);\n    }\n    #ztoolbar.chat-input-v2,\n    #ztoolbar.chat-input-v2 .z--btn.icon-only {\n      background-color: #222;\n      color: var(--n2-primary-color);\n    }\n    .chat-input-container {\n      color: var(--n2-primary-color);\n    }\n    .doing-something {\n      color: var(--n2-primary-color);\n      background-color: var(--n2-hr-color);\n    }\n    .img-msg-v2.-caption:not(.-me) > .img-msg-v2__bub {\n      background-color: var(--n2-not-me-msg-background);\n    }\n    .chat-date > span {\n      background-color: rgba(0, 0, 0, 0);\n      border: solid 1px #3a3939;\n    }\n    .chat-message-v2.multi-select-mode-selected .audio-expired, .chat-message-v2.multi-select-mode-selected .card {\n        background-color: #7d0a0a;\n    }\n    .chat-date .line {\n      border-color: #3a3939;\n    }\n    .card-send-time {\n      color: #d1d1d1;\n    }\n    .card--group-photo.-bg-v-1 .card--group-photo__row__item__img,\n    .card--group-photo.-bg-v-1 .card--group-photo__row__item__img.undo {\n      background-color: #2b2b2b;\n    }\n    .call-msg.--callee {\n      background-color: #2b2b2b;\n    }\n    .chat-message .extra-btn {\n      background-color: #2b2b2b;\n      color: #e4e6eb;\n    }\n    .chat-message .extra-btn:hover {\n      color: #e4e6eb;\n    }\n    .sticker-selector__menu__scrollbar,\n    .sticker-selector__menu__scrollbar .emoji-icons.active,\n    .sticker-selector__menu__scrollbar .emoji-icons,\n    .sticker-selector__menu__scrollbar .sticker-recent,\n    .sticker-selector__menu__scrollbar .sticker-recent-active,\n    #gifSelector,\n    #gifSelector .gif-content {\n      background-color: #444 !important;\n      color: #fff;\n    }\n    .ReactVirtualized__Grid__innerScrollContainer {\n      background-color: #444 !important;\n      color: #fff !important;\n    }\n    .card.card--undo > span {\n      color: gray;\n    }\n    .chat-date {\n      color: var(--n2-time-color);\n    }\n    .image-show__bottom__sender__info {\n      color: var(--n2-primary-color);\n    }\n    .image-show__bottom__ctrl > .btn,\n    .image-show__bottom__ctrl > a > .btn {\n      color: var(--n2-primary-color);\n    }\n    .image-show__icon-fullscreen {\n      color: var(--n2-primary-color);\n    }\n    .image-show__btn__inside {\n      color: var(--n2-primary-color);\n    }\n    .timeline-slider__handle {\n      background-color: var(--n2-primary-color);\n    }\n    .td-msg-v3 {\n      background-color: var(--n2-sidebar-bg-color);\n    }\n    .card-send-time__sendTime.bubble-message-time {\n      color: var(--n2-time-color);\n    }\n    .chat-content .bubble-message-status {\n      color: var(--n2-time-color);\n    }\n    .card-send-time .card-send-time__sendTime {\n      color: var(--n2-time-color);\n    }\n    #chatViewContainer .message-view__banner,\n    #chatViewContainer .message-view__banner .message-view__banner__text,\n    .chat-group-topic *,\n    .group-poll-info .group-poll-info-msg-info,\n    .group-poll-info .group-poll-info-more,\n    .group-poll-info .group-poll-info-body,\n    .group-poll-info .group-poll-info-body .group-poll-info-title {\n      background-color: var(--n2-sidebar-bg-color) !important;\n      color: var(--n2-primary-color) !important;\n    }\n    .group-poll-info-content-item {\n      background-color: #565656;\n    }\n    .group-poll-info .group-poll-info-body .group-poll-info-content-item-progress,\n    .group-poll-vote-content-item-progress {\n      background-color: #008b8b;\n    }\n    #chatViewContainer .group-topic:before,\n    #chatViewContainer .message-view__banner:before,\n    #chatViewContainer .msgbannerbf {\n      border-bottom: solid 1px var(--n2-main-bg-color);\n    }\n    #chatViewContainer .chat-group-topic__item.border-two-sided {\n      border-color: var(--n2-main-bg-color);\n    }\n    #message-view__blur {\n      display: none;\n    }\n    .message-view:after,\n    .message-view:before {\n      border-color: var(--n2-hr-color);\n    }\n    .message-view #ztoolbar.chat-input-v2 {\n      background-color: var(--n2-main-bg-color);\n    }\n    .zl-dlg-paper,\n    .zl-fl-dlg > .zl-fl-dlg__paper,\n    .zl-modal__dialog,\n    .tab-main.border-bottom,\n    .zl-modal__dialog__header,\n    .group-setting__disable-banner {\n      background-color: var(--n2-sidebar-bg-color);\n      border-color: #2b2b2b;\n    }\n    .zl-modal__dialog__header__title-text {\n      color: #fff;\n    }\n    .event-message > div,\n    .onboard-message > div {\n      background-color: #303030;\n    }\n    .cloud__header {\n      background-color: #444;\n    }\n    .snack-body {\n      background-color: #222;\n      border: solid 3px #999;\n      box-shadow: none;\n      color: #fff;\n    }\n    .z-tooltip {\n      background-color: #444;\n      color: #e4e6eb;\n    }\n    .friend-profile__detail__line {\n      border-color: rgba(0, 0, 0, 0);\n    }\n    .friend-profile__footer__content {\n      border-color: #201d1d;\n    }\n    .user-profile-footer-button:hover:not(.disabled-btn) {\n      color: #e4e6eb;\n      background-color: #2b2b2b;\n    }\n    .message-view__ecard_new_fr {\n      background-color: #444;\n    }\n    .search-tool,\n    .search-tool-list {\n      background-color: #444;\n      border-color: rgba(0, 0, 0, 0);\n    }\n    .media-dock-main {\n      background-color: var(--n2-main-bg-color);\n    }\n    .media-dock-main .media-tabs__main {\n      border-color: var(--n2-sidebar-bg-color);\n    }\n    .media-dock-main .media-tabs__main.active {\n      background-color: var(--n2-sidebar-bg-color);\n    }\n    .group-board-item .gbi-question,\n    .group-board-item .reminder-title,\n    .view-notice-pinmsg-content .gbi-question,\n    .view-notice-pinmsg-content .reminder-title,\n    .view-notice-topic-content .gbi-question,\n    .view-notice-topic-content .reminder-title {\n      color: var(--n2-primary-color) !important;\n    }\n    .overlay__video__duration {\n      color: var(--n2-primary-color);\n    }\n    .video-msg-container .outline-bubble .overlay__video .avatar-img {\n      color: #fff !important;\n    }\n    .tipv2-content {\n      color: var(--n2-primary-color);\n    }\n    .zavatar.zavatar-l .a-child,\n    .zavatar.zavatar-xl .a-child {\n      border-color: #333;\n      background-color: #233;\n    }\n     \n    .pi-info-layout__primary-info-container {\n      background-color: var(--n2-sidebar-bg-color);\n    }\n    #sidebarNav,\n    #sidebarNav #contact-search,\n    #conversationListId,\n    #conversationListId .msg-item .conv-item,\n    .contact-list__add:hover {\n      background-color: var(--n2-sidebar-bg-color);\n      color: var(--n2-primary-color);\n    }\n    .share-msg__msg-content {\n        background-color: #111919;\n        padding: 8px 12px;\n        margin: 12px 0;\n        border-radius: 4px;\n    }\n    #conversationListId .msg-item .conv-item:hover {\n      background-color: var(--n2-sidebar-hover-bg-color);\n    }\n    #conversationListId .msg-item .conv-item .conv-message.truncate .truncate {\n      color: var(--n2-primary-color);\n      filter: brightness(0.9);\n      font-size: 95%;\n    }\n    .conv-item,\n    .conv-item.selected,\n    #conversationListId .msg-item .conv-item.selected,\n    #contactList .conv-item.selected {\n      background-color: var(--n2-main-bg-color);\n    }\n    .conv-item .conv-item-title .conv-item-title__name,\n    #conversationListId .msg-item .conv-item-title .conv-item-title__name,\n    #contactList .conv-item .conv-item-title .conv-item-title__name,\n    .conv-item .conv-item-title__name,\n    .conv-item .conv-item-title__name--bold {\n      color: var(--n2-primary-color);\n    }\n    #contactList .item,\n    #contactList .conv-item,\n    #contactList .contact-list-item {\n      background-color: rgba(0, 0, 0, 0);\n    }\n    .chat-box-member {\n      color: #e4e6eb;\n    }\n    .chat-box-member__info.v2:hover {\n      background-color: #303030;\n    }\n    #group-creator .create-group__item {\n      background-color: rgba(0, 0, 0, 0);\n    }\n    #group-creator .create-group__item:hover:not(.i-disabled) {\n      background-color: #303030;\n    }\n    .zl-modal__footer__button-action {\n      background-color: #2b2b2b;\n    }\n    .zl-group-input .zl-input {\n      background-color: #303030;\n      color: #e4e6eb;\n    }\n    .zl-label {\n      color: #e4e6eb;\n    }\n    .zl-group-input.zl-group-input__appearance--text:not(\n        .zl-group-input__affix-wrapper\n      )\n      > .zl-input,\n    .zl-group-input.zl-group-input__appearance--text\n      > .zl-group-input__affix-wrapper__prefix-icon,\n    .zl-group-input.zl-group-input__appearance--text\n      > .zl-group-input__affix-wrapper__suffix-icon {\n      padding: 0 1em;\n    }\n    .group-board-page > .gb-content,\n    .group-board-item,\n    .view-notice-pinmsg-content,\n    .view-notice-topic-content,\n    .group-board-item.v2 .item-title-v2,\n    .v2.view-notice-pinmsg-content .item-title-v2,\n    .v2.view-notice-topic-content .item-title-v2,\n    .group-board-item.v2 .item-time-info,\n    .v2.view-notice-pinmsg-content .item-time-info,\n    .v2.view-notice-topic-content .item-time-info,\n    .group-board-item .gbi-pmsg-content .pmsg-msg,\n    .view-notice-pinmsg-content .gbi-pmsg-content .pmsg-msg,\n    .view-notice-topic-content .gbi-pmsg-content .pmsg-msg,\n    .group-board-page > .gb-tab-btn,\n    .group-board-page > .gb-tabs,\n    .group-board-page,\n    .group-board-page .gb-tab,\n    .mg-item,\n    .zl-dropdown--preview,\n    .z--btn--outline--tertiary,\n    .sticker-selector#stickerSelector,\n    .sticker-selector__content__name,\n    .sticker-selector__content__selected,\n    .sticker-selector__content .ReactVirtualized__Grid__innerScrollContainer .flx,\n    #itemSuggestPopover:hover,\n    .sticker-suggestion.chat-message.first-selected,\n    .sticker-suggestion.chat-message.last-selected,\n    .sticker-suggestion.selected,\n    .sticker-suggestion:hover,\n    .zmenu-body.content-only,\n    .search-tool-list,\n    .sticker-selector__content,\n    .search-result-empty .search-empty-guide,\n    .search-result-hint,\n    .search-tool,\n    .zl-group-input__search:not(.inherit-input) > .zl-input,\n    .zl-compose > .rich-input,\n    .zl-compose,\n    .pr-action-item,\n    .member-list-popup-preview,\n    .chips,\n    .chips-choice,\n    .qrsc,\n    .zl-group-input,\n    .user-reacted-container,\n    .user-reacted-container::before,\n    .chat-message__actions,\n    .chat-info-link__action,\n    .cb-info-file-item__actions-container,\n    .cb-info-file-item__actions-container > div {\n      color: #e4e6eb;\n      background: #444 !important;\n      background-color: #444 !important;\n    }\n    .leftbar-unread.unread-red {\n      color: #e4e6eb;\n    }\n    .conv-action__unread .conv-unread {\n      color: #e4e6eb !important;\n    }\n    #contact-search .group-search {\n      color: #e4e6eb;\n    }\n    #contact-search .group-search .fake-textholder {\n      color: #e4e6eb;\n    }\n    #contact-search .group-search #contact-search-input {\n      border: none;\n      color: #e4e6eb;\n      background: #201d1d !important;\n      background-color: #201d1d !important;\n    }\n    .qrsc .qri {\n      color: #e4e6eb;\n      background: #2d2d2d !important;\n      background-color: #2d2d2d !important;\n    }\n    .popover-v2,\n    .popover-v3,\n    .zmenu-body.content-only {\n      border-color: #2b2b2b;\n    }\n    .z--btn--outline--tertiary {\n      border-color: rgba(0, 0, 0, 0);\n    }\n    .file-actions-row__icon,\n    .media-item.focusItem:not(.sel-mode) .show-on-hover,\n    .media-item:hover:not(.sel-mode) .show-on-hover,\n    .zmenu-item {\n      color: #e4e6eb !important;\n    }\n      .video-message__w-caption-content-container {\n    background-color: #444444;\n    box-sizing: border-box;\n    padding: var(--space-sm);\n}\n    .search-title-container .search-subtitle,\n    .search-title-container .search-title,\n    .search-list-title,\n    .search-msg-item .st-name,\n    .search-msg-item .st-date,\n    .search-msg-item .st-message,\n    .z--btn--text--tertiary,\n    .search-filter-txt,\n    .sb-label__filter,\n    .edit_alias-description,\n    .lbl-conv-item,\n    .cal-popup,\n    .z-radio,\n    .view-notice-topic-content-v2--group,\n    .view-notice-topic-content-v2 .notice-time-section,\n    .view-notice-topic-content-v2 .notice-time-section > .content > .line,\n    .view-notice-topic-content-v2 .notice-time-section > .content > .line > .title,\n    .file-message__content-container,\n    .card-title,\n    .lb-more-menu .more-pop-item,\n    .lb-more-menu .more-pop-item > i,\n    .cal-preview {\n      color: #e4e6eb;\n      background: rgba(0, 0, 0, 0) !important;\n      background-color: rgba(0, 0, 0, 0) !important;\n    }\n    .zmenu-item:hover:not(.subtitle),\n    .search-msg-item:hover,\n    .sticker-zone-search.isHover,\n    .sticker-zone:hover,\n    #itemSuggestPopover .item-sticker:hover,\n    .sticker-suggestion > .item-sticker.active,\n    .sticker-suggestion > .item-sticker:hover,\n    .lb-more-menu .more-pop-item:hover {\n      background-color: #2b2b2b !important;\n    }\n    .dd-dropdown-ui:hover,\n    .dd-options:hover:not(.prevent-hover) {\n      background-color: #111;\n    }\n    .group-board-page > .gb-tab-btn,\n    .group-board-page > .gb-tabs {\n      border-color: #666;\n    }\n    .group-board-page .gb-tab.chat-message.first-selected,\n    .group-board-page .gb-tab.chat-message.last-selected,\n    .group-board-page .gb-tab.selected {\n      border-width: 4px;\n    }\n    .group-board-item.v2 .item-calendar-preview,\n    .v2.view-notice-pinmsg-content .item-calendar-preview,\n    .v2.view-notice-topic-content .item-calendar-preview,\n    .reminder-info-v2,\n    .reminder-info-v2 > .content > .cal {\n      background-color: #2b2b2b;\n      border-color: #222;\n    }\n    .message-info > div {\n      background-color: #2b2b2b;\n    }\n    .group-poll-info-content-item-progress,\n    .group-poll-vote-content-item-progress {\n      background-color: #369;\n    }\n    .media-dock-tabs {\n      border-color: #444;\n    }\n    .search-msg-item .st-highlight,\n    .edit_alias-description-name {\n      color: #e4e6eb;\n      font-weight: 900;\n    }\n    .conv-action {\n      color: #b36600;\n    }\n    .conv-action:hover {\n      color: #ff9100;\n    }\n    .cal-preview-v3 {\n      color: #e4e6eb;\n      background: #444 !important;\n      background-color: #444 !important;\n    }\n    .cal-preview-v3:hover {\n      color: #e4e6eb;\n      background: #444 !important;\n      background-color: #444 !important;\n    }\n    #calendar-v3,\n    #calendar-v3 *,\n    #calendar-v3 > .cal-content .cal-item {\n      color: #e4e6eb;\n      background: #444 !important;\n      background-color: #444 !important;\n    }\n    .z--btn--fill--tertiary {\n      background-color: #233;\n      color: #e4e6eb;\n      border: solid 1px #324b4b;\n    }\n    .z--btn--fill--tertiary:hover:not(.--disabled) {\n      background-color: #324b4b;\n      color: #e4e6eb;\n      border-color: #233;\n    }\n    .group-board-item.v2,\n    .v2.view-notice-pinmsg-content,\n    .v2.view-notice-topic-content {\n      border-color: #333;\n    }\n    .z--btn--chatbar--danger,\n    .z--btn--chatbar--primary,\n    .z--btn--chatbar--secondary,\n    .z--btn--chatbar--secondary-red,\n    .z--btn--chatbar--tertiary {\n      color: #fff;\n    }\n    .chat-empty-friend-info,\n    .chat-empty-card-friend {\n      background-color: #444;\n      color: #e4e6eb;\n    }\n    .btn-jump > div {\n      color: #eff;\n      border: solid 1px #359bed;\n    }\n    .chat-info {\n      background-color: var(--n2-sidebar-bg-color);\n    }\n    .chat-info__header {\n      background-color: #2b2b2b;\n    }\n    .chat-info__header .chat-info__header__title,\n    .chat-info__header .chat-info__header__title .z--btn--text--tertiary {\n      color: #fff;\n    }\n    aside .chat-info {\n      color: #fff;\n    }\n    .chat-info .chat-info__header:before,\n    .chat-info .chat-info-general__item:after {\n      border-color: var(--n2-hr-color);\n    }\n    .chat-info .chat-info-general__item--title {\n      color: #fff;\n    }\n    .chat-info .chat-info-general__section--border {\n      border-color: var(--n2-sidebar-bg-color);\n    }\n    .chat-info .chat-info-link__title {\n      color: #fff;\n    }\n    .chat-info .tab-bar-item {\n      color: #fff;\n    }\n    .chat-info .cb-info-file-item__file-name,\n    .chat-info .media-item-title {\n      color: #fff;\n    }\n    .chat-info .chat-info-general__item:hover,\n    .media-item.focusItem:not(.sel-mode),\n    .media-item:hover:not(.sel-mode) {\n      background-color: var(--n2-not-me-msg-box-shadow);\n    }\n    .media-empty-text,\n    .chat-info-general__item--title--sub,\n    .cb-info-file-item__file-size,\n    .cb-info-file-item__suggest-preview-file,\n    .cb-info-file-item__suggest-preview-folder,\n    .tab-main .tab-item,\n    .group-setting__title,\n    .group-setting {\n      color: #b9b2b2 !important;\n    }\n      .message-quote-fragment__container.message-quote-fragment__container--white {\n        background-color: #2d3748;\n    }\n    #contact-search .group-search__icon {\n        position: absolute;\n        top: 0;\n        font-size: .875rem;\n        width: .875rem;\n        height: .875rem;\n        line-height: 0;\n        color: #f2f4f5;\n        bottom: 0;\n        margin: auto 12px;\n    }\n    .z--btn--text--tertiary:hover:not(.--disabled) {\n      background-color: var(--n2-hr-color);\n    }\n    #group-creator .create-group__nav {\n      background-color: #222;\n    }\n    .msg-filters-bar {\n      border-top: solid 1px var(--n2-hr-color);\n    }\n    nav {\n      border-right: solid 1px var(--n2-hr-color);\n    }\n    .zl-avatar {\n      border-color: var(--n2-sidebar-bg-color);\n      box-shadow: none;\n    }\n    .zl-avatar .zl-avatar__photo {\n      background-color: var(--n2-sidebar-bg-color);\n    }\n    .chat-info-general__item--icon {\n      color: var(--n2-primary-color);\n    }\n    main.friend-center-main {\n      background-color: var(--n2-main-bg-color);\n    }\n    #chatViewContainer #chat-view,\n    #messageViewScroll,\n    #messageViewContainer {\n      background-color: #222;\n      color: var(--n2-primary-color);\n    }\n      #main-tab {\n        width: 64px;\n        flex: none;\n        box-sizing: border-box;\n        background: var(--layer-background-inverse);\n        position: relative;\n        margin-top: -24px;\n    }\n    .leftbar-tab.chat-message.first-selected, .leftbar-tab.chat-message.last-selected, .leftbar-tab.selected {\n        background: #a52a2a;\n    }\n\n    .leftbar-tab:hover {\n        background: #a52a2a;\n    }\n    .message-view__blur {\n      background-color: #222;\n    }\n    .friend-center-main .rel > div {\n      background-color: var(--n2-main-bg-color) !important;\n      border-radius: 50%;\n    }\n    .friend-center-main .friend-center-item-v2,\n    .friend-center-main .fr-center-top {\n      background-color: #233 !important;\n      color: #fff;\n    }\n    .friend-center-main .fr-center-top div {\n      color: #fff !important;\n    }\n    .ReactVirtualized__Grid__innerScrollContainer {\n      color: #fff;\n    }\n    .todo-view,\n    .todo-tab,\n    .todo-tab .td-tab.chat-message,\n    .todo-tab .td-tab,\n    .td-empty-container,\n    .td-empty-container > .emp-txt,\n    .todo-close-button,\n    .todo-tab .td-sub-tab.chat-message,\n    .todo-tab .td-sub-tab {\n      background-color: #444;\n      color: var(--n2-primary-color) !important;\n    }\n    .todo-view.selected,\n    .todo-view.first-selected,\n    .todo-view.last-selected,\n    .todo-tab.selected,\n    .todo-tab.first-selected,\n    .todo-tab.last-selected,\n    .todo-tab .td-tab.chat-message.selected,\n    .todo-tab .td-tab.chat-message.first-selected,\n    .todo-tab .td-tab.chat-message.last-selected,\n    .todo-tab .td-tab.selected,\n    .todo-tab .td-tab.first-selected,\n    .todo-tab .td-tab.last-selected,\n    .td-empty-container.selected,\n    .td-empty-container.first-selected,\n    .td-empty-container.last-selected,\n    .td-empty-container > .emp-txt.selected,\n    .td-empty-container > .emp-txt.first-selected,\n    .td-empty-container > .emp-txt.last-selected,\n    .todo-close-button.selected,\n    .todo-close-button.first-selected,\n    .todo-close-button.last-selected,\n    .todo-tab .td-sub-tab.chat-message.selected,\n    .todo-tab .td-sub-tab.chat-message.first-selected,\n    .todo-tab .td-sub-tab.chat-message.last-selected,\n    .todo-tab .td-sub-tab.selected,\n    .todo-tab .td-sub-tab.first-selected,\n    .todo-tab .td-sub-tab.last-selected {\n      background-color: #2b2b2b;\n    }\n    .todo-tab .td-tab .td-unread-badge.bagde-count.inactive {\n      color: #333 !important;\n    }\n    .todo-status-button-v3 > .button-inside {\n      background-color: #2b2b2b;\n    }\n    .td-item-v3 {\n      background-color: #444;\n      color: var(--n2-primary-color) !important;\n    }\n    .td-item-v3:hover {\n      background-color: #2b2b2b;\n    }\n    #scroll-vertical div {\n      background-color: rgba(222, 222, 222, 0.5) !important;\n    }\n    .create-todo-icon {\n      color: var(--n2-primary-color);\n    }\n        .card.me, .card.me[data-id="div_SentMsg_Text"], .card.me[data-id="div_LastSentMsg_Text"], .chat-message.me .img-msg-v2.-bg-v-1 .img-msg-v2__bub > .img-msg-v2__th, .chat-message.me .img-msg-v2.-caption.-me > .img-msg-v2__bub, .card.card--text.me {\n    background-color: #2d3748;\n    box-shadow: 0 0 3px #373737;\n    color: var(--n2-primary-color);\n}\n\n    .card--group-photo__row__item\n      .todo-header-container\n      > img.card--group-photo__row__item__photo,\n    .chat-message-picture__photo.todo-header-container > img,\n    .group-topic.todo-header-container > .topic-banner__thumb-default,\n    .link-preview-v2 .todo-header-container > .preview-thumb-link,\n    .rl-msg .rl-link-thumb .todo-header-container > .rl-thumb-lnk__thumb-default,\n    .todo-header-container > .b-item-thumb-image__thumb-default,\n    .todo-header-container > .card--link-img,\n    .todo-header-container > .cb-info-file-item-overlay__check,\n    .todo-header-container > .chat-message-picture__gif__thumb,\n    .todo-header-container > .fa,\n    .todo-header-container > .file-tick__icon-setting,\n    .todo-header-container > .image-placeholder,\n    .todo-header-container > .image-show__thumb,\n    .todo-header-container > .link-placeholder,\n    .todo-header-container > .link-thumb,\n    .todo-header-container > .media-item__file-type.photo,\n    .todo-header-container > .media-store-preview-item__picture,\n    .todo-header-container > .quote-banner-thumb,\n    .todo-header-container > .quote-base__close-icon,\n    .todo-header-container > .thumb-default,\n    .todo-header-container > .thumb-img-suggest,\n    .todo-header-container > img.chat-message-picture__photo {\n      color: var(--n2-primary-color);\n    }\n    .filter-att-item {\n      background-color: #234 !important;\n    }\n    .noti-tab-title {\n      color: #e4e6eb;\n    }\n    .friend-profile__block-stories {\n      background-color: #234 !important;\n    }\n    .setting-menu__item.chat-message,\n    .setting-menu__item.chat-message,\n    .setting-menu__item {\n      background-color: var(--n2-main-bg-color);\n    }\n    .setting-menu__item.chat-message:hover,\n    .setting-menu__item.chat-message:hover,\n    .setting-menu__item:hover {\n      background-color: #444;\n    }\n    .setting-menu__item.chat-message.last-selected,\n    .setting-menu__item.chat-message.first-selected,\n    .setting-menu__item.chat-message.selected,\n    .setting-menu__item.chat-message.last-selected,\n    .setting-menu__item.chat-message.first-selected,\n    .setting-menu__item.chat-message.selected,\n    .setting-menu__item.last-selected,\n    .setting-menu__item.first-selected,\n    .setting-menu__item.selected {\n      background-color: #233;\n    }\n    .z--btn--fill--secondary {\n      background-color: #fff;\n    }\n    .tds-banner-download__container {\n      background-color: var(--n2-main-bg-color);\n    }\n    .tds-banner-download__container .tds-banner-download__action-button-wrapper {\n      color: var(--n2-primary-color);\n    }\n    .z-toggle > div,\n    .z-toggle.--m > div {\n      background-color: var(--n2-primary-color);\n    }\n    .z--btn--v2.btn-tertiary-neutral:active,\n    .z--btn--v2.btn-tertiary-neutral:hover {\n      background-color: var(--n2-neutral-color);\n    }\n    .leftbar-tab.chat-message.first-selected .mmi-icon-wr,\n.leftbar-tab.chat-message.last-selected .mmi-icon-wr,\n.leftbar-tab.selected .mmi-icon-wr {\n    background: linear-gradient(135deg, #c31818, #4f46e5);\n    transition: background 0.3s ease; /* Smooth transition for hover effect */\n}\n\n.leftbar-tab.chat-message.first-selected .mmi-icon-wr:hover,\n.leftbar-tab.chat-message.last-selected .mmi-icon-wr:hover,\n.leftbar-tab.selected .mmi-icon-wr:hover {\n    background: linear-gradient(135deg, #4f46e5, #c31818); /* Reverse the gradient on hover */\n}\n\n\n      .leftbar-tab.chat-message.first-selected, .leftbar-tab.chat-message.last-selected, .leftbar-tab.selected {\n    background: none;\n}\n \n\n    .leftbar-tab:hover {\n      background: #C31818;\n    }\n\n  \n\n  ',document.head.appendChild(e),setInterval((()=>{!async function(){if("indexedDB"in window){const e=await async function(){const e=await indexedDB.databases();e.map((e=>e.name)).join(", ");const n=/^zdb_\d+/,t=e?.find((e=>e.name.match(n)));if(t){t.name;const e=await le(t.name);return{...t,name:e}}return t}();if(!e)return;const n=indexedDB.open(e.name);n.onsuccess=async()=>{const e=n.result.transaction(["unread_conv"],"readonly").objectStore("unread_conv").getAll();e.onsuccess=e=>{const n=e.target.result;let t=0;Array.isArray(n)&&(t=n.reduce(((e,n)=>{const t=n?.smsUnreadCount;return e+(t||0)}),0)),q(t)},e.onerror=e=>{console.error("Error when reading conv of zalo: ",e)}},n.onerror=e=>{console.error("Error when reading db of zalo: ",e)}}else{const e=document.querySelector(".leftbar-unread.unread-red");if(e){const n="fa-num";let t=0;for(const o of e.classList)if(o.startsWith(n)){t=o.substring(n.length);break}q(t)}}}()}),H)}}function q(e=""){const n=Number.isInteger;let t=document.title.replace(/^\(\d+\+?\)/,"");if(e){let o="";o=n(+e)?+e:e.replace("plus","+"),o&&(t=`(${o}) ${t}`)}document.title=t}chrome.runtime.onMessage.addListener((async(e,n,t)=>{if("GET_USER_INFO"===e.task){var o=L();le(`zdb_${localStorage.getItem("sh_zlast_uid")}`).then((e=>{indexedDB.open(e).onsuccess=e=>{let n=e.target.result.transaction(["label"],"readonly").objectStore("label").getAll();n.onsuccess=()=>{chrome.runtime.sendMessage({task:"USER_INFO",data:o,tagPhanLoai:n.result})},n.onerror=()=>{console.error("Error fetching labels from IndexedDB")}}})),chrome.runtime.sendMessage({task:"USER_INFO",data:o})}if("clickAddContact"===e.task&&h(e.phone,e.message,e.isCheck,e.isKetBan,e.item),"clickInputFriend"===e.task&&b(e.name,e.message,e.uid),"XOA_CACHE"===e.task&&indexedDB.databases().then((async e=>{e.map((e=>e.name)).join(", ");const n=e.map((e=>(e.name,new Promise(((n,t)=>{const o=indexedDB.deleteDatabase(e.name);o.onsuccess=()=>{e.name,n()},o.onerror=()=>{console.error(`❌ Failed to delete database: ${e.name}`),t()}})))));try{await Promise.all(n),te=null;const e=localStorage.getItem("sh_zlast_uid");if(e){const n=`zdb_${e}`;setTimeout((async()=>{await ae(n)&&await se(n)}),5e3)}setTimeout((()=>{location.reload()}),1e3)}catch(e){console.error("❌ Error deleting databases:",e),location.reload()}})).catch((e=>{console.error("❌ Error listing databases:",e),location.reload()})),"CLONE_DATABASE"===e.task){const e=localStorage.getItem("sh_zlast_uid");if(e){const n=`zdb_${e}`;se(n)}}if(e.task,"STOP_SHARE"===e.task&&(N=!0,R("data-translate-inner","STR_CANCEL")),"START_SHARE"===e.task){var r=e.data,a=e.tags,c=e.message,i=e.isPhanLoaiShare;!function(){const e=document.getElementById("zl-modal__dialog-body");if(e){const n=e.parentElement.parentElement.parentElement;n&&n.remove()}}(),await async function(e,n,t,o){N=!1;const r=localStorage.getItem("sh_zlast_uid"),a=await le(`zdb_${r}`);indexedDB.open(a).onsuccess=async r=>{const a=r.target.result.transaction(["friend"],"readonly").objectStore("friend").getAll();a.onsuccess=async r=>{const a=r.target.result.length,c=function(e,n){const t=[];let o=0;for(;o+n<=e;)t.push(o),o+=n;return o<e&&t.push(o),t.push(e),t}(a,100);for(let r=0;r<c.length;r++){if(N)return;const s=c[r];let l=0;if(r<c.length-1&&(l=c[r+1]-s),r<c.length-1)for(const[r,c]of e.entries()){if(N)return;const e=new Date;e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),await C(c.content,s,l,n,t,o);var i=s+l;chrome.runtime.sendMessage({task:"TRANGTHAI_SHARE",message:`Trạng thái: Đã share thành công (${i}/${a}), bạn ơi.`}),await g(300)}}},a.onerror=e=>{console.error("Error reading all entries:",e)}}}(r,a,c,i)}if("HUY_CONTENT_SHARE"===e.task&&(document.body.removeEventListener("mouseover",A),document.body.removeEventListener("mouseout",A),document.body.removeEventListener("click",I,!0)),"CHOICE_CONTENT_SHARE"===e.task&&(document.body.addEventListener("mouseover",A),document.body.addEventListener("mouseout",A),document.body.addEventListener("click",I,!0)),"REQUEST_SHOW_MODAL"===e.task){var s=e.isShowModal;u(!s)}"EXPORT_ALL_VCARD"===e.task&&chrome.storage.local.get(["sh_zlast_uid"],(function(e){const n=localStorage.getItem("sh_zlast_uid");!async function(e){const n=await le(`zdb_${e}`),t=indexedDB.open(n);t.onsuccess=e=>{const n=e.target.result.transaction(["friend"],"readonly").objectStore("friend").getAll();n.onsuccess=e=>{const n=e.target.result;chrome.runtime.sendMessage({task:"DATA_LIST_FRIEND_VCARD_EXPORT",friends:n})},n.onerror=e=>{console.error("Error reading all entries:",e)}},t.onerror=e=>{console.error("Error opening database:",e)}}(n)})),"EXPORT_ALL_FRIENDS"===e.task&&chrome.storage.local.get(["sh_zlast_uid"],(function(e){const n=localStorage.getItem("sh_zlast_uid");M(n,"excel")})),"EXPORT_ALL_FRIENDS_TXT"===e.task&&chrome.storage.local.get(["sh_zlast_uid"],(function(e){const n=localStorage.getItem("sh_zlast_uid");M(n,"txt")})),"EXPORT_ALL_FRIENDS_TXT_TEN"===e.task&&chrome.storage.local.get(["sh_zlast_uid"],(function(e){const n=localStorage.getItem("sh_zlast_uid");M(n,"txt_ten")})),"GET_ALL_FRIENDS"===e.task&&chrome.storage.local.get(["sh_zlast_uid"],(async function(n){const t=localStorage.getItem("sh_zlast_uid");var o=e.option;if(10==o){var r=e.id_group,a=e.name_group;return await async function(e,n){try{const t=document.getElementById("contact-search-input");if(!t)return;t.value=e;const o=new Event("input",{bubbles:!0});t.dispatchEvent(o),await g(1e3);const r=document.querySelector('[data-translate-inner="STR_CHAT_SEARCH"]');r&&r.click(),await g(500);const a=document.querySelector('[data-translate-inner="STR_VIEW_MORE_FRIEND"]');a&&a.click(),await g(500);const c=`group-item-${n}`;let i=document.getElementById(c);if(!i){const e=document.querySelectorAll('[id^="group-item-"]');for(let n of e)if(n.id===c){i=n;break}if(!i){const e=document.querySelector(".ReactVirtualized__Grid__innerScrollContainer");e&&(e.scrollTop=e.scrollHeight,await g(1e3),i=document.getElementById(c))}}i?(i.click(),await g(1e3),chrome.runtime.sendMessage({task:"OPEN_GROUP_CHAT_SUCCESS",group_name:e,group_id:n})):chrome.runtime.sendMessage({task:"OPEN_GROUP_CHAT_ERROR",group_name:e,group_id:n,error:"Group not found in search results"})}catch(t){console.error("❌ Error opening group chat:",t),chrome.runtime.sendMessage({task:"OPEN_GROUP_CHAT_ERROR",group_name:e,group_id:n,error:t.message})}}(a,r),void async function(e,n,t,o){const r=`zdb_${e}`,a=indexedDB.open(r);a.onsuccess=e=>{let n=e.target.result.transaction(["group_info"],"readonly").objectStore("group_info"),r=t,a=n.get(r);a.onsuccess=e=>{var n=e.target.result.topMember,t=e.target.result.adminIds;let r=n.filter((e=>"Account Banned"!==e.dName&&"Tài khoản bị khóa"!==e.dName&&!e.isAdmin&&!t.includes(e.id))).map((e=>({avatar:e.avatar,displayName:e.dName,userId:e.id,tag:o,type:0})));chrome.runtime.sendMessage({task:"DATA_LIST_FRIEND_RECEIVED",friends:r,isGroup:10})},a.onerror=e=>{console.error("Error reading all entries:",e)}},a.onerror=e=>{console.error("Error opening database:",e)}}(t,0,r,a)}!function(e,n){"1"==n?async function(e){const n=await le(`zdb_${e}`),t=indexedDB.open(n);t.onsuccess=e=>{const n=e.target.result;let t=n.transaction(["friend"],"readonly"),o=t.objectStore("friend"),r=o.getAll();r.onsuccess=e=>{var r=e.target.result;r=r.filter((e=>!(0===e.isValid||1===e.isBlocked||0!==e.accountStatus))),t=n.transaction(["label"],"readonly"),o=t.objectStore("label"),o.getAll().onsuccess=e=>{let n=e.target.result;const t={};r.forEach((e=>{t[e.userId]=e.userId})),r.forEach((e=>{e.tag="Không có nhãn"})),n.forEach((e=>{r.forEach((n=>{e.conversations.some((e=>t[e]===n.userId))&&(n.tag=e.text)}))})),chrome.runtime.sendMessage({task:"DATA_LIST_FRIEND_RECEIVED",friends:r,isGroup:0})}},r.onerror=e=>{console.error("Error reading all entries:",e)}},t.onerror=e=>{console.error("Error opening database:",e)}}(e):"2"==n?async function(e){const n=await le(`zdb_${e}`),t=indexedDB.open(n);t.onsuccess=e=>{const n=e.target.result;let t=n.transaction(["friend"],"readonly"),o=t.objectStore("friend"),r=o.getAll();r.onsuccess=e=>{var a=e.target.result;a=a.filter((e=>!(0===e.isValid||1===e.isBlocked||0!==e.accountStatus))),t=n.transaction(["label"],"readonly"),o=t.objectStore("label"),o.getAll().onsuccess=e=>{let c=e.target.result;const i={};a.forEach((e=>{i[e.userId]=e.userId})),a.forEach((e=>{e.tag="Không có nhãn"})),c.forEach((e=>{a.forEach((n=>{e.conversations.some((e=>e===n.userId))&&(n.tag=e.text)}))})),t=n.transaction(["group"],"readonly"),o=t.objectStore("group"),r=o.getAll(),r.onsuccess=e=>{const n=e.target.result;c.forEach((e=>{n.forEach((n=>{e.conversations.some((e=>e===n.userId))?n.tag=e.text:n.tag="NHÓM VÀ CỘNG ĐỒNG"}))})),n.forEach((e=>{a.push(e)})),chrome.runtime.sendMessage({task:"DATA_LIST_FRIEND_RECEIVED",friends:a,isGroup:0})}}},r.onerror=e=>{console.error("Error reading all entries:",e)}},t.onerror=e=>{console.error("Error opening database:",e)}}(e):"3"==n?async function(e){const n=await le(`zdb_${e}`),t=indexedDB.open(n);t.onsuccess=e=>{const n=e.target.result;let t=n.transaction(["friend"],"readonly"),o=t.objectStore("friend"),r=o.getAll();r.onsuccess=e=>{var a=e.target.result;a=a.filter((e=>!(0===e.isValid||1===e.isBlocked||0!==e.accountStatus))),t=n.transaction(["label"],"readonly"),o=t.objectStore("label"),o.getAll().onsuccess=e=>{let c=e.target.result;const i={};a.forEach((e=>{i[e.userId]=e.userId})),a.forEach((e=>{e.tag="Không có nhãn"})),c.forEach((e=>{a.forEach((n=>{e.conversations.some((e=>i[e]===n.userId))&&(n.tag=e.text)}))})),a.length=0,t=n.transaction(["group"],"readonly"),o=t.objectStore("group"),r=o.getAll(),r.onsuccess=e=>{const n=e.target.result;n.forEach((e=>{e.tag="NHÓM VÀ CỘNG ĐỒNG"})),n.forEach((e=>{a.push(e)})),chrome.runtime.sendMessage({task:"DATA_LIST_FRIEND_RECEIVED",friends:a,isGroup:1})}}},r.onerror=e=>{console.error("Error reading all entries:",e)}},t.onerror=e=>{console.error("Error opening database:",e)}}(e):"4"==n?D(e,"1"):"5"==n&&D(e,"0")}(t,o)})),"GET_ALL_TAG"===e.task&&chrome.storage.local.get(["sh_zlast_uid"],(async function(e){const n=localStorage.getItem("sh_zlast_uid");await async function(e){const n=await le(`zdb_${e}`);const t=indexedDB.open(n);t.onsuccess=e=>{const n=e.target.result;let t=n.transaction(["friend"],"readonly"),o=t.objectStore("friend"),r=o.getAll();r.onsuccess=e=>{var r=e.target.result;r=r.filter((e=>!(0===e.isValid||1===e.isBlocked||0!==e.accountStatus))),t=n.transaction(["label"],"readonly"),o=t.objectStore("label"),o.getAll().onsuccess=e=>{let n=e.target.result;n.length;const t={};r.forEach((e=>{t[e.userId]=e.userId})),r.forEach((e=>{e.tag="Không có nhãn"})),n.forEach((e=>{r.forEach((n=>{e.conversations.some((e=>t[e]===n.userId))&&(n.tag=e.text)}))})),r.length,chrome.runtime.sendMessage({task:"DATA_LIST_TAGS",friends:r})}},r.onerror=e=>{console.error("Error reading all entries:",e)}},t.onerror=e=>{console.error("Error opening database:",e)}}(n)}))})),chrome.storage.sync.get(["running"],z);const B="n2-custome-zalo-theme",H=3e3;function G(e,n,t){chrome.runtime.sendMessage({action:"translate",text:e,targetLanguage:n},(e=>{e&&e.success?(e.translation,t(e.translation)):console.error("⛔️ Lỗi dịch:",e.error||"Không có phản hồi")}))}function O(e,n){if(e.querySelector(".translated-text"))return;const t=document.createElement("div");t.className="translated-text",t.style.fontSize=W,t.style.color=X,t.style.marginTop="20px",t.style.paddingTop="10px",t.style.textAlign="left",t.style.borderTop="2px solid rgb(57, 61, 57)",t.innerText="💡 "+n;const o=JSON.parse(localStorage.getItem("translateSettings"))||{},r=o.targetLanguage||"en",a=(o.mother_languageSelect,document.createElement("select"));a.style.color="#fff",a.style.background="#222222",a.style.marginLeft="8px";const c={vi:"Việt Nam",en:"English",zh:"Chinese","zh-cn":"Chinese (Simplified)","zh-tw":"Chinese (Traditional)",ko:"Korean",es:"Spanish",hi:"Hindi",ar:"Arabic",pt:"Portuguese",bn:"Bengali",ru:"Russian",ja:"Japanese",de:"German",fr:"French",af:"Afrikaans",sq:"Albanian",am:"Amharic",hy:"Armenian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bs:"Bosnian",bg:"Bulgarian",ca:"Catalan",ceb:"Cebuano",ny:"Chichewa",co:"Corsican",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",eo:"Esperanto",et:"Estonian",tl:"Filipino",fi:"Finnish",fy:"Frisian",gl:"Galician",ka:"Georgian",el:"Greek",gu:"Gujarati",ht:"Haitian Creole",ha:"Hausa",haw:"Hawaiian",he:"Hebrew",hmn:"Hmong",hu:"Hungarian",is:"Icelandic",ig:"Igbo",id:"Indonesian",ga:"Irish",it:"Italian",jw:"Javanese",kn:"Kannada",kk:"Kazakh",km:"Khmer",ku:"Kurdish",ky:"Kyrgyz",lo:"Lao",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"Macedonian",mg:"Malagasy",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mn:"Mongolian",my:"Myanmar (Burmese)",ne:"Nepali",no:"Norwegian",or:"Odia",ps:"Pashto",fa:"Persian",pl:"Polish",pa:"Punjabi",ro:"Romanian",sm:"Samoan",gd:"Scots Gaelic",sr:"Serbian",st:"Sesotho",sn:"Shona",sd:"Sindhi",si:"Sinhala",sk:"Slovak",sl:"Slovenian",so:"Somali",su:"Sundanese",sw:"Swahili",sv:"Swedish",tg:"Tajik",ta:"Tamil",te:"Telugu",th:"Thai",tr:"Turkish",uk:"Ukrainian",ur:"Urdu",ug:"Uyghur",uz:"Uzbek",cy:"Welsh",xh:"Xhosa",yi:"Yiddish",yo:"Yoruba",zu:"Zulu"};Object.keys(c).forEach((e=>{const n=document.createElement("option");n.value=e,n.innerText=c[e],a.appendChild(n)})),a.value=r,a.style.display="none",a.addEventListener("change",(n=>{const o=n.target.value,r=e.querySelector(".text").innerText;let a=JSON.parse(localStorage.getItem("translateSettings"))||{};chrome.storage.sync.get("translateSettings",(e=>{a=e.translateSettings||a,a.targetLanguage=o,localStorage.setItem("translateSettings",JSON.stringify(a)),chrome.storage.sync.set({translateSettings:a},(()=>{}))})),G(r,o,(e=>{t.innerText="💡 "+e}))})),t.addEventListener("mouseover",(()=>{a.style.display="inline-block"})),t.addEventListener("mouseout",(()=>{a.style.display="none"})),t.appendChild(a),document.body.appendChild(t),e.appendChild(t)}chrome.storage.onChanged.addListener((e=>{for(const n in e){const t=e[n];"running"===n&&z({running:t.newValue})}}));document.body;const P=new MutationObserver((e=>{for(let n of e)"childList"===n.type&&n.addedNodes.length>0&&n.addedNodes.forEach((e=>{try{if(1===e.nodeType){const n=e.querySelector('[data-id="div_ReceivedMsg_Text"]');if(n){const e=n.querySelector(".text");if(e){const t=e.innerText;G(t,j,(e=>{O(n,e)}))}}}}catch(e){console.error("Lỗi khi xử lý tin nhắn:",e)}}))}));chrome.storage.onChanged.addListener((function(e,n){"sync"===n&&e.translateSettings&&Y()}));const F=document.body;let V=!1,j="en",U="vi",K="Việt Nam",W="16px",X="#deeA3E";function Y(){chrome.storage.sync.get(["translateSettings"],(e=>{const n=e.translateSettings||{};V=n.translateEnabled||!1,j=n.targetLanguage||"en",U=n.mother_languageSelect||"vi",K=n.mother_languageSelectText||"Việt Nam",W=n.fontSize+"px"||0,X=n.fontColor||"#deeA3E",Q=n.autoShortLink||!1,V?P.observe(F,{childList:!0,subtree:!0}):P.disconnect()}))}let Q=!1,J="";function Z(e){return Array.from(e.children).map((e=>e.innerText)).join("\n")}function ee(e,n){e.innerHTML="";n.split("\n").forEach(((n,t)=>{const o=document.createElement("div");o.id=`input_line_${t}`,o.textContent=n,e.appendChild(o)}));const t=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(t);const o=document.createRange(),r=window.getSelection();o.selectNodeContents(e),o.collapse(!1),r.removeAllRanges(),r.addRange(o)}window.addEventListener("keydown",(e=>{if(!e.ctrlKey||!e.shiftKey||"m"!==e.key&&"M"!==e.key){if(e.ctrlKey&&!e.shiftKey&&("m"===e.key||"M"===e.key)){e.preventDefault();const n=document.getElementById("richInput");if(n.style.color=X,!n)return;const t=Z(n);if(!t)return;return J||(J=t),void G(t,U,(e=>{e&&ee(n,e)}))}if("Enter"===e.key){const n=document.getElementById("richInput");if(!n)return;Z(n);e.preventDefault()}}else{e.preventDefault();const n=document.getElementById("richInput");if(n.style.color="#D2D3D8",!n)return;J&&ee(n,J)}}));const ne=setInterval((()=>{(()=>{const e=document.createElement("div");e.id="translate-btn",e.style.borderBottom="1px solid #a69305",e.classList.add("z--btn--v2","btn-tertiary-neutral","medium","chat-box-input-button","--rounded","icon-only"),e.title=`Dịch sang tiếng: ${K} by Zalo Markteting Pro`,e.innerHTML='<img src="https://cdn-icons-png.flaticon.com/24/2875/2875427.png">';const n=document.querySelector(".normal-buttons-group");n&&(n.prepend(e),e.addEventListener("click",(()=>{const e=new KeyboardEvent("keydown",{key:"m",keyCode:77,ctrlKey:!0,bubbles:!0});document.dispatchEvent(e)})),clearInterval(ne))})()}),500);chrome.storage.sync.get("unfriend",(e=>{o=e.unfriend||!1})),chrome.storage.onChanged.addListener(((e,n)=>{"sync"===n&&e.unfriend&&(o=e.unfriend.newValue)})),Y();let te=null,oe=!1;function re(e){return new Promise((n=>{const t=indexedDB.open(e);t.onsuccess=()=>{t.result.close(),n(!0)},t.onerror=()=>{n(!1)}}))}async function ae(e){return new Promise((n=>{const t=indexedDB.open(e);t.onsuccess=()=>{const e=t.result,o=Array.from(e.objectStoreNames);let r=!1,a=0;if(o.join(", "),0===o.length)return e.close(),void n(!1);o.forEach((t=>{const c=e.transaction(t,"readonly").objectStore(t).count();c.onsuccess=()=>{a++,c.result,c.result>0&&(r=!0),a===o.length&&(e.close(),n(r))},c.onerror=()=>{a++,a===o.length&&(e.close(),n(r))}}))},t.onerror=()=>{n(!1)}}))}async function ce(e){return new Promise((n=>{const t=indexedDB.open(e);t.onsuccess=()=>{const e=t.result,o=Array.from(e.objectStoreNames),r={};let a=0;if(o.join(", "),0===o.length)return e.close(),void n(r);o.forEach((t=>{const c=e.transaction(t,"readonly").objectStore(t).count();c.onsuccess=()=>{r[t]=c.result,c.result,a++,a===o.length&&(e.close(),n(r))},c.onerror=()=>{r[t]=0,a++,a===o.length&&(e.close(),n(r))}}))},t.onerror=()=>{n({})}}))}async function ie(e,n){return new Promise((async(t,o)=>{try{const r=indexedDB.open(e);r.onsuccess=async()=>{const a=r.result,c=Array.from(a.objectStoreNames),i=indexedDB.open(n,a.version+1);i.onupgradeneeded=e=>{const n=e.target.result;c.forEach((e=>{if(!n.objectStoreNames.contains(e)){const t=a.transaction(e,"readonly").objectStore(e),o=n.createObjectStore(e,{keyPath:t.keyPath,autoIncrement:t.autoIncrement});t.indexNames&&t.indexNames.length>0&&Array.from(t.indexNames).forEach((e=>{const n=t.index(e);o.createIndex(e,n.keyPath,{unique:n.unique,multiEntry:n.multiEntry})}))}}))},i.onsuccess=async()=>{const n=i.result;for(const e of c)try{const t=a.transaction(e,"readonly").objectStore(e),o=await new Promise(((e,n)=>{const o=t.getAll();o.onsuccess=()=>e(o.result),o.onerror=()=>n(o.error)}));if(o.length>0){o.length;const t=n.transaction(e,"readwrite").objectStore(e);for(const e of o)await new Promise(((n,o)=>{const r=t.add(e);r.onsuccess=()=>n(),r.onerror=()=>o(r.error)}));o.length}}catch(n){console.error(`Error cloning store ${e}:`,n)}a.close(),n.close(),setTimeout((()=>{!async function(e){const n=`${e}_cloned`;try{const t=await ce(e),o=await ce(n);let r=!0,a=0,c=0;for(const e in t)a+=t[e],c+=o[e]||0,t[e]>0&&o[e]!==t[e]?(r=!1,t[e],o[e]):t[e]>0&&(t[e],o[e])}catch(e){console.error("❌ Error comparing databases:",e)}}(e)}),1e3),t()},i.onerror=()=>{a.close(),o(new Error(`Failed to create target database ${n}`))}},r.onerror=()=>{o(new Error(`Failed to open source database ${e}`))}}catch(e){o(e)}}))}async function se(e){var n;if(!oe)try{oe=!0;const t=`${e}_cloned`,o=await re(t);if(o){const o=await(n=t,new Promise(((e,t)=>{const o=indexedDB.open(n);o.onsuccess=()=>{const n=o.result,t=Array.from(n.objectStoreNames);t.join(", "),n.close(),e(t)},o.onerror=()=>{t(new Error(`Failed to open database ${n}`))}})));if(0!==o.length)return o.length,t;await async function(e){const n=`${e}_cloned`;try{return await indexedDB.deleteDatabase(n),n=null,!0}catch(e){return console.error("❌ Error deleting cloned database:",e),!1}}(e)}const r=await re(e);return r?(await ie(e,t),t):null}catch(e){return console.error("❌ Error during database cloning:",e),null}finally{oe=!1}}async function le(e){return te||(te=await se(e),te||e)}async function de(){const e=localStorage.getItem("sh_zlast_uid");if(!e)return;const n=`zdb_${e}`;await ae(n)?await se(n):setTimeout(de,5e3)}indexedDB.databases,window.location.href,navigator.userAgent,document.readyState,localStorage.getItem("sh_zlast_uid"),(new Date).toISOString(),indexedDB.databases,"undefined"!=typeof chrome&&chrome.runtime,"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.id,performance.now(),setTimeout((()=>{document.readyState,localStorage.getItem("sh_zlast_uid"),(new Date).toISOString(),performance.now(),de()}),3e3)})();