(()=>{function e(e){return e?e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/Ä‘/g,"d").replace(/\s+/g,""):""}let t=!1,n=!1,a=0,o=localStorage.getItem("zalo_marketing_language")||"vi",r={};function s(){document.querySelectorAll("[data-translate], [data-translate-placeholder]").forEach((e=>{const t=e.getAttribute("data-translate");t&&r[o]?.[t]&&("option"===e.tagName.toLowerCase()?e.text=r[o][t]:"input"===e.tagName.toLowerCase()||"textarea"===e.tagName.toLowerCase()?e.placeholder=r[o][t]:e.textContent=r[o][t]);const n=e.getAttribute("data-translate-placeholder");n&&r[o]?.[n]&&(e.placeholder=r[o][n])})),"en"===o?$("#txtTHSD").text("Unlimited"):$("#txtTHSD").text("VÄ©nh viá»…n")}function i(){return new Promise((e=>{chrome.storage.local.get(["tabZalo"],(function(t){const n=t.tabZalo?t.tabZalo.id:null;chrome.runtime.sendMessage({action:"GET_LABELS_API",tabId:n},(t=>{if(chrome.runtime.lastError)return console.error("GET_LABELS_API error:",chrome.runtime.lastError),void e([]);if(t&&t.success&&t.data){t.data;let n=t.data;if(!Array.isArray(n)&&n){const e=n.data||n;if(e.labelData)try{n=JSON.parse(e.labelData)}catch(t){n=e.labelData}else Array.isArray(e)&&(n=e)}let a=n;if(window.currentGroupIds&&window.currentGroupIds.length>0){window.currentGroupIds.length;const e=window.currentGroupIds.map((e=>e.toString().replace(/^g/,"")));Array.isArray(n)&&(a=n.filter((t=>[...Array.isArray(t.conversations)?t.conversations:[],...Array.isArray(t.members)?t.members:[]].some((t=>{const n=t&&t.toString().replace(/^g/,"");return n&&e.includes(n)})))))}const r=document.getElementById("tagSelect");if(r){window.g_labels=a;const e="en"===o?"-- Choose category --":"-- Chá»n nhÃ£n --";r.innerHTML=`<option value="-1" data-translate="choose_category">${e}</option>`,Array.isArray(n)&&n.forEach((e=>{let t=document.createElement("option");const n=e.name||e.text||e.id;t.value=n,t.textContent=n,r.appendChild(t)}));const t=document.getElementById("filterLabelSelect");if(t){t.innerHTML="";const e=document.createElement("option");e.value="",e.textContent="en"===o?"-- Filter by Label --":"-- Lá»c theo nhÃ£n --",t.appendChild(e),a.forEach((e=>{let n=document.createElement("option");const a=e.name||e.text||e.id;n.value=a,n.textContent=a,t.appendChild(n)}))}}e(n)}else e([])}))}))}))}function d(){Swal.fire({title:""+("en"===o?"Make Image":"Táº¡o vÄƒn báº£n"),html:`\n          <div class="space-y-3">\n             <textarea id="textInput" placeholder="${"en"===o?"What are you thinking today? Type @ to add emoji icons.":"HÃ´m nay báº¡n nghÄ© gÃ¬? GÃµ @ Ä‘á»ƒ thÃªm emoji icon."}" rows="2" class="relative w-full p-2 border rounded-md text-lg"></textarea>\n\n              <div id="emojiList" style="background: #333333; display: none; max-height: 150px; overflow-y: auto;">\n                \x3c!-- List of emojis - giá»¯ nguyÃªn list emoji cÅ© --\x3e\n                <span class="emoji" data-emoji="ğŸš€">ğŸš€</span>\n                <span class="emoji" data-emoji="ğŸ‡»ğŸ‡³">ğŸ‡»ğŸ‡³</span>\n                <span class="emoji" data-emoji="ğŸ†">ğŸ†</span> \x3c!-- Fireworks --\x3e\n                <span class="emoji" data-emoji="ğŸ‡">ğŸ‡</span> \x3c!-- Sparkler --\x3e\n                <span class="emoji" data-emoji="ğŸ§¨">ğŸ§¨</span> \x3c!-- Dynamite --\x3e\n                <span class="emoji" data-emoji="ğŸ‰">ğŸ‰</span> \x3c!-- Party Popper --\x3e\n                <span class="emoji" data-emoji="ğŸ’¥">ğŸ’¥</span> \x3c!-- Collision --\x3e\n\n                <span class="emoji" data-emoji="1ï¸âƒ£">1ï¸âƒ£</span> \x3c!-- Number One --\x3e\n                <span class="emoji" data-emoji="2ï¸âƒ£">2ï¸âƒ£</span> \x3c!-- Number Two --\x3e\n                <span class="emoji" data-emoji="3ï¸âƒ£">3ï¸âƒ£</span> \x3c!-- Number Three --\x3e\n                <span class="emoji" data-emoji="4ï¸âƒ£">4ï¸âƒ£</span> \x3c!-- Number Four --\x3e\n                <span class="emoji" data-emoji="5ï¸âƒ£">5ï¸âƒ£</span> \x3c!-- Number Five --\x3e\n                <span class="emoji" data-emoji="6ï¸âƒ£">6ï¸âƒ£</span> \x3c!-- Number Six --\x3e\n                <span class="emoji" data-emoji="7ï¸âƒ£">7ï¸âƒ£</span> \x3c!-- Number Seven --\x3e\n                <span class="emoji" data-emoji="8ï¸âƒ£">8ï¸âƒ£</span> \x3c!-- Number Eight --\x3e\n                <span class="emoji" data-emoji="9ï¸âƒ£">9ï¸âƒ£</span> \x3c!-- Number Nine --\x3e\n                <span class="emoji" data-emoji="0ï¸âƒ£">0ï¸âƒ£</span> \x3c!-- Number Zero --\x3e\n                <span class="emoji" data-emoji="ğŸ”¢">ğŸ”¢</span> \x3c!-- Input Numbers --\x3e\n                <span class="emoji" data-emoji="ğŸ’¯">ğŸ’¯</span> \x3c!-- 100 Points --\x3e\n\n                <span class="emoji" data-emoji="ğŸ˜Š">ğŸ˜Š</span>\n                <span class="emoji" data-emoji="ğŸ˜‚">ğŸ˜‚</span>\n                <span class="emoji" data-emoji="â¤ï¸">â¤ï¸</span>\n                <span class="emoji" data-emoji="ğŸ˜">ğŸ˜</span>\n                <span class="emoji" data-emoji="ğŸ˜">ğŸ˜</span>\n                <span class="emoji" data-emoji="ğŸ˜œ">ğŸ˜œ</span>\n                <span class="emoji" data-emoji="ğŸ‘">ğŸ‘</span>\n                <span class="emoji" data-emoji="ğŸ‰">ğŸ‰</span>\n                <span class="emoji" data-emoji="ğŸ˜¢">ğŸ˜¢</span>\n                <span class="emoji" data-emoji="ğŸ˜­">ğŸ˜­</span>\n                <span class="emoji" data-emoji="ğŸ˜…">ğŸ˜…</span>\n                <span class="emoji" data-emoji="ğŸ˜„">ğŸ˜„</span>\n                <span class="emoji" data-emoji="ğŸ˜ƒ">ğŸ˜ƒ</span>\n                <span class="emoji" data-emoji="ğŸ¥°">ğŸ¥°</span>\n                <span class="emoji" data-emoji="ğŸ¤©">ğŸ¤©</span>\n                <span class="emoji" data-emoji="ğŸ¤”">ğŸ¤”</span>\n                <span class="emoji" data-emoji="ğŸ™„">ğŸ™„</span>\n                <span class="emoji" data-emoji="ğŸ’ª">ğŸ’ª</span>\n                <span class="emoji" data-emoji="ğŸ”¥">ğŸ”¥</span>\n                <span class="emoji" data-emoji="ğŸŒŸ">ğŸŒŸ</span>\n                <span class="emoji" data-emoji="âœ¨">âœ¨</span>\n                <span class="emoji" data-emoji="ğŸ’€">ğŸ’€</span>\n                <span class="emoji" data-emoji="ğŸ‘»">ğŸ‘»</span>\n                <span class="emoji" data-emoji="ğŸ¶">ğŸ¶</span>\n                <span class="emoji" data-emoji="ğŸ§">ğŸ§</span>\n                <span class="emoji" data-emoji="ğŸµ">ğŸµ</span>\n                <span class="emoji" data-emoji="ğŸ¼">ğŸ¼</span>\n                <span class="emoji" data-emoji="ğŸ’¡">ğŸ’¡</span>\n                <span class="emoji" data-emoji="ğŸ’«">ğŸ’«</span>\n                <span class="emoji" data-emoji="ğŸŒˆ">ğŸŒˆ</span>\n                <span class="emoji" data-emoji="ğŸŒ¹">ğŸŒ¹</span>\n                <span class="emoji" data-emoji="ğŸŒ»">ğŸŒ»</span>\n                <span class="emoji" data-emoji="ğŸŒ·">ğŸŒ·</span>\n                <span class="emoji" data-emoji="ğŸ¥‘">ğŸ¥‘</span>\n                <span class="emoji" data-emoji="ğŸ•">ğŸ•</span>\n                <span class="emoji" data-emoji="ğŸ”">ğŸ”</span>\n                <span class="emoji" data-emoji="ğŸŸ">ğŸŸ</span>\n                <span class="emoji" data-emoji="ğŸ©">ğŸ©</span>\n                <span class="emoji" data-emoji="ğŸª">ğŸª</span>\n                <span class="emoji" data-emoji="ğŸ«">ğŸ«</span>\n                <span class="emoji" data-emoji="ğŸ¬">ğŸ¬</span>\n                <span class="emoji" data-emoji="ğŸ­">ğŸ­</span>\n                <span class="emoji" data-emoji="ğŸ¥§">ğŸ¥§</span>\n                <span class="emoji" data-emoji="ğŸ“">ğŸ“</span>\n                <span class="emoji" data-emoji="ğŸ‡">ğŸ‡</span>\n                <span class="emoji" data-emoji="ğŸ‰">ğŸ‰</span>\n                <span class="emoji" data-emoji="ğŸŠ">ğŸŠ</span>\n                <span class="emoji" data-emoji="ğŸ">ğŸ</span>\n                <span class="emoji" data-emoji="ğŸ">ğŸ</span>\n                <span class="emoji" data-emoji="ğŸŒ">ğŸŒ</span>\n                <span class="emoji" data-emoji="ğŸ’">ğŸ’</span>\n                <span class="emoji" data-emoji="ğŸ“">ğŸ“</span>\n                <span class="emoji" data-emoji="ğŸ‘">ğŸ‘</span>\n                <span class="emoji" data-emoji="ğŸ¥¥">ğŸ¥¥</span>\n                <span class="emoji" data-emoji="ğŸº">ğŸº</span> \x3c!-- Beer --\x3e\n                <span class="emoji" data-emoji="ğŸ»">ğŸ»</span> \x3c!-- Beer --\x3e\n                <span class="emoji" data-emoji="ğŸ¥ƒ">ğŸ¥ƒ</span> \x3c!-- Whiskey --\x3e\n                <span class="emoji" data-emoji="ğŸŒ»">ğŸŒ»</span> \x3c!-- Sunflower --\x3e\n                <span class="emoji" data-emoji="ğŸŒ¹">ğŸŒ¹</span> \x3c!-- Rose --\x3e\n                <span class="emoji" data-emoji="ğŸŒ·">ğŸŒ·</span> \x3c!-- Tulip --\x3e\n                <span class="emoji" data-emoji="ğŸŒ¼">ğŸŒ¼</span> \x3c!-- Daisy --\x3e\n                <span class="emoji" data-emoji="ğŸŒ¸">ğŸŒ¸</span> \x3c!-- Cherry Blossom --\x3e\n                <span class="emoji" data-emoji="ğŸŒº">ğŸŒº</span> \x3c!-- Hibiscus --\x3e\n                <span class="emoji" data-emoji="ğŸƒ">ğŸƒ</span> \x3c!-- Leaves --\x3e\n                <span class="emoji" data-emoji="ğŸŒ¿">ğŸŒ¿</span> \x3c!-- Herb --\x3e\n                <span class="emoji" data-emoji="ğŸ‚">ğŸ‚</span> \x3c!-- Fallen Leaves --\x3e\n                <span class="emoji" data-emoji="ğŸŒ²">ğŸŒ²</span> \x3c!-- Evergreen Tree --\x3e\n                <span class="emoji" data-emoji="ğŸŒ³">ğŸŒ³</span> \x3c!-- Deciduous Tree --\x3e\n                <span class="emoji" data-emoji="ğŸŒ´">ğŸŒ´</span> \x3c!-- Palm Tree --\x3e\n                <span class="emoji" data-emoji="ğŸŒµ">ğŸŒµ</span> \x3c!-- Cactus --\x3e\n                <span class="emoji" data-emoji="ğŸ“ˆ">ğŸ“ˆ</span> \x3c!-- Chart Increasing --\x3e\n                <span class="emoji" data-emoji="ğŸ“‰">ğŸ“‰</span> \x3c!-- Chart Decreasing --\x3e\n                <span class="emoji" data-emoji="ğŸ’¼">ğŸ’¼</span> \x3c!-- Briefcase --\x3e\n                <span class="emoji" data-emoji="ğŸ’¡">ğŸ’¡</span> \x3c!-- Lightbulb (Idea) --\x3e\n                <span class="emoji" data-emoji="ğŸ“Š">ğŸ“Š</span> \x3c!-- Bar Chart --\x3e\n                <span class="emoji" data-emoji="ğŸ“">ğŸ“</span> \x3c!-- Round Pushpin --\x3e\n                <span class="emoji" data-emoji="ğŸ“…">ğŸ“…</span> \x3c!-- Calendar --\x3e\n                <span class="emoji" data-emoji="ğŸ’¬">ğŸ’¬</span> \x3c!-- Speech Balloon --\x3e\n                <span class="emoji" data-emoji="ğŸ¯">ğŸ¯</span> \x3c!-- Target --\x3e\n                <span class="emoji" data-emoji="ğŸ·ï¸">ğŸ·ï¸</span> \x3c!-- Label --\x3e\n                <span class="emoji" data-emoji="ğŸ“±">ğŸ“±</span> \x3c!-- Mobile Phone --\x3e\n                <span class="emoji" data-emoji="ğŸŒ">ğŸŒ</span> \x3c!-- Globe with Meridians --\x3e\n                <span class="emoji" data-emoji="ğŸ“">ğŸ“</span> \x3c!-- Memo --\x3e\n                <span class="emoji" data-emoji="ğŸ‘¥">ğŸ‘¥</span> \x3c!-- Busts in Silhouette --\x3e\n                <span class="emoji" data-emoji="ğŸ¤">ğŸ¤</span> \x3c!-- Handshake --\x3e\n                <span class="emoji" data-emoji="ğŸ›’">ğŸ›’</span> \x3c!-- Shopping Cart --\x3e\n                <span class="emoji" data-emoji="ğŸ’³">ğŸ’³</span> \x3c!-- Credit Card --\x3e\n                <span class="emoji" data-emoji="ğŸ’°">ğŸ’°</span> \x3c!-- Money Bag --\x3e\n                <span class="emoji" data-emoji="ğŸ">ğŸ</span> \x3c!-- Gift --\x3e\n                <span class="emoji" data-emoji="ğŸ“¦">ğŸ“¦</span> \x3c!-- Package --\x3e\n                <span class="emoji" data-emoji="ğŸª">ğŸª</span> \x3c!-- Convenience Store --\x3e\n              </div>\n              \n              <div class="flex justify-between items-center">\n                  <label class="text-sm">${"en"===o?"Text color:":"MÃ u chá»¯:"}</label>\n\n                  <input type="color" id="textColor" value="#ffffff">\n              </div>\n              \n              <div class="flex justify-between items-center">\n                 <label class="text-sm">${"en"===o?"Select font:":"Chá»n font:"}</label>\n\n                  <select id="fontFamily" class="p-1 border rounded-md" style="background: black;">\n                      <option value="Arial">Arial</option>\n                      <option value="Times New Roman">Times New Roman</option>\n                      <option value="Courier New">Courier New</option>\n                      <option value="Comic Sans MS">Comic Sans MS</option>\n                      <option value="Verdana">Verdana</option>\n                      <option value="Tahoma">Tahoma</option>\n                      <option value="Georgia">Georgia</option>\n                      <option value="Impact">Impact</option>\n                  </select>\n              </div>\n\n              <div class="flex justify-between items-center">\n                  <label class="text-sm">${"en"===o?"Font size:":"KÃ­ch thÆ°á»›c chá»¯:"}</label>\n\n                  <input type="number" id="fontSize" value="30" min="10" max="100" class="w-20 p-1 border rounded-md">\n              </div>\n              \n              \x3c!-- Tabs for background options --\x3e\n              <div class="bg-gray-800 rounded-t-md p-2">\n                  <div class="flex space-x-2">\n                      <button id="gradientTab" class="px-3 py-1 rounded bg-gray-700 text-white text-sm">Gradient</button>\n                      <button id="patternTab" class="px-3 py-1 rounded text-white text-sm">Pattern</button>\n                      <button id="imageTab" class="px-3 py-1 rounded text-white text-sm">Image</button>\n                  </div>\n              </div>\n              \n              \x3c!-- Gradient Options (Default) --\x3e\n              <div id="gradientOptions" class="p-2 border rounded-b-md bg-gray-900">\n                  <div class="flex justify-between items-center">\n                     <label class="text-sm">${"en"===o?"Top background color:":"MÃ u ná»n trÃªn:"}</label>\n\n                      <input type="color" id="color1" value="#ff758c">\n                  </div>\n                  \n                  <div class="flex justify-between items-center mt-2">\n                      <label class="text-sm">${"en"===o?"Bottom background color:":"MÃ u ná»n dÆ°á»›i:"}</label>\n\n                      <input type="color" id="color2" value="#ff7eb3">\n                  </div>\n              </div>\n              \n              \x3c!-- Pattern Options (Hidden initially) --\x3e\n              <div id="patternOptions" class="p-2 border rounded-b-md bg-gray-900" style="display: none;">\n                 \x3c!-- <div class="grid grid-cols-4 gap-2">\n                      <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="pattern1">\n                          <div class="h-12 w-full" style="background: repeating-linear-gradient(45deg, #606dbc, #606dbc 10px, #465298 10px, #465298 20px);"></div>\n                      </div>\n                      <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="pattern2">\n                          <div class="h-12 w-full" style="background: radial-gradient(circle, #f9c5d1, #9795ef);"></div>\n                      </div>\n                      <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="pattern3">\n                          <div class="h-12 w-full" style="background: linear-gradient(135deg, #ee9ca7 0%, #ffdde1 100%);"></div>\n                      </div>\n                      <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="pattern4">\n                          <div class="h-12 w-full" style="background: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);"></div>\n                      </div>\n                      <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="pattern5">\n                          <div class="h-12 w-full" style="background: repeating-radial-gradient(#3b8d99, #6b6b83 10%, #aa4b6b 15%);"></div>\n                      </div>\n                      <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="pattern6">\n                          <div class="h-12 w-full" style="background: linear-gradient(45deg, #8e2de2, #4a00e0);"></div>\n                      </div>\n                      <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="pattern7">\n                          <div class="h-12 w-full" style="background: linear-gradient(to right, #ff6e7f, #bfe9ff);"></div>\n                      </div>\n                      <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="pattern8">\n                          <div class="h-12 w-full" style="background: linear-gradient(to right, #eecda3, #ef629f);"></div>\n                      </div>\n                  </div> --\x3e\n                  <div class="grid grid-cols-5 gap-2" style="max-height: 200px; overflow-y: scroll;">\n                   \x3c!-- Pattern gá»‘c --\x3e\n    <div class="col-span-5 text-white text-sm font-medium py-1">Original Patterns</div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="pattern1">\n      <div class="h-12 w-full" style="background: repeating-linear-gradient(45deg, #606dbc, #606dbc 10px, #465298 10px, #465298 20px);"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="pattern2">\n      <div class="h-12 w-full" style="background: radial-gradient(circle, #f9c5d1, #9795ef);"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="pattern3">\n      <div class="h-12 w-full" style="background: linear-gradient(135deg, #ee9ca7 0%, #ffdde1 100%);"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="pattern4">\n      <div class="h-12 w-full" style="background: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="pattern5">\n      <div class="h-12 w-full" style="background: repeating-radial-gradient(#3b8d99, #6b6b83 10%, #aa4b6b 15%);"></div>\n    </div>\n \n    \x3c!-- Pattern nhÃ³m HAPPY --\x3e\n    <div class="col-span-5 text-white text-sm font-medium py-1">Happy Patterns</div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="happy1">\n      <div class="h-12 w-full" style="background: repeating-radial-gradient(circle at 50% 50%, #fff36d 0%, #ffd100 10%, #ffb700 20%, #ffd100 30%, #fff36d 40%);"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="happy2">\n      <div class="h-12 w-full" style="background: linear-gradient(45deg, #ff0000 0%, #ff9900 16.6%, #ffff00 33.3%, #00ff00 50%, #0099ff 66.6%, #6633ff 83.3%, #ff0099 100%);"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="happy3">\n      <div class="h-12 w-full" style="background-image: radial-gradient(#ff6b6b 8%, transparent 8%), radial-gradient(#feca57 8%, transparent 8%), radial-gradient(#48dbfb 8%, transparent 8%), radial-gradient(#1dd1a1 8%, transparent 8%); background-size: 60px 60px; background-position: 0 0, 30px 30px, 15px 15px, 45px 45px;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="happy4">\n      <div class="h-12 w-full" style="background: linear-gradient(135deg, #ffde59 25%, transparent 25%) -20px 0, linear-gradient(225deg, #ffde59 25%, transparent 25%) -20px 0, linear-gradient(315deg, #ffde59 25%, transparent 25%), linear-gradient(45deg, #ffde59 25%, #ff914d 25%); background-size: 40px 40px;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="happy5">\n      <div class="h-12 w-full" style="background: radial-gradient(circle at 50% 50%, #ff5e7e 10%, transparent 15%), radial-gradient(circle at 20% 80%, #7ed6df 10%, transparent 15%), radial-gradient(circle at 80% 20%, #f9ca24 10%, transparent 15%), radial-gradient(circle at 40% 30%, #badc58 10%, transparent 15%), radial-gradient(circle at 70% 70%, #f0932b 10%, transparent 15%), #ecf0f1; background-size: 200px 200px;"></div>\n    </div>\n\n    \x3c!-- Pattern nhÃ³m HEART --\x3e\n    <div class="col-span-5 text-white text-sm font-medium py-1">Heart Patterns</div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="heart1">\n      <div class="h-12 w-full" style="background-image: radial-gradient(#ff6b8b 15%, transparent 16%), radial-gradient(#ff6b8b 15%, transparent 16%); background-size: 60px 60px; background-position: 0 0, 30px 30px; background-color: #ffecef;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="heart2">\n      <div class="h-12 w-full" style="background: linear-gradient(45deg, #ff5e7e 25%, transparent 25%), linear-gradient(-45deg, #ff5e7e 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ff5e7e 75%), linear-gradient(-45deg, transparent 75%, #ff5e7e 75%); background-size: 20px 20px; background-color: #ffecef;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="heart3">\n      <div class="h-12 w-full" style="background-image: linear-gradient(135deg, #ff748c 25%, transparent 25%), linear-gradient(225deg, #ff748c 25%, transparent 25%), linear-gradient(315deg, #ff748c 25%, transparent 25%), linear-gradient(45deg, #ff748c 25%, transparent 25%); background-size: 100px 100px; background-color: #ffd3d9;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="heart4">\n      <div class="h-12 w-full" style="background: linear-gradient(135deg, #ffb0be 21px, #fff 22px, #fff 24px, transparent 24px, transparent 67px, #fff 67px, #fff 69px, transparent 69px), linear-gradient(225deg, #ffb0be 21px, #fff 22px, #fff 24px, transparent 24px, transparent 67px, #fff 67px, #fff 69px, transparent 69px)0 64px; background-color: #ffb0be; background-size: 64px 128px;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="heart5">\n      <div class="h-12 w-full" style="background: linear-gradient(60deg, #ff758c 0%, #ff7eb3 100%); background-size: 200% 200%;"></div>\n    </div>\n\n    \x3c!-- Pattern nhÃ³m WOMEN --\x3e\n    <div class="col-span-5 text-white text-sm font-medium py-1">Women Patterns</div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="women1">\n      <div class="h-12 w-full" style="background: radial-gradient(circle at 10% 20%, #f9c6de 15%, transparent 20%), radial-gradient(circle at 30% 50%, #f9c6de 15%, transparent 20%), radial-gradient(circle at 50% 80%, #f9c6de 15%, transparent 20%), radial-gradient(circle at 70% 30%, #f9c6de 15%, transparent 20%), radial-gradient(circle at 90% 60%, #f9c6de 15%, transparent 20%); background-color: #fef0f7; background-size: 200px 200px;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="women2">\n      <div class="h-12 w-full" style="background: radial-gradient(circle at 50% 0, #fbd1e4, #fbd1e4 70%, transparent 70.3%), radial-gradient(circle at 50% 100%, #ffe6f2, #ffe6f2 70%, transparent 70.3%); background-size: 50px 100px; background-color: #f6c9db;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="women3">\n      <div class="h-12 w-full" style="background: linear-gradient(135deg, #fbe9f4 25%, transparent 25%) 0 0, linear-gradient(225deg, #fbe9f4 25%, transparent 25%) 0 0, linear-gradient(315deg, #fbe9f4 25%, transparent 25%) 0 0, linear-gradient(45deg, #fbe9f4 25%, transparent 25%) 0 0; background-size: 40px 40px; background-color: #f6d0e9;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="women4">\n      <div class="h-12 w-full" style="background-image: linear-gradient(#f4bde0 1px, transparent 1px), linear-gradient(to right, #f4bde0 1px, transparent 1px); background-size: 20px 20px; background-color: #fff0f8;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="women5">\n      <div class="h-12 w-full" style="background: linear-gradient(45deg, #d6a3dc 0px, #d6a3dc 10px, #f0bfe8 10px, #f0bfe8 20px, #b0c4de 20px, #b0c4de 30px); background-size: 45px 45px;"></div>\n    </div>\n\n    \x3c!-- Pattern nhÃ³m BIRTHDAY --\x3e\n    <div class="col-span-5 text-white text-sm font-medium py-1">Birthday Patterns</div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="bday1">\n      <div class="h-12 w-full" style="background-image: linear-gradient(90deg, transparent 90%, #ff6ec7 90%, #ff6ec7 91%, transparent 91%), linear-gradient(#f4ff75 10%, transparent 10%), linear-gradient(#75ffb6 20%, transparent 20%), linear-gradient(#75caff 30%, transparent 30%), linear-gradient(#ff75e6 40%, transparent 40%); background-size: 10px 10px, 5px 5px, 7px 7px, 3px 3px, 4px 4px; background-color: #ffffff;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="bday2">\n      <div class="h-12 w-full" style="background: radial-gradient(circle at 50% 30%, #ff85a1 10px, transparent 11px), radial-gradient(circle at 30% 70%, #85b6ff 10px, transparent 11px), radial-gradient(circle at 70% 60%, #9e85ff 10px, transparent 11px), radial-gradient(circle at 20% 40%, #ffdd85 10px, transparent 11px), radial-gradient(circle at 80% 20%, #8aff85 10px, transparent 11px); background-color: #f7f7f7; background-size: 100px 100px;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="bday3">\n      <div class="h-12 w-full" style="background-image: linear-gradient(135deg, #ff80ab 10%, transparent 10%), linear-gradient(225deg, #80deea 10%, transparent 10%), linear-gradient(45deg, #ffee58 10%, transparent 10%), linear-gradient(315deg, #b388ff 10%, transparent 10%); background-position: 0 0, 0 0, 50px 50px, 50px 50px; background-size: 100px 100px; background-color: #ffffff;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="bday4">\n      <div class="h-12 w-full" style="background: linear-gradient(135deg, #ffcce6 25%, transparent 25%) -20px 0, linear-gradient(225deg, #ffcce6 25%, transparent 25%) -20px 0, linear-gradient(315deg, #ffcce6 25%, transparent 25%), linear-gradient(45deg, #ffcce6 25%, transparent 25%); background-size: 40px 40px; background-color: #ffeaf4;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="bday5">\n      <div class="h-12 w-full" style="background: linear-gradient(0deg, #ffea00 10%, #ff7043 30%, transparent 30%), linear-gradient(0deg, #ffea00 10%, #ff4081 30%, transparent 30%), linear-gradient(0deg, #ffea00 10%, #64b5f6 30%, transparent 30%), linear-gradient(0deg, #ffea00 10%, #9ccc65 30%, transparent 30%); background-position: 20px 0, 40px 10px, 60px 0, 80px 10px; background-size: 20px 60px; background-repeat: repeat-x; background-color: #f5f5f5;"></div>\n    </div>\n\n    \x3c!-- Pattern nhÃ³m BORDERED --\x3e\n    <div class="col-span-5 text-white text-sm font-medium py-1">Bordered Patterns</div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="border1">\n      <div class="h-12 w-full" style="background-image: linear-gradient(0deg, transparent 0%, transparent 49.5%, #ced4da 49.5%, #ced4da 50.5%, transparent 50.5%, transparent 100%), linear-gradient(90deg, transparent 0%, transparent 49.5%, #ced4da 49.5%, #ced4da 50.5%, transparent 50.5%, transparent 100%); background-size: 50px 50px; background-color: #f8f9fa;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="border2">\n      <div class="h-12 w-full" style="background-image: linear-gradient(45deg, #d6d6d6 25%, transparent 25%, transparent 75%, #d6d6d6 75%, #d6d6d6), linear-gradient(45deg, #d6d6d6 25%, transparent 25%, transparent 75%, #d6d6d6 75%, #d6d6d6); background-position: 0 0, 25px 25px; background-size: 50px 50px; box-shadow: inset 0 0 0 5px rgba(0,0,0,0.1);"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="border3">\n      <div class="h-12 w-full" style="background-image: linear-gradient(#f8f9fa 2px, transparent 2px), linear-gradient(90deg, #f8f9fa 2px, transparent 2px); background-size: 40px 40px; background-color: white; border: 4px solid #e9ecef;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="border4">\n      <div class="h-12 w-full" style="background: repeating-linear-gradient(45deg, transparent, transparent 5px, #ccc 5px, #ccc 10px), repeating-linear-gradient(-45deg, transparent, transparent 5px, #dedede 5px, #dedede 10px); background-size: 20px 20px; border: 5px solid #f8f9fa;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="border5">\n      <div class="h-12 w-full" style="background-color: #fff; background-image: linear-gradient(90deg, transparent 79px, #abced4 79px, #abced4 81px, transparent 81px), linear-gradient(#eee .1em, transparent .1em); background-size: 100% 20px; border: 2px dashed #76aeb5; border-radius: 4px;"></div>\n    </div>\n\n    \x3c!-- Pattern nhÃ³m FLASH SALE --\x3e\n    <div class="col-span-5 text-white text-sm font-medium py-1">Flash Sale Patterns</div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="sale1">\n      <div class="h-12 w-full" style="background: linear-gradient(135deg, #ffeb3b 25%, transparent 25%) -50px 0, linear-gradient(225deg, #ffeb3b 25%, transparent 25%) -50px 0, linear-gradient(315deg, #ffeb3b 25%, transparent 25%), linear-gradient(45deg, #ffeb3b 25%, transparent 25%); background-size: 100px 100px; background-color: #ff3d00;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="sale2">\n      <div class="h-12 w-full" style="background: repeating-linear-gradient(45deg, #ff416c, #ff416c 10px, #ff4b2b 10px, #ff4b2b 20px);"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="sale3">\n      <div class="h-12 w-full" style="background-image: linear-gradient(60deg, #f83600 0%, #f9d423 100%); background-size: 200% 200%;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="sale4">\n      <div class="h-12 w-full" style="background: radial-gradient(circle, #ff0844 0%, #ffb199 100%); background-size: 200% 200%;"></div>\n    </div>\n    <div class="pattern-item cursor-pointer p-1 border rounded" data-pattern="sale5">\n      <div class="h-12 w-full" style="background-image: repeating-linear-gradient(-45deg, #ffe53b 0px, #ffe53b 20px, #ff2525 20px, #ff2525 40px); background-size: 56px 56px;"></div>\n    </div>\n </div>\n   \n              </div>\n              \n              \x3c!-- Image Upload Options (Hidden initially) --\x3e\n              <div id="imageOptions" class="p-2 border rounded-b-md bg-gray-900" style="display: none;">\n                  <div class="flex flex-col space-y-2">\n                      <label class="flex items-center justify-center p-3 border-2 border-dashed rounded-md cursor-pointer bg-gray-800 hover:bg-gray-700">\n                          <span id="uploadLabel" class="text-sm">Táº£i lÃªn hÃ¬nh áº£nh</span>\n                          <input type="file" id="imageUpload" accept="image/*" class="hidden">\n                      </label>\n                      <div id="imagePreview" class="hidden h-24 w-full bg-cover bg-center rounded-md"></div>\n                      <div class="flex justify-between items-center mt-2">\n                          <label class="text-sm">Äá»™ má» hÃ¬nh (opacity):</label>\n                          <input type="range" id="imageOpacity" min="0.1" max="1" step="0.1" value="1" class="w-32">\n                      </div>\n                      <div class="flex justify-between items-center mt-2">\n                          <label class="text-sm">Lá»›p phá»§ mÃ u (overlay):</label>\n                          <input type="color" id="overlayColor" value="#000000">\n                      </div>\n                      <div class="flex justify-between items-center mt-2">\n                          <label class="text-sm">Äá»™ má» lá»›p phá»§:</label>\n                          <input type="range" id="overlayOpacity" min="0" max="0.9" step="0.1" value="0.3" class="w-32">\n                      </div>\n                  </div>\n              </div>\n\n             <div id="preview" class="w-full h-40 flex items-center justify-center text-white font-bold text-xl rounded-md shadow-md" style="background: linear-gradient(to bottom, #ff758c, #ff7eb3);">\n                ${"en"===o?"Where are you thinking?":"Chiá»u nay mÃ¬nh gáº·p nhau á»Ÿ Ä‘Ã¢u?"}\n            </div>\n\n          </div>\n          <canvas id="canvas" width="600" height="400" style="display: none;"></canvas>\n      `,showCancelButton:!0,confirmButtonText:""+("en"===o?"Create Image":"Táº¡o áº¢nh"),willOpen:()=>{let e="gradient",t="",n=null,a=1,r="#000000",s=.3;const i=document.getElementById("textInput"),d=document.getElementById("textColor"),l=document.getElementById("fontFamily"),c=document.getElementById("fontSize"),u=document.getElementById("color1"),p=document.getElementById("color2"),m=document.getElementById("emojiList"),g=document.getElementById("preview"),h=document.getElementById("imageUpload"),f=document.getElementById("uploadLabel"),b=document.getElementById("imagePreview"),y=document.getElementById("imageOpacity"),x=document.getElementById("overlayColor"),v=document.getElementById("overlayOpacity");function k(e){["gradientTab","patternTab","imageTab"].forEach((t=>{const n=document.getElementById(t);t===e?n.classList.add("bg-gray-700"):n.classList.remove("bg-gray-700")}))}document.getElementById("gradientTab").addEventListener("click",(()=>{e="gradient",k("gradientTab"),document.getElementById("gradientOptions").style.display="block",document.getElementById("patternOptions").style.display="none",document.getElementById("imageOptions").style.display="none",w()})),document.getElementById("patternTab").addEventListener("click",(()=>{e="pattern",k("patternTab"),document.getElementById("gradientOptions").style.display="none",document.getElementById("patternOptions").style.display="block",document.getElementById("imageOptions").style.display="none",w()})),document.getElementById("imageTab").addEventListener("click",(()=>{e="image",k("imageTab"),document.getElementById("gradientOptions").style.display="none",document.getElementById("patternOptions").style.display="none",document.getElementById("imageOptions").style.display="block",w()}));const E=document.querySelectorAll(".pattern-item");function w(){const m=i.value||("en"===o?"Where are you thinking?":"Chiá»u nay mÃ¬nh gáº·p nhau á»Ÿ Ä‘Ã¢u?"),h=d.value,f=l.value,b=c.value+"px";if(g.style.color=h,g.style.fontFamily=f,g.style.fontSize=b,g.textContent=m,"gradient"===e){const e=u.value,t=p.value;g.style.backgroundImage="",g.style.background=`linear-gradient(to bottom, ${e}, ${t})`,g.style.backgroundSize="cover",g.style.opacity=1}else if("pattern"===e)if(t){const e=document.querySelector(`[data-pattern="${t}"] div`);e&&(g.style.backgroundImage="",g.style.background=getComputedStyle(e).background,g.style.opacity=1)}else g.style.backgroundImage="",g.style.background="repeating-linear-gradient(45deg, #606dbc, #606dbc 10px, #465298 10px, #465298 20px)",g.style.opacity=1;else if("image"===e&&n){const e=Math.floor(255*s).toString(16).padStart(2,"0");g.style.background="",g.style.backgroundImage=`linear-gradient(to bottom, ${r}${e}, ${r}${e}), url(${n})`,g.style.backgroundSize="cover",g.style.backgroundPosition="center",g.style.opacity=a}}E.forEach((e=>{e.addEventListener("click",(()=>{t=e.getAttribute("data-pattern"),E.forEach((e=>e.classList.remove("ring-2","ring-blue-500"))),e.classList.add("ring-2","ring-blue-500"),w()}))})),h.addEventListener("change",(e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onload=function(e){n=e.target.result,b.style.backgroundImage=`url(${n})`,f.textContent="Thay Ä‘á»•i hÃ¬nh áº£nh",w()},e.readAsDataURL(t)}})),y.addEventListener("input",(e=>{a=parseFloat(e.target.value),w()})),x.addEventListener("input",(e=>{r=e.target.value,w()})),v.addEventListener("input",(e=>{s=parseFloat(e.target.value),w()})),i.addEventListener("keydown",(e=>{"@"===e.key&&(m.style.display="block")})),m.addEventListener("click",(e=>{if(e.target.classList.contains("emoji")){const t=e.target.getAttribute("data-emoji");let n=i.value;const a=n.indexOf("@");-1!==a?n=n.substring(0,a)+t+n.substring(a+1):n+=t,i.value=n,w(),m.style.display="none"}})),document.addEventListener("click",(e=>{i.contains(e.target)||m.contains(e.target)||(m.style.display="none")})),i.addEventListener("input",w),d.addEventListener("input",w),l.addEventListener("change",w),c.addEventListener("input",w),u.addEventListener("input",w),p.addEventListener("input",w),w()},preConfirm:()=>{const e="none"!==document.getElementById("gradientOptions").style.display?"gradient":"none"!==document.getElementById("patternOptions").style.display?"pattern":"image";let t={};if("gradient"===e)t={color1:document.getElementById("color1").value,color2:document.getElementById("color2").value};else if("pattern"===e){const e=document.querySelector(".pattern-item.ring-2");t={patternName:e?e.getAttribute("data-pattern"):"pattern1",patternStyle:e?getComputedStyle(e.querySelector("div")).background:"repeating-linear-gradient(45deg, #606dbc, #606dbc 10px, #465298 10px, #465298 20px)"}}else if("image"===e){const n=document.getElementById("imagePreview");n.style.backgroundImage?t={imageData:n.style.backgroundImage.split("url(")[1].split(")")[0],imageOpacity:parseFloat(document.getElementById("imageOpacity").value),overlayColor:document.getElementById("overlayColor").value,overlayOpacity:parseFloat(document.getElementById("overlayOpacity").value)}:(e="gradient",t={color1:"#ff758c",color2:"#ff7eb3"})}return{text:document.getElementById("textInput").value,textColor:document.getElementById("textColor").value,font:document.getElementById("fontFamily").value,fontSize:document.getElementById("fontSize").value,backgroundType:e,backgroundDetails:t}}}).then((e=>{e.isConfirmed&&function(e,t,n,a,r,s){const i=document.getElementById("canvas"),d=i.getContext("2d");if(d.clearRect(0,0,i.width,i.height),"gradient"===r){const{color1:e,color2:t}=s,n=d.createLinearGradient(0,0,0,i.height);n.addColorStop(0,e),n.addColorStop(1,t),d.fillStyle=n,d.fillRect(0,0,i.width,i.height),p();u(i.toDataURL("image/png"))}else if("pattern"===r){const e=document.createElement("canvas"),t=e.getContext("2d");switch(e.width=100,e.height=100,s.patternName){case"pattern1":default:l(t,"#606dbc","#465298");break;case"pattern2":!function(e,t,n){const a=e.createRadialGradient(50,50,0,50,50,70);a.addColorStop(0,t),a.addColorStop(1,n),e.fillStyle=a,e.fillRect(0,0,100,100)}(t,"#f9c5d1","#9795ef");break;case"pattern3":c(t,"#ee9ca7","#ffdde1");break;case"pattern4":c(t,"#92fe9d","#00c9ff");break;case"pattern5":!function(e,t,n,a){const o=e.canvas.width;for(let r=0;r<o;r+=25)for(let s=0;s<o;s+=25){const o=e.createRadialGradient(r+12.5,s+12.5,0,r+12.5,s+12.5,18);o.addColorStop(0,t),o.addColorStop(.5,n),o.addColorStop(1,a),e.fillStyle=o,e.beginPath(),e.arc(r+12.5,s+12.5,12.5,0,2*Math.PI),e.fill()}}(t,"#3b8d99","#6b6b83","#aa4b6b");break;case"pattern6":c(t,"#8e2de2","#4a00e0");break;case"pattern7":c(t,"#ff6e7f","#bfe9ff");break;case"pattern8":c(t,"#eecda3","#ef629f")}const n=d.createPattern(e,"repeat");d.fillStyle=n,d.fillRect(0,0,i.width,i.height),p();u(i.toDataURL("image/png"))}else if("image"===r){const{imageData:e,imageOpacity:t,overlayColor:n,overlayOpacity:a}=s,o=new Image;return o.onload=function(){d.globalAlpha=t,d.drawImage(o,0,0,i.width,i.height),d.globalAlpha=a,d.fillStyle=n,d.fillRect(0,0,i.width,i.height),d.globalAlpha=1,p();u(i.toDataURL("image/png"))},void(o.src=e.replace(/"/g,""))}function p(){d.fillStyle=t,d.font=`${a}px ${n}`,d.textAlign="center",d.textBaseline="middle";const r=i.width-40,s=1.2*parseInt(a),l=e.split(" "),c=[];let u=l[0]||"";if(0===l.length||""===l[0])c.push("en"===o?"What are you thinking?":"Chiá»u nay mÃ¬nh gáº·p nhau á»Ÿ Ä‘Ã¢u?");else{for(let e=1;e<l.length;e++){const t=l[e];d.measureText(u+" "+t).width<r?u+=" "+t:(c.push(u),u=t)}c.push(u)}const p=(i.height-c.length*s)/2;for(let e=0;e<c.length;e++)d.fillText(c[e],i.width/2,p+e*s)}}(e.value.text,e.value.textColor,e.value.font,e.value.fontSize,e.value.backgroundType,e.value.backgroundDetails)}))}function l(e,t,n){const a=e.canvas.width;e.fillStyle=t,e.fillRect(0,0,a,a),e.fillStyle=n;for(let t=0;t<2*a;t+=20)e.beginPath(),e.moveTo(t,0),e.lineTo(t-a,a),e.lineTo(t-a+10,a),e.lineTo(t+10,0),e.fill()}function c(e,t,n){const a=e.createLinearGradient(0,0,100,100);a.addColorStop(0,t),a.addColorStop(1,n),e.fillStyle=a,e.fillRect(0,0,100,100)}function u(e){Swal.fire({title:"áº¢nh Ä‘Ã£ táº¡o",imageUrl:e,imageAlt:"áº¢nh Ä‘Ã£ táº¡o",confirmButtonText:"Xong rá»“i báº¡n Æ¡i",showCancelButton:!0,cancelButtonText:"ÄÃ³ng"}).then((e=>{e.isConfirmed&&function(){const e=document.getElementById("canvas");e.getContext("2d"),e.toBlob((function(e){const t=new File([e],"canvas_image.png",{type:"image/png"}),n=new DataTransfer;n.items.add(t);const a=document.getElementById("fileMedia");a.files=n.files,a.dispatchEvent(new Event("change")),a.files}),"image/png")}()}))}function p(){t=!t;const e=t?"Thu há»“i káº¿t báº¡n":"Dá»«ng thu há»“i",n=document.getElementById("toggleButton");n.textContent=t?"Dá»«ng thu há»“i":"Thu há»“i káº¿t báº¡n",n.innerHTML=t?'<i class="fa fa-stop"></i> Dá»«ng thu há»“i':'<i class="fa fa-history"></i> Thu há»“i káº¿t báº¡n',chrome.tabs.query({active:!0,currentWindow:!0},(t=>{t[0].id&&chrome.tabs.sendMessage(t[0].id,{command:e},(e=>{}))}))}function m(){n=!n;const e=n?"Káº¿t báº¡n theo gá»£i Ã½":"Dá»«ng káº¿t báº¡n",t=document.getElementById("toggleButton2");t.textContent=n?"Dá»«ng káº¿t báº¡n":"Káº¿t báº¡n theo gá»£i Ã½",t.innerHTML=n?'<i class="fa fa-stop"></i> Dá»«ng káº¿t báº¡n':'<i class="fa fa-user-plus"></i> Káº¿t báº¡n theo gá»£i Ã½',chrome.tabs.query({active:!0,currentWindow:!0},(t=>{t[0].id&&chrome.tabs.sendMessage(t[0].id,{command:e},(e=>{}))}))}window.currentGroupIds=[],document.addEventListener("DOMContentLoaded",(()=>{!async function(){try{const e=await fetch(chrome.runtime.getURL("../locales/locales.json"));r=await e.json(),s()}catch(e){console.error("Error loading translations:",e)}}(),setTimeout(i,1e3);const e=$("#chkHuyBan");chrome.storage.sync.get("unfriend",(t=>{e.iCheck("uncheck"),chrome.storage.sync.set({unfriend:!1})})),e.on("ifChecked",(function(t){t.preventDefault();const n="en"===o;$.confirm({title:n?"Warning!":"Cáº£nh bÃ¡o!",boxWidth:"350px",useBootstrap:!1,content:n?'The unfriend feature is <span style="color: red; font-weight: bold;">very dangerous</span>. Are you sure you want to enable it?':'TÃ­nh nÄƒng xÃ³a báº¡n <span style="color: red; font-weight: bold;">ráº¥t nguy hiá»ƒm</span>. Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n báº­t khÃ´ng?',buttons:{yes:{text:n?'<span style="color: red; font-weight: bold;">Yes</span>':'<span style="color: red; font-weight: bold;">Báº­t Ä‘i em trai</span>',btnClass:"btn-danger",style:"background-color: red !important; border: none;",action:function(){e.prop("checked",!0).iCheck("update"),chrome.storage.sync.set({unfriend:!0})}},no:{text:n?"No":"Há»§y",action:function(){e.prop("checked",!1).iCheck("update")}}}})})),e.on("ifUnchecked",(()=>{chrome.storage.sync.set({unfriend:!1})})),document.getElementById("openOptions").addEventListener("click",(function(){chrome.runtime.openOptionsPage?chrome.runtime.openOptionsPage():window.open(chrome.runtime.getURL("options.html"))}));const t=document.querySelector(".language-switcher");if(t){const a=document.createElement("style");a.textContent="\n      .language-switcher img {\n        width: 24px;\n        height: 16px;\n        cursor: pointer;\n        border: 1px solid #ddd;\n        transition: all 0.2s;\n        filter: grayscale(70%) opacity(0.5); /* LÃ m má» táº¥t cáº£ cÃ¡c lÃ¡ cá» */\n      }\n\n      .language-switcher img.active {\n        filter: grayscale(0%) opacity(1); /* Hiá»ƒn thá»‹ bÃ¬nh thÆ°á»ng cho lÃ¡ cá» active */\n        transform: scale(1.1); /* LÃ m ná»•i báº­t thÃªm lÃ¡ cá» Ä‘ang Ä‘Æ°á»£c chá»n */\n        box-shadow: 0 0 3px rgba(255,255,255,0.5);\n      }\n\n      .language-switcher img:hover {\n        transform: scale(1.1);\n        filter: grayscale(0%) opacity(0.9); /* Khi hover, luÃ´n hiá»ƒn thá»‹ rÃµ rÃ ng */\n      }\n      \n      /* Styling cho vÄƒn báº£n ngÃ´n ngá»¯ */\n      .language-switcher span {\n        color: #aaa;\n        font-size: 12px;\n        transition: all 0.2s;\n        margin: 0 2px;\n        cursor: pointer; /* ThÃªm cursor pointer khi hover */\n      }\n      \n      .language-switcher span.active {\n        color: white; /* MÃ u xanh lÃ¡ */\n        font-weight: bold;\n      }\n      \n      .language-switcher span:hover {\n        color: #ddd; /* MÃ u sÃ¡ng hÆ¡n khi hover */\n      }\n    ",document.head.appendChild(a);const d=new Map([["VIE","vi"],["ENG","en"]]);function n(){document.querySelectorAll(".language-switcher img, .language-switcher span").forEach((e=>{e.classList.toggle("active",e.dataset.lang===o)}))}document.querySelectorAll(".language-switcher span").forEach((e=>{const t=d.get(e.textContent.trim());t&&e.setAttribute("data-lang",t)})),n(),t.addEventListener("click",(e=>{if("IMG"===e.target.tagName||"SPAN"===e.target.tagName){const t=e.target.dataset.lang;t&&t!==o&&(o=t,localStorage.setItem("zalo_marketing_language",t),n(),s())}}))}})),$("#chkTudongRutGonLink").on("ifChanged",(function(e){const t=$(this).prop("checked");chrome.storage.sync.get("translateSettings",(e=>{const n={...e.translateSettings||{},autoShortLink:t};localStorage.setItem("translateSettings",JSON.stringify(n)),chrome.storage.sync.set({translateSettings:n},(()=>{}))}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=$("#chkTudongRutGonLink"),t=JSON.parse(localStorage.getItem("translateSettings"))||{};e.prop("checked",t.autoShortLink||!1).trigger("change")})),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("dropdownActionsButton"),t=document.getElementById("dropdownActions"),n=(t.querySelector(".dropdown-content"),document.querySelectorAll(".dropdown-item")),a=document.createElement("div");a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.height="10px",a.style.bottom="-10px",a.style.zIndex="10",t.appendChild(a),e.addEventListener("mouseenter",(function(){t.classList.remove("hidden")}));e.parentElement.addEventListener("mouseleave",(function(e){setTimeout((()=>{t.classList.add("hidden")}),100)})),a.addEventListener("mouseenter",(function(){t.classList.remove("hidden")})),n.forEach((e=>{e.addEventListener("click",(function(){t.classList.add("hidden")}))})),e.addEventListener("click",(function(e){e.stopPropagation(),t.classList.toggle("hidden")})),t.addEventListener("click",(function(e){e.stopPropagation()}))})),document.getElementById("toggleButton").addEventListener("click",(()=>{t?p():$.confirm({title:"en"===o?"Notification":"ThÃ´ng bÃ¡o",content:"en"===o?"Are you sure you want to revoke all friend requests?":"Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n thu há»“i táº¥t cáº£ lá»i má»i káº¿t báº¡n khÃ´ng fen?",boxWidth:"350px",useBootstrap:!1,buttons:{["en"===o?"Revoke":"Thu há»“i"]:{btnClass:"btn-red",action:function(){p()}},["en"===o?"Close":"ÄÃ³ng"]:function(){}}})})),document.getElementById("toggleButton2").addEventListener("click",(()=>{n?m():$.confirm({title:"en"===o?"Notification":"ThÃ´ng bÃ¡o",content:"en"===o?"Are you sure you want to send the friend request suggestion?":"Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n gá»Ÿi lá»i má»i káº¿t báº¡n theo gá»£i Ã½ khÃ´ng fen?",boxWidth:"350px",useBootstrap:!1,buttons:{["en"===o?"Add Friend":"Káº¿t báº¡n Ä‘i"]:{btnClass:"btn-red",action:function(){m()}},["en"===o?"Close":"ÄÃ³ng"]:function(){}}})})),$(document).ready((function(){const e=$("#zoom-slider"),t=$("#zoom-value"),n=$("#zoom-container"),a=localStorage.getItem("zoomLevel");a&&(e.val(a),t.text(`${a}%`),n.css("transform",`scale(${a/100})`)),e.on("input",(function(){const e=$(this).val();t.text(`${e}%`),n.css("transform",`scale(${e/100})`),localStorage.setItem("zoomLevel",e)})),$("#use-ai-btn").on("click",(function(){function e(e,t){const n=$("#chat-container"),a="user"===e?"user-message":"ai-message",o="user"===e?"#007BFF":"#333",r="user"===e?"#FFF":"#E5E5E5";n.append(`\n              <div class="${a}" style="padding: 10px; background-color: ${o}; color: ${r}; border-radius: 10px; margin-bottom: 10px;">\n                  ${t}\n              </div>\n          `),n.scrollTop(n.prop("scrollHeight"))}Swal.fire({title:"AI Chat",html:'\n              <div id="chat-container" style="background-color: #1e1e1e; color: #e5e5e5; padding: 10px; border-radius: 10px; max-height: 300px; overflow-y: auto;">\n                  <div class="chat-message" style="padding: 10px; background-color: #333; margin-bottom: 10px; border-radius: 10px;">Hello! How can I assist you today?</div>\n              </div>\n              <textarea id="user-input" placeholder="Type your message..." style="width: 100%; margin-top: 10px; height: 60px; padding: 10px; border-radius: 5px; background-color: #333; color: #e5e5e5;"></textarea>\n          ',showCancelButton:!0,confirmButtonText:"Send",didOpen:()=>{$("#user-input").focus()},preConfirm:()=>{const t=$("#user-input").val().trim();return""===t?(Swal.showValidationMessage("Please enter a message"),!1):(async function(t){e("user",t);try{const n=await fetch("https://key.laptrinhvb.net/ai/chat",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`message=${encodeURIComponent(t)}`}),a=await n.json();a.choices?e("ai",a.choices[0].message.content):e("ai","Sorry, an error occurred.")}catch(t){console.error("Error:",t),e("ai","Sorry, an error occurred.")}}(t),$("#user-input").val(""),!1)}})}))}));const g=document.getElementById("dropdownButton"),h=document.getElementById("dropdownButton2"),f=document.getElementById("dropdownMenu"),b=document.getElementById("dropdownMenu2");var y;h.addEventListener("click",(()=>{b.classList.toggle("hidden")})),g.addEventListener("click",(()=>{f.classList.toggle("hidden")})),window.addEventListener("click",(e=>{g.contains(e.target)||f.contains(e.target)||f.classList.add("hidden")})),window.addEventListener("click",(e=>{h.contains(e.target)||b.contains(e.target)||b.classList.add("hidden")})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("manageCampaignsButton"),t=document.getElementById("campaignModal"),n=document.getElementById("closeModalButton"),a=document.getElementById("vanban-btn"),r=document.getElementById("closeModal"),s=document.getElementById("campaignForm"),l=document.getElementById("campaignName"),c=document.getElementById("campaignContent"),u=document.getElementById("campaignList"),p=document.getElementById("txtMessage"),m="campaigns";a.addEventListener("click",(function(){d()}));let g=null;document.getElementById("tagSelect").addEventListener("mousedown",(function(){i()})),document.getElementById("addItemButton").addEventListener("click",(function(){document.getElementById("campaignForm").classList.remove("hidden"),document.getElementById("addItemButton").classList.add("hidden"),s.reset(),g=null,document.querySelector('#campaignForm button[type="submit"]').textContent="LÆ°u láº¡i"}));const h=document.getElementById("txtMessage");async function f(e){try{const t=await fetch(`https://tinyurl.com/api-create.php?url=${encodeURIComponent(e)}`);if(!t.ok)throw new Error("Failed to shorten the URL");return await t.text()}catch(t){return console.error(t),e}}document.getElementById("shortenBtn").addEventListener("click",(async()=>{await async function(){const e=h.value.match(/(https?:\/\/[^\s]+)/g);if(e)for(const t of e){const e=await f(t);h.value=h.value.replace(t,e)}}()}));const b=e=>{e?(t.style.display="flex",t.style.overflow="auto",document.body.style.overflow="hidden"):(t.style.display="none",document.body.style.overflow="",s.reset(),g=null,document.getElementById("campaignForm").classList.add("hidden"),document.getElementById("addItemButton").classList.remove("hidden"))},y=()=>{const e=JSON.parse(localStorage.getItem(m))||[];if(u.innerHTML="",0===e.length){const e=document.createElement("tr");e.innerHTML=`\n        <td colspan="4" class="border border-gray-300 p-2 text-center text-red-500 font-bold">\n          <span class="mr-2">ğŸ¯</span> \n          ${"en"===o?"No campaigns available yet.":"ChÆ°a cÃ³ chiáº¿n dá»‹ch nÃ o, em trai."}\n        </td>\n      `,u.appendChild(e)}else e.reverse().forEach(((t,n)=>{var a=""+(e.length-1-n);const r=document.createElement("tr"),s=t.content.split("\n"),i=s.slice(0,5).join("<br>"),d=s.join("<br>"),l=s.length>5;r.innerHTML=`\n              <td class="border border-gray-300 p-2">\n                <button class="bg-blue-500 text-white p-1 rounded select-button" data-index="${a}">\n                         ${"en"===o?"Select":"Chá»n"}\n                  </button>\n              </td>\n              <td class="border border-gray-300 p-2">${t.name}</td>\n              <td class="border border-gray-300 p-2">\n                  <div class="campaign-content" data-index="${a}">\n                      ${i}\n                      ${l?`<span class="text-blue-500 cursor-pointer view-more" data-index="${a}">${"en"===o?"View more":"Xem thÃªm"}</span>`:""}\n                  </div>\n                  <div class="full-content hidden" data-index="${a}">\n                      ${d}\n                      <span class="text-blue-500 cursor-pointer view-less" data-index="${a}">${"en"===o?"Less more":"Thu gá»n"}</span>\n                  </div>\n              </td>\n              <td class="border border-gray-300 p-2 text-center space-x-2">\n              \n                <button class="bg-yellow-500 text-white p-1 rounded edit-button" data-index="${a}">\n                    ${"en"===o?"Edit":"Sá»­a"}\n                </button>\n                <button class="bg-red-500 text-white p-1 rounded delete-buttons" data-index="${a}">\n                    ${"en"===o?"Delete":"XÃ³a"}\n                </button>\n            \n              </td>\n          `,u.appendChild(r)}));document.querySelectorAll(".view-more").forEach((e=>{e.addEventListener("click",(e=>{const t=e.target.getAttribute("data-index"),n=document.querySelector(`.campaign-content[data-index="${t}"]`),a=document.querySelector(`.full-content[data-index="${t}"]`);n.classList.add("hidden"),a.classList.remove("hidden")}))}));document.querySelectorAll(".view-less").forEach((e=>{e.addEventListener("click",(e=>{const t=e.target.getAttribute("data-index"),n=document.querySelector(`.campaign-content[data-index="${t}"]`),a=document.querySelector(`.full-content[data-index="${t}"]`);n.classList.remove("hidden"),a.classList.add("hidden")}))}))};s.addEventListener("submit",(e=>{e.preventDefault(),((e,t)=>{const n=JSON.parse(localStorage.getItem(m))||[];null!==g?(n[g]={name:e,content:t},g=null):n.push({name:e,content:t}),localStorage.setItem(m,JSON.stringify(n)),y(),document.getElementById("campaignForm").reset(),document.getElementById("campaignForm").classList.add("hidden"),document.getElementById("addItemButton").classList.remove("hidden")})(l.value.trim(),c.value.trim()),s.reset()})),u.addEventListener("click",(e=>{const t=e.target.getAttribute("data-index"),n=JSON.parse(localStorage.getItem(m))||[];if(e.target.classList.contains("select-button")){const e=n[t];e&&(p.value=e.content,b(!1))}else if(e.target.classList.contains("delete-buttons")){confirm("en"===o?"Do you want to delete this campaign?":"Báº¡n cÃ³ muá»‘n xÃ³a chiáº¿n dá»‹ch nÃ y khÃ´ng?")&&(n.splice(t,1),localStorage.setItem(m,JSON.stringify(n)),y())}else if(e.target.classList.contains("edit-button")){const e=n[t];e&&(document.getElementById("campaignForm").classList.remove("hidden"),document.getElementById("addItemButton").classList.add("hidden"),l.value=e.name,c.value=e.content,g=t,document.querySelector('#campaignForm button[type="submit"]').textContent="Cáº­p nháº­t",s.scrollIntoView({behavior:"smooth"}))}})),e.addEventListener("click",(()=>b(!0))),n.addEventListener("click",(()=>b(!1))),r.addEventListener("click",(()=>b(!1))),t.addEventListener("click",(e=>{e.target===t&&b(!1)})),y()})),toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"3000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},$((function(){!function(){const e=document.getElementById("flashText"),t=e.textContent;e.textContent="",[...t].forEach((t=>{const n=document.createElement("span");" "===t?(n.className="char space",n.innerHTML="&nbsp;"):(n.className="char",n.textContent=t),e.appendChild(n)}));const n=e.getElementsByClassName("char");let a,o=0,r=0;a=setInterval((function(){o>0?n[o-1].classList.remove("flash"):n[n.length-1].classList.remove("flash"),n[o].classList.add("flash"),o=(o+1)%n.length,0===o&&(r++,r>=2&&(clearInterval(a),[...n].forEach((e=>{e.style.opacity="1",e.classList.add("flash")}))))}),90)}(),$(".multiple-select").multipleSelect()}));var x=0;function v(e){if($("#chkAutoScroll").iCheck("update")[0].checked&&e){var t=e.closest("tr");t&&t.scrollIntoView({behavior:"smooth",block:"center"})}}function k(){return document.body.classList.contains("dark-mode")}function E(e){for(var t=document.querySelector(".htCore").querySelectorAll("#dataTableContainer tbody tr"),n=0;n<t.length;n++){var o=t[n],r=o.querySelector("td:nth-child(2)");if(1==a&&(r=o.querySelector("td:nth-child(4)")),r&&r.textContent.trim()===e){var s=o.querySelector("td:nth-child(1) input[type='checkbox']");s&&(s.checked=!1)}}}function w(e,t,n,o){for(var r=document.querySelector(".htCore").querySelectorAll("#dataTableContainer tbody tr"),s=0;s<r.length;s++){var i=r[s],d=i.querySelector("td:nth-child(2)");if(1==a&&(d=i.querySelector("td:nth-child(4)")),d&&d.textContent.trim()===e){var l=i.querySelector("td:nth-child(4)");if(1==a&&(l=i.querySelector("td:nth-child(8)")),v(l),l)return l.textContent=t,void(l.style.color=o)}}}function C(e){$.confirm.defaults=e?{...$.confirm.defaults,theme:"dark",backgroundDismiss:"dark",animation:"scale",closeAnimation:"scale",animateFromElement:!1,boxWidth:"30%",useBootstrap:!1,onOpen:function(){this.$body.addClass("dark-mode")}}:{...$.confirm.defaults,theme:"light",backgroundDismiss:!0,animation:"scale",closeAnimation:"scale",animateFromElement:!1,boxWidth:"30%",useBootstrap:!1,onOpen:function(){this.$body.removeClass("dark-mode")}}}function S(){const e=document.body;e.classList.toggle("dark-mode");const t=e.classList.contains("dark-mode");localStorage.setItem("darkMode",t);document.getElementById("checkbox").checked=t,t?$("#imgBackground").hide():$("#imgBackground").show(),C(t),I(t)}function I(e){const t=document.getElementById("emojiPickerElement");e?t.setAttribute("class","dark"):t.setAttribute("class","light")}document.addEventListener("DOMContentLoaded",(function(){document.getElementById("checkbox").addEventListener("change",S);const t=document.getElementById("emojiButton"),n=document.getElementById("emojiPickerPopup"),d=document.getElementById("emojiPickerElement"),l=document.getElementById("txtMessage");t.addEventListener("click",(function(e){"none"===n.style.display||""===n.style.display?n.style.display="block":n.style.display="none"})),d.addEventListener("emoji-click",(function(e){const t=e.detail.unicode;l.value+=t,n.style.display="none"})),document.addEventListener("click",(function(e){n.contains(e.target)||t.contains(e.target)||(n.style.display="none")})),chrome.storage.local.get(["introShown"],(function(e){e.introShown||(introJs().setOptions({nextLabel:"Tiáº¿p",prevLabel:"Quay láº¡i",doneLabel:"HoÃ n táº¥t",steps:[{intro:"ChÃ o báº¡n, Zalo Marketing Pro"},{element:document.querySelector(".white-preview"),intro:"Chuyá»ƒn cháº¿ Ä‘á»™ sÃ¡ng/tá»‘i."},{element:document.querySelector("#divAvatar"),intro:"Báº¥m vÃ o Ä‘Ã¢y Ä‘á»ƒ quáº£n lÃ½ nhiá»u tÃ i khoáº£n zalo."},{element:document.querySelector("#txtTaiKhoanEmail"),intro:"Báº¥m vÃ o Ä‘Ã¢y xem thÃ´ng tin gÃ³i cÆ°á»›c sá»­ dá»¥ng."},{intro:"Báº¯t Ä‘áº§u sá»­ dá»¥ng."}]}).start(),chrome.storage.local.set({introShown:!0}))})),function(){const e=document.body,t=document.getElementById("checkbox");"true"===localStorage.getItem("darkMode")?(e.classList.add("dark-mode"),t.checked=!0,C(!0),I(!0)):(e.classList.remove("dark-mode"),t.checked=!1,C(!1),I(!1))}(),k?$("#imgBackground").hide():$("#imgBackground").show(),chrome.storage.local.get(["userEmail","loginExpiration"],(function(e){var t=e.userEmail;$.ajax({url:"https://key.laptrinhvb.net/api/get_user_info_new",method:"GET",data:{email:t,app_id:1}}).done((function(e){row_update_id=e.id;e.days_remaining;var t=`${chrome.runtime.getManifest().version}`;"VÄ©nh viá»…n"===e.days_remaining?"en"===o?(e.days_remaining="Unlimited",$("#txtThoiHan").html(`<span style='color: #73e173; font-weight: bold;' id="txtTHSD">${e.days_remaining}.</span> | ${t}`)):$("#txtThoiHan").html(`<span style='color: #73e173; font-weight: bold;' id="txtTHSD">${e.days_remaining}.</span> | ${t}`):Number(e.days_remaining)<=3?"en"===o?$("#txtThoiHan").html(`Expiry: <span style='color: red; font-weight: bold;'>${e.days_remaining} day(s).</span> | ${t}`):$("#txtThoiHan").html(`Háº¡n sá»­ dá»¥ng: <span style='color: red; font-weight: bold;'>${e.days_remaining} ngÃ y.</span> | ${t}`):"en"===o?$("#txtThoiHan").html(`Expiry: <span style='color: #73e173; font-weight: bold;'>${e.days_remaining} day(s).</span> | ${t}`):$("#txtThoiHan").html(`Háº¡n sá»­ dá»¥ng: <span style='color: #73e173; font-weight: bold;'>${e.days_remaining} ngÃ y.</span> | ${t}`)})).fail((function(){console.error("Lá»—i khi táº£i thÃ´ng tin ngÆ°á»i dÃ¹ng.")}))})),chrome.storage.sync.get(["running"],(function({running:e}){function t(e){e?(document.body.classList.add("dark-mode"),a.checked=!0):(document.body.classList.remove("dark-mode"),a.checked=!1)}let n=e+""!="false";const a=document.querySelector("#checkbox");t(n),a.addEventListener("change",(()=>{n=a.checked,chrome.storage.sync.set({running:n},((...e)=>{})),t(n)}))}));const c=document.getElementById("txtMessage"),u=document.getElementById("btnSend"),p=document.getElementById("btnShareAllFen"),m=document.getElementById("btnStop"),g=document.getElementById("btnReset"),h=document.getElementById("btnXoaCache"),f=document.getElementById("btnLogout"),b=document.getElementById("btnXuatExcel"),v=document.getElementById("btnXuatTxt"),L=document.getElementById("btnNhapDienThoai"),B=document.getElementById("btnImportExcel"),T=document.getElementById("btnImportHoaDon"),j=document.getElementById("btnXuatVcard"),A=document.getElementById("btnXuatDanhBa"),N=document.getElementById("btnXuatDanhBaTxt"),_=document.getElementById("btnXuatDanhBaTxtTen"),D=document.getElementById("btnOpenImage"),O=document.getElementById("fileDanhSach"),M=document.getElementById("fileMedia"),P=(document.getElementById("emojiButton"),document.getElementById("emojiPicker"),document.getElementById("txtMessage")),R=document.getElementById("clearIcon"),H=document.getElementById("charCount"),q=document.getElementById("divAvatar"),F=document.getElementById("btnDangXuatAcc");chrome.storage.local.get(["userEmail","loginExpiration"],(function(e){$("#txtTaiKhoanEmail").text(e.userEmail)})),F.addEventListener("click",(()=>{$.confirm({title:"en"===o?"Notification!":"ThÃ´ng bÃ¡o!",content:"en"===o?"Do you want to log out?":"Báº¡n cÃ³ muá»‘n Ä‘Äƒng xuáº¥t?",boxWidth:"350px",useBootstrap:!1,buttons:{["en"===o?"Logout":"ÄÄƒng xuáº¥t"]:{btnClass:"btn-red",action:function(){chrome.storage.local.remove(["userEmail","loginExpiration"]),chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.tabs.sendMessage(t,{task:"CHANGE_PAGE",page:"../page/login.html"})}))}},["en"===o?"Cancel":"KhÃ´ng"]:{btnClass:"btn-gray",action:function(){}}},onOpen:function(){document.body.classList.contains("dark-mode")&&this.$body.addClass("dark-mode")}})}));const G=()=>{const e=P.value.length;H.textContent="en"===o?`${e} chars`:`${e} kÃ½ tá»±`};P.addEventListener("input",(()=>{P.value.length>0?(R.classList.remove("hidden"),H.classList.remove("hidden")):(R.classList.add("hidden"),H.classList.add("hidden")),G()})),R.addEventListener("click",(()=>{P.value="",R.classList.add("hidden"),H.classList.add("hidden"),P.focus(),G()}));const U=localStorage.getItem("savedMessage");function Z(e){const t=document.getElementById("countryCodeInput");if("+84"!==(t?t.value.trim():"+84"))return!0;const n=e.replace(/[\s+]/g,"");return/^(0|\+?84)?(3|5|7|8|9)(\d{8})$/.test(n)}U&&(P.value=U,P.value.length>0&&(R.classList.remove("hidden"),H.classList.remove("hidden"))),G(),P.addEventListener("input",(()=>{localStorage.setItem("savedMessage",P.value)}));let z=!1;var X="";function K(e){const[t,n,a]=e.split("-");return`${a}/${n}/${t}`}function W(){setTimeout(V,200)}function V(){var e=document.querySelector("table").querySelector("#dataTableContainer tbody");if(!e)return"0/0";var t=e.querySelectorAll('input[type="checkbox"]'),n=0;t.forEach((e=>{e.checked&&n++}));var a=t.length;return document.getElementById("total_item").textContent=`(${n}/${a})`,n+"/"+a}function J(e,t){const n=e.filter((e=>e.displayName?.trim())).sort(((e,t)=>e.displayName.localeCompare(t.displayName,"vi",{sensitivity:"base"}))).map((e=>`${e.displayName}\n............................`)),a=new Blob([n.join("\n")],{type:"text/plain;charset=utf-8"}),o=document.createElement("a");o.href=URL.createObjectURL(a),o.download=t+".txt",document.body.appendChild(o),o.click(),document.body.removeChild(o)}function Y(e,t){const n=e.sort(((e,t)=>{const n=e.phoneNumber?1:0;return(t.phoneNumber?1:0)-n})).map((e=>e.phoneNumber?`${e.displayName}|${e.phoneNumber}`:`${e.displayName}`)),a=new Blob([n.join("\n")],{type:"text/plain;charset=utf-8"}),o=document.createElement("a");o.href=URL.createObjectURL(a),o.download=t+".txt",document.body.appendChild(o),o.click(),document.body.removeChild(o)}function Q(e){return`BEGIN:VCARD\nVERSION:3.0\nFN:${e.displayName}\nTEL;TYPE=CELL:${e.phoneNumber}\nCATEGORIES:myContacts\nBDAY:${e.sdob}\nEND:VCARD`}function ee(e,t){const n=e.filter((e=>e.phoneNumber)),a=n.map(Q).join("\n"),o=new Blob([a],{type:"text/vcard"}),r=document.createElement("a");r.href=URL.createObjectURL(o),r.download=`${t}.vcf`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}function te(e,t){const n=XLSX.utils.json_to_sheet(e),a=XLSX.utils.book_new();XLSX.utils.book_append_sheet(a,n,"Friends"),XLSX.writeFile(a,`${t}.xlsx`)}$(document).ready((function(){function e(){const e=document.getElementById("countryCodeInput").value;chrome.storage.local.set({countryCode:e},(function(){}))}$("#btnTaiFileMau").on("click",(function(){const e=document.createElement("a");e.href="../filemau/filemau.zip",e.download="filemau.zip",document.body.appendChild(e),e.click(),document.body.removeChild(e)})),window.onload=function(){var t;t=function(e){e&&(document.getElementById("countryCodeInput").value=e)},chrome.storage.local.get(["countryCode"],(function(e){e.countryCode?(e.countryCode,t(e.countryCode)):t("")})),document.getElementById("countryCodeInput").addEventListener("input",e)},chrome.storage.local.get(["userEmail","loginExpiration"],(function(e){X=e.userEmail}))})),$(document).on("click","#txtTaiKhoanEmail",(function(){var e="";$.confirm({title:'<span class="text-yellow-600 text-lg font-bold">'+("en"===o?"Account Information":"ThÃ´ng tin tÃ i khoáº£n")+"</span>",boxWidth:"550px",useBootstrap:!1,content:function(){var t=this;return $.ajax({url:"https://key.laptrinhvb.net/api/get_user_info",method:"POST",data:{email:X,app_id:1}}).done((function(n){e=n.id;let a=(n.days_remaining,"bg-green-500 text-white");t.setContent(`\n              <div class="p-4 flex">\n                <div class="flex-grow">\n                    <p class="mb-2"><strong>Email:</strong> ${n.email}</p>\n                    <p class="mb-2"><strong>${"en"===o?"Address:":"Äá»‹a chá»‰:"}</strong> ${n.address}</p>\n                    <p class="mb-2"><strong>${"en"===o?"Registration Date:":"NgÃ y Ä‘Äƒng kÃ½:"}</strong> ${K(n.register_date)}</p>\n                    <p class="mb-2"><strong>${"en"===o?"Expiry Date:":"NgÃ y háº¿t háº¡n:"}</strong> ${K(n.expiry_date)}</p>\n                    <p class="mb-2"><strong>${"en"===o?"Account Package:":"GÃ³i tÃ i khoáº£n:"}</strong> <span style='color: green; font-weight: bold;'>${n.license_type}</span></p>\n                    <p class="mb-4">\n                        <strong>${"en"===o?"Days Remaining:":"Sá»‘ ngÃ y cÃ²n láº¡i:"}</strong> \n                        <span class="px-2 py-1 rounded ${a}">\n                            ${n.days_remaining}\n                        </span>\n                    </p>\n                    <button id="togglePasswordFields" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded mb-4">\n                        ${"en"===o?"Change Password":"Äá»•i máº­t kháº©u"}\n                    </button>\n                </div>\n               \n                </div>\n\n                <div id="passwordFields" style="display: none;">\n                    <div class="mb-4">\n                    <input type="password" id="oldPassword" placeholder="${"en"===o?"Old Password":"Máº­t kháº©u cÅ©"}" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">\n                    </div>\n                    <div class="mb-4">\n                    <input type="password" id="newPassword" placeholder="${"en"===o?"New Password":"Máº­t kháº©u má»›i"}" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">\n                    </div>\n                    <button id="submitChangePassword" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded mb-4">\n                    ${"en"===o?"Confirm Change Password":"XÃ¡c nháº­n Ä‘á»•i máº­t kháº©u"}\n                    </button>\n                </div>\n\n                <hr class="my-4 border-t border-gray-300">\n\n                <div class="mb-4">\n                <p class="font-bold">${"en"===o?"Contact Information:":"ThÃ´ng tin liÃªn há»‡:"}</p>\n                <p>Zalo: <a href="https://zalo.me/0933913122" target="_blank">https://zalo.me/0933913122</a></p>\n                <p>${"en"===o?"Phone:":"Äiá»‡n thoáº¡i:"} +84 933.913.122</p>\n                </div>\n\n                <div class="mt-4">\n                <a href="https://chrome.google.com/webstore/detail/kgbfpnnjchndjegeckjggbgcmklefman/review" target="_blank" class="text-blue-500 hover:underline">\n                ${"en"===o?"ğŸ“Œ Review the extension on Chrome Web Store":"ğŸ“Œ ÄÃ¡nh giÃ¡ tiá»‡n Ã­ch trÃªn Chrome Web Store"}\n                </a>\n                </div>\n              </div>\n            `)})).fail((function(){t.setContent("en"===o?"Error loading user information.":"Lá»—i khi táº£i thÃ´ng tin ngÆ°á»i dÃ¹ng.")}))},onContentReady:function(){$("#togglePasswordFields").on("click",(function(){$("#passwordFields").toggle()})),$("#submitChangePassword").on("click",(function(){toastr.options={toastClass:"toastr toastr-high-z-index"};var t=$("#oldPassword").val(),n=$("#newPassword").val();if(!t||!n)return toastr.error("en"===o?"Please enter both old and new passwords.":"Vui lÃ²ng nháº­p Ä‘áº§y Ä‘á»§ cáº£ máº­t kháº©u cÅ© vÃ  má»›i."),!1;$.ajax({url:"https://key.laptrinhvb.net/api/change_password",method:"POST",data:{id:e,old_password:t,new_password:n},success:function(e){e.success?(toastr.success("en"===o?"Password changed successfully. Please log in again.":"Máº­t kháº©u Ä‘Ã£ Ä‘Æ°á»£c thay Ä‘á»•i thÃ nh cÃ´ng, vui lÃ²ng Ä‘Äƒng nháº­p láº¡i."),setTimeout((()=>{chrome.storage.local.remove(["userEmail","loginExpiration"]),chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.tabs.sendMessage(t,{task:"CHANGE_PAGE",page:"../page/login.html"})}))}),3e3)):toastr.error(e.message||("en"===o?"Unable to change password. Please try again.":"KhÃ´ng thá»ƒ thay Ä‘á»•i máº­t kháº©u. Vui lÃ²ng thá»­ láº¡i."))},error:function(){toastr.error("en"===o?"Error connecting to the server. Please try again later.":"ÄÃ£ xáº£y ra lá»—i khi káº¿t ná»‘i vá»›i mÃ¡y chá»§. Vui lÃ²ng thá»­ láº¡i sau.")}})}))},buttons:{close:{text:"en"===o?"Close":"ÄÃ³ng",btnClass:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded",action:function(){}}}})})),p.addEventListener("click",(()=>{var e;chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.tabs.sendMessage(t,{task:"GET_ALL_TAG"})})),function(e){const t=e;new Promise((e=>{setTimeout(e,t)}))}(800),0==$("#chkShowModal").iCheck("update")[0].checked&&$("#chkShowModal").iCheck("check"),$.confirm({title:`<span style="color: #B97902; font-size: 18px; font-weight: bold;">\n  ${"en"===o?"Select Content":"Chá»n ná»™i dung"}\n</span>`,boxWidth:"550px",columnClass:"medium",useBootstrap:!1,content:`<div style="margin-left: 4px; margin-right: 4px; margin-bottom: 4px; min-height: 400px; max-height: 420px; overflow-y: auto;">\n            <div style='float: left; display: none;'>\n                <label>\n                      <input type="checkbox" id="chkISPHANLOAI">\n                  <label class="block text-sm font-medium text-gray-700" style="display: inline;">\n                    ${"en"===o?"Uncategorized":"KhÃ´ng phÃ¢n loáº¡i"}\n                  </label>\n\n                    </label></div>\n            <div style='float: right;'><span><b data-translate="tags">Tags:</b> </span><select id="labelSelect2" class="multiple-select2" multiple style="margin-top: 6px;"> \n              \n            </select></div>\n            <div id="taskContainer" class="form-group" style="padding: 4px; clear: both;"></div>\n            <button id="btnAddContent" class="add-task-button text-base shadow-lg appearance-none border border-blue-300 rounded-lg w-full py-2 px-4 mt-2 bg-white text-blue-500 hover:bg-blue-500 hover:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">\n              ${"en"===o?"Add Content":"ThÃªm ná»™i dung"}\n            </button>\n\n            <div style="padding: 4px; clear: both; margin-top: 8px;">\n                <label for="delay" class="block text-sm font-medium text-gray-700">\n                  ${"en"===o?"Enter attached message: (if desired)":"Nháº­p tin nháº¯n Ä‘Ã­nh kÃ¨m: (náº¿u muá»‘n)"}\n                </label>\n\n                <textarea rows="2" class="text-base shadow-lg appearance-none border border-gray-300 rounded-lg w-full py-2 px-4 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" id="txtMessageShare" placeholder="${"en"===o?"Enter message...":"Nháº­p tin nháº¯n..."}" style="margin-top: 4px;"></textarea>\n\n              \n            </div>\n            <div id="statusShare"></div>\n            </div>\n        `,onOpen:function(){document.body.classList.contains("dark-mode")&&this.$body.addClass("dark-mode")},buttons:{formSubmit:{text:""+("en"===o?"Share":"Chia sáº»"),btnClass:"share-button",action:function(t){if(!1===z){var n=function(){for(var e=document.getElementById("taskContainer").getElementsByClassName("card"),t=[],n=0;n<e.length;n++){var a=e[n].getElementsByClassName("card-content")[0];t.push({content:a.textContent.trim()})}return t}();if(n.length<=0)return toastr.error("en"===o?"No content selected to share, buddy.":"ChÆ°a chá»n ná»™i dung Ä‘á»ƒ chia sáº», báº¡n Æ¡i."),!1;t.setText("en"===o?"Stop":"Dá»«ng láº¡i"),t.addClass("stop-button"),t.removeClass("share-button"),z=!0;var a=document.getElementById("txtMessageShare").value;document.getElementById("statusShare").textContent="en"===o?"Status: The system is starting to share...":"Tráº¡ng thÃ¡i: Há»‡ thá»‘ng Ä‘ang tiáº¿n hÃ nh báº¯t Ä‘áº§u share...",chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.tabs.sendMessage(t,{task:"REQUEST_SHOW_MODAL",isShowModal:!0})}));var r=e.multipleSelect("getSelects","text");chrome.storage.local.get(["tabZalo"],(function(e){var t=$("#chkISPHANLOAI").is(":checked");const o=e.tabZalo.id;chrome.tabs.sendMessage(o,{task:"START_SHARE",data:n,tags:r,message:a,isPhanLoaiShare:t})}))}else z=!1,toastr.info("en"===o?"You have successfully requested to stop sharing.":"Báº¡n Ä‘Ã£ yÃªu cáº§u dá»«ng share thÃ nh cÃ´ng."),t.setText("en"===o?"Share":"Chia sáº»"),t.removeClass("stop-button"),t.addClass("share-button"),chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.tabs.sendMessage(t,{task:"STOP_SHARE",data:n})}));return!1}},close:{text:""+("en"===o?"Close":"ÄÃ³ng"),action:function(){}}},onContentReady:function(){const t=document.getElementById("btnAddContent");t.addEventListener("click",(function(){"Há»§y chá»n"===t.textContent?(t.textContent="ThÃªm ná»™i dung",chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.tabs.sendMessage(t,{task:"HUY_CONTENT_SHARE"})})),chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.tabs.sendMessage(t,{task:"REQUEST_SHOW_MODAL",isShowModal:!0})}))):(t.textContent="en"===o?"Cancel Selection":"Há»§y chá»n",chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.tabs.sendMessage(t,{task:"CHOICE_CONTENT_SHARE"})})),chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.tabs.sendMessage(t,{task:"REQUEST_SHOW_MODAL",isShowModal:!1})})))}));const n=document.getElementById("labelSelect2");if(n){n.innerHTML="",$("#labelSelect2").on("change",(function(){var e=$(this).val()&&$(this).val().length===$("#labelSelect2 option").length;$("#chkISPHANLOAI").prop("checked",e)}));let e=[];window.g_labels&&window.g_labels.length>0?e=window.g_labels.map((e=>"object"==typeof e?e.text||e.name:e)):y&&y.length>0&&(e=y),e.forEach((e=>{if(e&&"undefined"!==e&&"KhÃ´ng cÃ³ nhÃ£n"!==e){const t=document.createElement("option");t.value=e,t.text=e,n.add(t)}}))}var a=$(".multiple-select2");e=$(".multiple-select2"),a.multipleSelect({maxHeight:200,onClick:function(e){a.multipleSelect("getSelects","text")}});const r=document.querySelector(".multiple-select2");r&&(r.style.width="100%"),a.multipleSelect("checkAll")}})})),q.addEventListener("click",(()=>{})),L.addEventListener("click",(()=>{$.confirm({title:"en"===o?'<span style="color: #CA3486; font-size: 18px; font-weight: bold;">Add New</span>':'<span style="color: #CA3486; font-size: 18px; font-weight: bold;">ThÃªm má»›i</span>',boxWidth:"350px",columnClass:"medium",useBootstrap:!1,content:`<div class="form-group" style="padding: 4px"><textarea id="txtListPhone" class="phoneNumbers text-base shadow-lg appearance-none border border-gray-300 rounded-lg w-full py-2 px-4 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" rows="5" placeholder="${"en"===o?"Enter phone numbers...":"Nháº­p sá»‘ Ä‘iá»‡n thoáº¡i..."}"></textarea>\n</div>`,onOpen:function(){document.body.classList.contains("dark-mode")&&this.$body.addClass("dark-mode")},buttons:{formSubmit:{text:"en"===o?"Done":"Cáº­p nháº­t",btnClass:"btn-blue",action:function(){var e=this.$content.find(".phoneNumbers").val().split("\n").filter(Z);if(e.length<=0)return toastr.error("KhÃ´ng tÃ¬m tháº¥y sá»‘ Ä‘iá»‡n thoáº¡i nÃ o há»£p lá»‡"),$("#txtListPhone").focus(),!1;var t=[...new Set(e)],n=[["PHONE","NAME"],...t.map((e=>[e,""]))];$("tbody").length&&$("#dataTableContainer tbody tr").each((function(){var e=$(this).find("td:nth-child(2)").text().trim();e&&!t.includes(e)&&(t.push(e),n.push([e,$(this).find("td:nth-child(3)").text().trim()||""]))})),pe(n,"khÃ¡ch hÃ ng"),this.close()}},close:{text:"en"===o?"Close":"ÄÃ³ng",action:function(){}}},onContentReady:function(){$("#txtListPhone").focus()}})})),j.addEventListener("click",(()=>{document.getElementById("dropdown-menu").classList.toggle("hidden"),chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.runtime.sendMessage({action:"GET_FRIENDS_API",tabId:t},(e=>{e&&e.success?ee(e.data,"ZALO_CONTACT_VCARD"):toastr.error("Lá»—i khi láº¥y danh sÃ¡ch báº¡n bÃ¨: "+(e?e.error:"Unknown error"))}))}))})),A.addEventListener("click",(()=>{document.getElementById("dropdown-menu").classList.toggle("hidden"),chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.runtime.sendMessage({action:"GET_FRIENDS_API",tabId:t},(e=>{e&&e.success?te(e.data,"ZALO_FRIENDS_ALL"):toastr.error("Lá»—i khi láº¥y danh sÃ¡ch báº¡n bÃ¨: "+(e?e.error:"Unknown error"))}))}))})),N.addEventListener("click",(()=>{document.getElementById("dropdown-menu").classList.toggle("hidden"),chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.runtime.sendMessage({action:"GET_FRIENDS_API",tabId:t},(e=>{e&&e.success?Y(e.data,"ZALO_FRIENDS_ALL_TXT"):toastr.error("Lá»—i khi láº¥y danh sÃ¡ch báº¡n bÃ¨: "+(e?e.error:"Unknown error"))}))}))})),_.addEventListener("click",(()=>{document.getElementById("dropdown-menu").classList.toggle("hidden"),chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.runtime.sendMessage({action:"GET_FRIENDS_API",tabId:t},(e=>{e&&e.success?J(e.data,"DANHBA_TEN_ZALO"):toastr.error("Lá»—i khi láº¥y danh sÃ¡ch báº¡n bÃ¨: "+(e?e.error:"Unknown error"))}))}))})),document.getElementById("menu-button2").addEventListener("click",(function(){document.getElementById("dropdown-menu2").classList.toggle("hidden")})),document.getElementById("menu-button").addEventListener("click",(function(){document.getElementById("dropdown-menu").classList.toggle("hidden")})),document.addEventListener("click",(function(e){var t=document.getElementById("menu-button").contains(e.target),n=document.getElementById("dropdown-menu");t||n.contains(e.target)||n.classList.add("hidden")})),$("input.icheck").iCheck({checkboxClass:"icheckbox_flat-green",increaseArea:"16%"}),v.addEventListener("click",(()=>{document.getElementById("dropdown-menu").classList.toggle("hidden");const e=document.querySelector(".htCore");if(!e)return toastr.error("KhÃ´ng cÃ³ dá»¯ liá»‡u Ä‘á»ƒ xuáº¥t file, báº¡n Æ¡i."),void console.error('Table with class "htCore" not found.');chrome.storage.local.get(["IS_PHAT_CODE"],(function(t){if(1==t.IS_PHAT_CODE)!function(){let e=document.querySelectorAll("#dataTableContainer tbody tr"),t="";e.forEach((e=>{let n=e.cells[1].innerText,a=e.cells[2].innerText,o=e.cells[3].innerText.includes("ÄÃ£ gá»­i")?"OK":"ERROR";t+=`${n}|${a}|${o}\n`}));let n=new Blob([t],{type:"text/plain"}),a=window.URL.createObjectURL(n),o=document.createElement("a");o.href=a,o.download="DATA_SEND_OTP_OK.txt",o.click(),window.URL.revokeObjectURL(a)}();else{const t=e.querySelectorAll("tr"),n=[];t.forEach((e=>{const t=e.querySelectorAll("td");if(t.length>=3&&"OK"===t[3].textContent.trim()){const e=t[1].textContent.trim();n.push(e)}}));const a=n.join("\n"),o=new Blob([a],{type:"text/plain"}),r=URL.createObjectURL(o),s=document.createElement("a");s.href=r,s.download="DANHSACH_PHONE_OK_ZALO.txt",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}}))})),b.addEventListener("click",(()=>{const e=document.querySelector(".htCore"),t=[],n=[];if(document.getElementById("dropdown-menu").classList.toggle("hidden"),e.querySelectorAll("#dataTableContainer thead th").forEach((e=>{n.push(e.innerText.trim())})),n.length>0)t.push(n);else{const e=undefined.getColHeader();t.push(e)}e.querySelectorAll("#dataTableContainer tbody tr").forEach((e=>{const n=[];e.querySelectorAll("td").forEach((e=>{n.push(e.innerText.trim())})),t.push(n)}));const a=XLSX.utils.book_new(),o=XLSX.utils.aoa_to_sheet(t);XLSX.utils.book_append_sheet(a,o,"Sheet1");const r=XLSX.write(a,{bookType:"xlsx",type:"array"});saveAs(new Blob([r],{type:"application/octet-stream"}),"zalo_data_export.xlsx")})),chrome.storage.local.get(["settings"],(function(e){if(e.settings){let s=e.settings.delay,i=e.settings.delay1,d=e.settings.delay2,l=e.settings.delay3,c=e.settings.isKiemTraHopLe,u=e.settings.isKetBan,p=e.settings.isTuDongKetBan,m=e.settings.isDoiTen,g=e.settings.isKetBanNhom;e.settings;var t=c?"check":"uncheck",n=u?"check":"uncheck",a=p?"check":"uncheck",o=m?"check":"uncheck",r=g?"check":"uncheck";$("#chkKiemTraHopLe").iCheck(t),$("#chkKetBan").iCheck(n),$("#chkTuDongKetBan").iCheck(a),$("#chkDoiTen").iCheck(o),$("#chkKetBanNhom").iCheck(r),$("#delay").val(s),$("#delay1").val(i),$("#delay2").val(d),$("#delay3").val(""==l?3:l)}})),f.addEventListener("click",(()=>{$.confirm({title:"en"===o?"Notification!":"ThÃ´ng bÃ¡o!",content:"en"===o?"Do you want to log out of your Zalo account?":"Báº¡n cÃ³ muá»‘n Ä‘Äƒng xuáº¥t tÃ i khoáº£n zalo?",boxWidth:"350px",useBootstrap:!1,onOpen:function(){document.body.classList.contains("dark-mode")&&this.$body.addClass("dark-mode")},buttons:{["en"===o?"Logout":"ÄÄƒng xuáº¥t"]:{btnClass:"btn-red",action:function(){chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.runtime.sendMessage({task:"LOGOUT"}),chrome.tabs.sendMessage(t,{task:"LOGOUT"})}))}},["en"===o?"Cancel":"KhÃ´ng"]:{btnClass:"btn-gray",action:function(){}}}})})),h.addEventListener("click",(()=>{$.confirm({title:"en"===o?"Notification!":"ThÃ´ng bÃ¡o!",content:"en"===o?"Do you agree to clear the cache? The page will reload afterward.":"Báº¡n cÃ³ Ä‘á»“ng Ã½ muá»‘n xÃ³a cache bá»™ nhá»› Ä‘á»‡m khÃ´ng, khi xÃ³a xong há»‡ thá»‘ng sáº½ reload láº¡i trang?",boxWidth:"350px",useBootstrap:!1,onOpen:function(){document.body.classList.contains("dark-mode")&&this.$body.addClass("dark-mode")},buttons:{["en"===o?"Clear":"XÃ³a"]:{btnClass:"btn-red",action:function(){chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.tabs.sendMessage(t,{task:"XOA_CACHE"})}))}},["en"===o?"Close":"ÄÃ³ng"]:{btnClass:"btn-gray",action:function(){}}}})})),g.addEventListener("click",(()=>{$.confirm({title:"en"===o?"Notification!":"ThÃ´ng bÃ¡o!",content:"en"===o?"Do you agree to refresh the data?":"Báº¡n cÃ³ Ä‘á»“ng Ã½ muá»‘n lÃ m má»›i dá»¯ liá»‡u?",boxWidth:"350px",useBootstrap:!1,onOpen:function(){document.body.classList.contains("dark-mode")&&this.$body.addClass("dark-mode")},buttons:{["en"===o?"Confirm":"Äá»“ng Ã½"]:{btnClass:"btn-green",action:function(){ne=[],$("#fileMedia").val(""),$("#thumbnailPreview").empty(),$("#thumbnailPreview").height("0px"),$("#dataTableContainer").empty(),document.querySelectorAll("td:nth-child(4)").forEach((function(e){})),$("#txtMessage").val(""),$("#tableCount").empty(),$("#selectedItemsCount").html("en"===o?'You have selected <span class="text-blue-500 font-bold">0</span> files.':'Báº¡n Ä‘Ã£ chá»n <span class="text-blue-500 font-bold">0</span> táº­p tin.'),chrome.storage.local.set({DanhSach:[]})}},["en"===o?"No":"KhÃ´ng"]:{btnClass:"btn-red",action:function(){}}}})})),chrome.runtime.onMessage.addListener((function(e,t,n){if("USER_INFO"===e.task){var r=e.data;let t=r.name.trim().split(" ").slice(-2).join(" ");$("#txtusername_zalo").text(t),$("#img_avatar").attr("src",r.avatarUrl)}if("COOKIES_COPIED"===e.task){var d=document.getElementById("txtCookie"),l=document.getElementById("txtUsername"),c=document.getElementById("txtImage");if(l){l.value=$("#txtusername_zalo").text(),c&&(c.value=$("#img_avatar").attr("src")),d.value=e.data;var p=document.querySelector(".btn-add-acc");p&&p.click()}}"TRANGTHAI_SHARE"===e.task&&(document.getElementById("statusShare").textContent=e.message);if("CHON_XONG_NOIDUNG"==e.task){var g=e.data,h=document.getElementById("taskContainer");document.getElementById("btnAddContent").textContent="ThÃªm ná»™i dung";var f=document.createElement("div");f.className="card";var b=document.createElement("div");b.className="card-content",b.textContent=g;var v=document.createElement("button");v.className="clear-button",v.textContent="XÃ³a",v.style.display="none",f.addEventListener("mouseover",(()=>{v.style.display="block"})),f.addEventListener("mouseout",(()=>{v.style.display="none"})),v.addEventListener("click",(()=>{f.remove()})),f.appendChild(b),f.appendChild(v),h.appendChild(f)}if("FINISH_SEND_MESSAGE"===e.task&&(u.style.display="block",m.style.display="none","en"==o?toastr.success("The operation has been completed successfully."):toastr.success("ÄÃ£ thá»±c hiá»‡n nghiá»‡p vá»¥ hoÃ n táº¥t, báº¡n Æ¡i.")),"CURRENT_PROCESSING_ITEM"===e.task){var k=e.data;m.textContent="en"==o?"Stop sending":"Dá»«ng gá»Ÿi";let t=document.getElementById("total_item");var C=function(){let e=0;return document.querySelectorAll("table.myTable tbody tr").forEach((t=>{let n=t.querySelector("td:nth-child(4)");n&&"rgb(56, 158, 13)"===window.getComputedStyle(n).color&&e++})),e}();let n=parseInt(k.split("/")[0].replace("(",""),10);t.innerHTML=`${k} (<span style="color: green;">${C}</span> / <span style="color: red;">${n-C}</span>)`}if("PROCESSING_ITEM"===e.task){var S=(k=e.data)[0];1==a&&(S=k[2]),w(S,"en"==o?"Sending...":"Äang gá»Ÿi...",0,"#eb2f96")}if("SLEEP_COUNT_DOWN"===e.task){var I=e.countdown,L=e.item;S=L[0];1==a&&(S=L[2]),-1==I?w(S,"en"==o?"System stop sending...":"Há»‡ thá»‘ng dá»«ng gá»Ÿi tin...",0,"#262626"):w(S,"en"==o?`Waiting... (${I}) seconds`:`Chá» xá»­ lÃ½ (${I})`,0,"#cf1322")}if("TRANGTHAI_SEND_MESSAGE"===e.task){k=e.data;if($("#chkKiemTraHopLe").iCheck("update")[0].checked){if("ok"==k.status)return w(k.phone.phone,k.message,0,"#389e0d"),function(e,t,n,a){for(var o=document.querySelector(".htCore").querySelectorAll("#dataTableContainer tbody tr"),r=0;r<o.length;r++){var s=o[r],i=s.querySelector("td:nth-child(2)");if(i&&i.textContent.trim()===e){var d=s.querySelector("td:nth-child(3)");if(d)return d.textContent=t,void(d.style.color=a)}}}(k.phone.phone,k.phone.username,0,"#eb2f96"),void E(k.phone.phone);"block"==k.status?(w(k.phone,k.message,0,"#ff7875"),m.click()):w(k.phone,k.message,0,"#ff7875"),E(k.phone)}else"ok"==k.status?("en"==o&&(k.message=k.message.replace("ÄÃ£ gá»­i tin nháº¯n Ä‘áº¿n:","Message has been sent to:")),w(k.phone,k.message,0,"#389e0d")):"block"==k.status?(w(k.phone,k.message,0,"#ff7875"),m.click()):w(k.phone,k.message,0,"#ff7875"),E(k.phone)}if("DATA_LIST_TAGS"===e.task){const t=e.friends.filter((e=>[0,1,2].includes(e.type)));t.map((e=>[e.userId,e.displayName])).sort(((e,t)=>e[1].localeCompare(t[1]))).unshift(["UID","Name"]);const n=new Set;t.forEach((e=>{n.add(e.tag)})),y=Array.from(n)}if("DATA_LIST_FRIEND_RECEIVED_EXPORT"===e.task){te(e.friends,"ZALO_FRIENDS_ALL")}if("DATA_LIST_FRIEND_RECEIVED_EXPORT_TXT"===e.task){Y(e.friends,"ZALO_FRIENDS_ALL_TXT")}if("DATA_LIST_FRIEND_RECEIVED_EXPORT_TXT_TEN"===e.task){J(e.friends,"DANHBA_TEN_ZALO")}if("DATA_LIST_FRIEND_VCARD_EXPORT"===e.task){ee(e.friends,"ZALO_CONTACT_VCARD")}if("DATA_LIST_FRIEND_RECEIVED"===e.task){const t=e.friends;(x=e.isGroup)?(window.currentGroupIds=t.map((e=>e.userId||e.id||e.group_id||e.groupId)),window.currentGroupIds.length):window.currentGroupIds=[],i().then((()=>{const e=t.filter((e=>[0,1,2].includes(e.type))),n=e.map((e=>[e.userId,e.displayName])).sort(((e,t)=>e[1].localeCompare(t[1])));function a(e){const t="Ã Ã¡áº¡áº£Ã£Ã¢áº§áº¥áº­áº©áº«Äƒáº±áº¯áº·áº³áºµÃ¨Ã©áº¹áº»áº½Ãªá»áº¿á»‡á»ƒá»…Ã¬Ã­á»‹á»‰Ä©Ã²Ã³á»á»ÃµÃ´á»“á»‘á»™á»•á»—Æ¡á»á»›á»£á»Ÿá»¡Ã¹Ãºá»¥á»§Å©Æ°á»«á»©á»±á»­á»¯á»³Ã½á»µá»·á»¹Ä‘";e=e.toLowerCase();for(let n=0;n<67;n++)e=e.replace(new RegExp(t[n],"gi"),"aaaaaaaaaaaaaaaaaeeeeeeeeeeeiiiiiooooooooooooooooouuuuuuuuuuuyyyyyd"[n]);return e=e.replace(/\s/g,"").trim()}n.unshift(["UID","Name"]),"en"==o?$("#tableCount").html(`You are selected <span class="text-blue-500 font-bold" id="total_item">(0/${n.length-1})</span> friends.  <select id="labelSelect" class="multiple-select" multiple style="margin-top: 6px;"> \n              \n            </select>\n            <button  class="splitDataBtn bg-blue-500 text-white px-4 py-1 rounded text-sm"><i class="fa fa-scissors" aria-hidden="true"></i> <span data-translate="split_group">TÃ¡ch nhÃ³m</span></button>\n              <div style="position: relative; float: right;">\n                    <input type="text" id="searchInput" data-translate-placeholder="search" class="w-full px-3 py-1 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" style="margin-top: -2px;">\n                    </div>\n            \n            `):$("#tableCount").html(`Báº¡n Ä‘Ã£ chá»n <span class="text-blue-500 font-bold" id="total_item">(0/${n.length-1})</span> báº¡n bÃ¨.  <select id="labelSelect" class="multiple-select" multiple style="margin-top: 6px;"> \n              \n            </select>\n            <button  class="splitDataBtn bg-blue-500 text-white px-4 py-1 rounded text-sm"><i class="fa fa-scissors" aria-hidden="true"></i> <span data-translate="split_group">TÃ¡ch nhÃ³m</span></button>\n              <div style="position: relative; float: right;">\n                    <input type="text" id="searchInput" data-translate-placeholder="search" class="w-full px-3 py-1 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" style="margin-top: -2px;">\n                    </div>\n            \n            `),s(),document.getElementById("searchInput").addEventListener("input",(function e(){const t=a(document.getElementById("searchInput").value),n=document.querySelector("#dataTableContainer table"),o=n.getElementsByTagName("tr");let r=0;const s=n.querySelector(".no-data-row");s&&s.remove();for(let e=1;e<o.length;e++){const n=o[e].getElementsByTagName("td")[2];if(n){a(n.textContent).indexOf(t)>-1?(o[e].style.display="",r++):o[e].style.display="none"}}if(0===r){const t=n.insertRow();t.className="no-data-row";const a=t.insertCell(0);a.colSpan=10,a.innerHTML='\n              <div class="flex flex-col items-center justify-center py-8 text-gray-400">\n                <div class="mb-2">\n                  <i class="fa fa-search fa-3x" aria-hidden="true"></i>\n                </div>\n                <p class="text-lg font-medium">KhÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u</p>\n                <p class="text-sm mb-4">Vui lÃ²ng thá»­ tá»« khÃ³a khÃ¡c</p>\n                 <button id="btnResetSearchGlobal" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-150 ease-in-out">\n                    <i class="fa fa-refresh mr-2"></i> Thá»­ tá»« khÃ³a khÃ¡c\n                </button>\n              </div>\n            ',a.style.textAlign="center",a.style.padding="20px",a.style.border="none",setTimeout((()=>{const t=document.getElementById("btnResetSearchGlobal");t&&t.addEventListener("click",(()=>{const t=document.getElementById("searchInput");t&&(t.value="",e(),t.focus())}))}),0)}}));const r=document.getElementById("searchInput"),i=document.createElement("button");i.textContent="âœ•",i.className="absolute right-3 top-1/6 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",i.style.top="12px",i.addEventListener("click",(function(){document.getElementById("searchInput").value="";const e=document.querySelector("#dataTableContainer table"),t=e.getElementsByTagName("tr"),n=e.querySelector(".no-data-row");n&&n.remove();for(let e=1;e<t.length;e++)t[e].style.display=""}));const d=document.createElement("div");d.className="relative",r.parentNode.insertBefore(d,r),d.appendChild(r),d.appendChild(i);const l=new Set;e.forEach((e=>{l.add(e.tag)})),distinctLabelsArray=Array.from(l);const c=document.getElementById("labelSelect");distinctLabelsArray.forEach((e=>{const t=document.createElement("option");t.value=e,t.text=e,c.add(t)}));var u=$(".multiple-select");u.multipleSelect({onCheckAll:function(){var t=u.multipleSelect("getSelects","text");const n=e.filter((e=>0===t.length||t.includes(e.tag))).map((e=>[e.userId,e.displayName])).sort(((e,t)=>e[1].localeCompare(t[1])));n.unshift(["UID","Name"]),$("#total_item").text(n.length-1+""),pe(n,"báº¡n bÃ¨")},onUncheckAll:function(){var e=[];e.unshift(["UID","Name"]),$("#total_item").text("0"),pe(e,"báº¡n bÃ¨")},onClick:function(t){var n=u.multipleSelect("getSelects","text");const a=e.filter((e=>{if(0===n.length){var t=[];return t.unshift(["UID","Name"]),$("#total_item").text("0"),void pe(t,"báº¡n bÃ¨")}return n.includes(e.tag)})),o=a.map((e=>[e.userId,e.displayName])).sort(((e,t)=>e[1].localeCompare(t[1])));o.unshift(["UID","Name"]),$("#total_item").text(o.length-1+""),pe(o,"báº¡n bÃ¨")}}),u.multipleSelect("checkAll")}))}}));let ne=[];var ae=0===$("#frameMain_th").width();function oe(){var e={delay:$("#delay").val(),delay1:$("#delay1").val(),delay2:$("#delay2").val(),delay3:$("#delay3").val(),isKiemTraHopLe:$("#chkKiemTraHopLe").iCheck("update")[0].checked,isKetBan:$("#chkKetBan").iCheck("update")[0].checked,isTuDongKetBan:$("#chkTuDongKetBan").iCheck("update")[0].checked,isDoiTen:$("#chkDoiTen").iCheck("update")[0].checked,isKetBanNhom:$("#chkKetBanNhom").iCheck("update")[0].checked};chrome.storage.local.set({settings:e})}function re(e,t){var n=e.querySelector(`td:nth-child(${t})`);return n?n.textContent.trim():""}function se(){const e=[];let t=0;0!==ne.length?ne.forEach((n=>{const a=new FileReader;a.onload=function(a){if(e.push({name:n.name,type:n.type,data:a.target.result}),t++,t===ne.length)try{localStorage.setItem("saved_selected_files",JSON.stringify(e))}catch(e){console.error("Error saving images to localStorage (likely too big):",e),"en"===o?toastr.warning("Images are too large to remember for next time."):toastr.warning("áº¢nh quÃ¡ lá»›n Ä‘á»ƒ lÆ°u láº¡i cho láº§n sau.")}},a.readAsDataURL(n)})):localStorage.removeItem("saved_selected_files")}function ie(){const e=document.getElementById("thumbnailPreview");document.getElementById("selectedItemsCount");e.innerHTML="",function(e){const t=document.getElementById("selectedItemsCount");t.setAttribute("data-translate","selected_files"),t.innerHTML=`<span data-translate="selected_files"><span class="text-blue-500 font-bold">${e}</span></span>`;const n=r[o]?.selected_files||"You have selected {0} files";t.innerHTML=n.replace("{0}",`<span class="text-blue-500 font-bold">${e}</span>`)}(ne.length);const t={"application/pdf":"ğŸ“˜","application/vnd.ms-excel":"ğŸ“Š","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"ğŸ“Š"};function n(e,t){const n=e.slice(e.lastIndexOf(".")),a=e.slice(0,e.lastIndexOf("."));if(a.length+n.length>=t)return e;return a.slice(0,t-n.length-3)+"..."+n}ne.length>0?$("#thumbnailPreview").height("155px"):$("#thumbnailPreview").height("0px"),ne.forEach(((a,o)=>{const r=a.type,s=document.createElement("div");s.className="thumbnail-container w-24 m-2 flex flex-col items-center",s.dataset.index=o;const i=document.createElement("button");if(i.className="delete-button",i.textContent="âŒ",i.addEventListener("click",(function(){!function(e){ne.splice(e,1);const t=new DataTransfer;ne.forEach((e=>t.items.add(e))),M.files=t.files,ie(),se()}(o)})),s.appendChild(i),r.startsWith("image/")){const e=new FileReader;e.onload=function(e){const t=document.createElement("img");t.src=e.target.result,t.className="w-full h-24 object-cover border border-gray-300 rounded-md shadow-md",s.appendChild(t);const o=document.createElement("span");o.className="mt-1 text-center text-xs truncate w-full",o.textContent=n(a.name,10),s.appendChild(o)},e.readAsDataURL(a)}else{const e=t[r]||"ğŸ“‘",o=document.createElement("div");o.className="w-full h-24 flex items-center justify-center border border-gray-300 rounded-md shadow-md text-4xl",o.textContent=e,s.appendChild(o);const i=document.createElement("span");i.className="mt-1 text-center text-xs truncate w-full",i.textContent=n(a.name,10),s.appendChild(i)}e.appendChild(s)}))}function de(e){var t=XLSX.read(new Uint8Array(e),{type:"array",cellDates:!0}),n=t.SheetNames[0],o=t.Sheets[n],r=XLSX.utils.sheet_to_json(o,{header:1,defval:" "});(r=(r=r.map((e=>e.map((e=>{if(e instanceof Date){const t=new Date(e.getTime()+432e5);return`${String(t.getDate()).padStart(2,"0")}/${String(t.getMonth()+1).padStart(2,"0")}/${t.getFullYear()}`}return e}))))).filter((e=>e.length>0&&(e[0]=String(e[0]).trim(),!0)))).map((function(e){return{phoneNumber:e[0]}}));!function(e,t){a=1,chrome.storage.local.set({DanhSach:e,type:t}),chrome.storage.local.set({IS_GUI_HOA_DON:a});var n=e[0].concat("Tráº¡ng ThÃ¡i");e.forEach((function(e){e.push("")})),"hÃ³a Ä‘Æ¡n"===t&&$("#tableCount").html(`Báº¡n Ä‘Ã£ chá»n <span class="text-blue-500 font-bold" id="total_item">${e.length-1}</span> ${t}.`);var o=document.getElementById("dataTableContainer");o.innerHTML="";var r=document.createElement("table");r.className="table table-striped table-bordered htCore w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400  w-screen";var s=document.createElement("thead");s.className="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400 sticky top-0";var i=document.createElement("tr"),d=document.createElement("th"),l=document.createElement("input");l.type="checkbox",l.addEventListener("change",(function(){W()})),l.className="form-checkbox h-4 w-4 text-green-600 cursor-pointer transition duration-150 ease-in-out hover:text-green-500",d.className="px-1 py-3 border border-gray-300 bg-gray-300 text-center cursor-pointer",d.appendChild(l),i.appendChild(d),n.forEach(((e,t)=>{if(""!==e.trim()){var n=document.createElement("th");n.className="px-1 py-3 border border-gray-300 bg-gray-300",n.textContent=e.trim(),i.appendChild(n),e.trim()}})),s.appendChild(i),r.appendChild(s);var c=document.createElement("tbody");c.className="h-25 overflow-y-auto";for(var u=1;u<e.length;u++){(i=document.createElement("tr")).addEventListener("click",(function(){W()})),i.className="border dark:bg-gray-300 darkborder-gray-700 hover:bg-gray-50 min-w-200";var p=document.createElement("td");p.addEventListener("click",(function(){W()})),(l=document.createElement("input")).type="checkbox",l.addEventListener("change",(function(){W()})),l.className="mt-1 form-checkbox h-4 w-4 text-green-600 cursor-pointer transition duration-150 ease-in-out hover:text-green-500",p.className="border border-gray-300 px-1 text-center cursor-pointer",p.style.width="55px",p.appendChild(l),i.appendChild(p),e[u].forEach((function(e,t){if(""!==e){var n=document.createElement("td");n.className="border border-gray-300 px-1",n.textContent=e,n.style.width="200px",i.appendChild(n)}}));var m=document.createElement("td");m.style.width="350px",m.className="border border-gray-300",i.appendChild(m),c.appendChild(i)}r.appendChild(c),o.appendChild(r),$("table").simpleCheckboxTable(),$("table tbody").dragcheck({container:"tr",onSelect:function(e,t){e.prop("checked",t),W()}})}(r,"hÃ³a Ä‘Æ¡n")}function le(e){const t=document.getElementById("dataTableContainer");t&&(t.innerHTML=`\n        <div class="flex flex-col items-center justify-center p-8 h-64">\n          <i class="fa fa-spinner fa-spin fa-3x text-blue-500 mb-4"></i>\n          <span class="text-gray-600 text-lg font-medium">${e}</span>\n        </div>\n      `,$("#tableCount").html(""))}function ce(e){const t=document.getElementById("dataTableContainer");t&&(t.innerHTML=`\n        <div class="flex flex-col items-center justify-center p-8 h-64 text-red-500">\n          <i class="fa fa-exclamation-circle fa-3x mb-4"></i>\n          <span class="text-lg font-medium">${e}</span>\n        </div>\n      `)}function ue(e){localStorage.removeItem(e)}function pe(t,n){a=0,chrome.storage.local.set({DanhSach:t,type:n}),chrome.storage.local.set({IS_GUI_HOA_DON:a});var r=t[0].concat("Status");t.forEach((function(e){e.push("")})),"khÃ¡ch hÃ ng"===n?$("#tableCount").html(`${"en"===o?"You have selected":"Báº¡n Ä‘Ã£ chá»n"} \n          <span class="text-blue-500 font-bold" id="total_item">(0/${t.length-1})</span> \n          ${"en"===o?"customer(s)":"khÃ¡ch hÃ ng"}.  \n          <button class="splitDataBtn bg-blue-500 text-white px-4 py-1 rounded text-sm">\n            <i class="fa fa-scissors" aria-hidden="true"></i> \n            ${"en"===o?"Split Data":"Chia tÃ¡ch dá»¯ liá»‡u"}\n          </button>`):"báº¡n bÃ¨"===n&&$("#tableCount").html(`${"en"===o?"You have selected":"Báº¡n Ä‘Ã£ chá»n"} \n          <span class="text-blue-500 font-bold" id="total_item">(0/${t.length-1})</span> \n          ${"en"===o?"friends":"báº¡n bÃ¨"}.\n          <button class="splitDataBtn bg-blue-500 text-white px-4 py-1 rounded text-sm">\n            <i class="fa fa-scissors" aria-hidden="true"></i> \n            ${"en"===o?"Split Data":"TÃ¡ch nhÃ³m"}\n          </button>`);var s=document.getElementById("dataTableContainer");s.innerHTML="";const i=document.createElement("div");i.id="filterContainer",i.className="flex gap-2 mb-2 p-2 bg-gray-50 rounded items-center";const d=document.createElement("input");d.type="text",d.id="searchInput",d.placeholder="en"===o?"Search...":"TÃ¬m kiáº¿m...",d.className="border border-gray-300 rounded px-2 py-1 text-sm flex-grow focus:outline-none focus:ring-1 focus:ring-blue-500";const l=document.createElement("select");l.id="filterLabelSelect",l.className="border border-gray-300 rounded px-2 py-1 text-sm section-content",l.style.width="200px";const c=document.createElement("option");c.value="",c.textContent="en"===o?"-- Filter by Label --":"-- Lá»c theo nhÃ£n --",l.appendChild(c),window.g_labels&&Array.isArray(window.g_labels)&&window.g_labels.forEach((e=>{let t=document.createElement("option");const n=e.name||e.text||e.id;t.value=n,t.textContent=n,l.appendChild(t)}));const u=document.createElement("button");u.textContent="âœ•",u.className="text-gray-500 hover:text-red-500 font-bold px-2",u.title="Clear Filter";const p=()=>{const t=e(d.value),n=l.value,a=m.querySelectorAll("tbody tr");let o=0;a.forEach((a=>{const r=a.cells[2],s=e(r?r.textContent:""),i=a.getAttribute("data-tag")||"";s.includes(t)&&(""===n||i===n)?(a.style.display="",o++):a.style.display="none"}));const r=document.getElementById("total_item");r&&(r.innerText=o);const s=m.querySelector(".no-data-row");s&&s.remove();const i=m.querySelector("thead");if(i){i.querySelectorAll("th").forEach((e=>{"status"===e.textContent.trim().toLowerCase()&&(e.style.width=0===o?"100%":"")}))}if(0===o){const e=m.querySelector("tbody");if(e){const t=document.createElement("tr");t.className="no-data-row border-none";const n=document.createElement("td");n.colSpan=10,n.innerHTML='\n            <div class="flex flex-col items-center justify-center py-10 w-full">\n                <i class="fa fa-search fa-4x mb-3 text-gray-300" aria-hidden="true"></i>\n                <p class="text-xl font-medium text-gray-500">KhÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u</p>\n                <p class="text-base text-gray-400 mb-4">Vui lÃ²ng thá»­ tá»« khÃ³a khÃ¡c</p>\n                 <button class="btn-reset-search bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-150 ease-in-out">\n                    <i class="fa fa-refresh mr-2"></i> Thá»­ tá»« khÃ³a khÃ¡c\n                </button>\n            </div>\n          ',n.className="text-center p-0 align-middle",n.style.width="100%",n.style.height="200px",t.appendChild(n),e.appendChild(t);const a=t.querySelector(".btn-reset-search");a&&a.addEventListener("click",(e=>{e.preventDefault(),d.value="",l.value="",p(),d.focus()}))}}};d.addEventListener("input",p),l.addEventListener("change",p),u.addEventListener("click",(()=>{d.value="",l.value="",p()})),i.appendChild(d),i.appendChild(l),i.appendChild(u),s.appendChild(i);var m=document.createElement("table");m.className="table table-striped table-bordered htCore w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400 myTable",m.style.width="100%";var g=document.createElement("thead");g.className="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400 sticky",g.style.top="-1px";var h=document.createElement("tr"),f=document.createElement("th");(v=document.createElement("input")).type="checkbox",v.addEventListener("change",(function(){W()})),v.className="form-checkbox h-4 w-4 text-green-600 cursor-pointer transition duration-150 ease-in-out hover:text-green-500",f.className="px-1 py-3 border border-gray-300 bg-gray-300 text-center cursor-pointer",f.appendChild(v),h.appendChild(f),r.forEach((function(e){var n=document.createElement("th");n.className="px-1 py-3 border border-gray-300 bg-gray-300",n.textContent=e,"status"===e.toLowerCase()&&t.length<=1&&(n.style.width="100%"),h.appendChild(n)})),g.appendChild(h),m.appendChild(g);var b=document.createElement("tbody");b.className="h-25 overflow-y-auto";for(var y=1;y<t.length;y++){(h=document.createElement("tr")).addEventListener("click",(function(){W()})),h.className="border dark:bg-gray-300 darkborder-gray-700 hover:bg-gray-50 min-w-200",t[y]&&t[y][2]&&h.setAttribute("data-tag",t[y][2]);var v,k=0,E=document.createElement("td");E.addEventListener("click",(function(){W()})),(v=document.createElement("input")).type="checkbox",v.addEventListener("change",(function(){W()})),v.className="mt-1 form-checkbox h-4 w-4 text-green-600 cursor-pointer transition duration-150 ease-in-out hover:text-green-500",E.className="border border-gray-300 px-1 text-center cursor-pointer",E.style.width="55px",E.appendChild(v),h.appendChild(E),t[y].forEach((function(e,t){if(!(k>1)){if(0==t&&1==x){(a=document.createElement("td")).className="border border-gray-300 px-1",a.style.width="200px";var n=document.createElement("a");n.href="#",n.textContent=e,n.setAttribute("data-id",e),n.className="td-group-info hover:underline text-blue-500 font-bold",n.style.cursor="pointer",n.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation();const t=this.getAttribute("data-id");fetchGroupMembers(t)})),a.appendChild(n),h.appendChild(a)}else{var a;(a=document.createElement("td")).className="border border-gray-300 px-1",a.textContent=e,a.style.width="200px",h.appendChild(a)}k++}}));var w=document.createElement("td");w.style.width="350px",w.className="border border-gray-300",h.appendChild(w),b.appendChild(h)}m.appendChild(b),s.appendChild(m),$("table").simpleCheckboxTable(),$(".td-group-info").on("click",(function(){var e=$(this).attr("data-id"),t=$(this).closest("td").next("td").text();$("#txtgroupname").val(t),$("#txtgroupuid").val(e),chrome.storage.local.get(["tabZalo"],(function(n){const a=n.tabZalo.id;chrome.tabs.sendMessage(a,{task:"GET_ALL_FRIENDS",option:10,id_group:e,name_group:t})}))})),$("table tbody").dragcheck({container:"tr",onSelect:function(e,t){e.prop("checked",t),W()}})}chrome.storage.local.set({DanhSach:[],isShowApp:ae}),$("#btnDanhSachTachNhom").on("click",(function(){document.getElementById("dropdown-menu2").classList.toggle("hidden"),"function"==typeof showChunksPopup?showChunksPopup():(console.error("showChunksPopup is undefined"),Swal.fire({text:"Chá»©c nÄƒng Ä‘ang táº£i, vui lÃ²ng thá»­ láº¡i sau giÃ¢y lÃ¡t.",icon:"info"}))})),$(".btngetfriend_nhom").on("click",(function(){$("#dropdown-menu2").addClass("hidden");var e=$(this).attr("data-option");return 1==e?(le("en"===o?"Fetching friends list...":"Äang láº¥y danh sÃ¡ch báº¡n bÃ¨..."),void chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo.id;chrome.runtime.sendMessage({action:"GET_FRIENDS_API",tabId:t},(e=>{if(chrome.runtime.lastError)ce("Lá»—i: "+chrome.runtime.lastError.message),toastr.error("Lá»—i: "+chrome.runtime.lastError.message);else if(e&&e.success){void 0!==x&&(x=0),toastr.success(`ÄÃ£ tÃ¬m tháº¥y ${e.count} báº¡n bÃ¨!`);const t=e.data,n=["UID","NAME"];Array.isArray(t)?(window.currentGroupIds=[],i().then((()=>{const e=t.map((e=>[e.userId||e.uid||"",e.displayName||e.name||"No Name",e.tag||""]));pe([n,...e],"báº¡n bÃ¨"),$("#selectedItemsCount").html("en"===o?'Selected <span class="text-blue-500 font-bold">0</span> items':'Báº¡n Ä‘Ã£ chá»n <span class="text-blue-500 font-bold">0</span> báº¡n bÃ¨')}))):(ce("Dá»¯ liá»‡u tráº£ vá» khÃ´ng Ä‘Ãºng Ä‘á»‹nh dáº¡ng."),toastr.error("Dá»¯ liá»‡u tráº£ vá» khÃ´ng Ä‘Ãºng Ä‘á»‹nh dáº¡ng."))}else ce("Tháº¥t báº¡i: "+(e?e.error:"Lá»—i khÃ´ng xÃ¡c Ä‘á»‹nh")),toastr.error("Tháº¥t báº¡i: "+(e?e.error:"Lá»—i khÃ´ng xÃ¡c Ä‘á»‹nh"))}))}))):3==e?(le("en"===o?"Fetching groups via API...":"Äang láº¥y danh sÃ¡ch nhÃ³m..."),void chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo?e.tabZalo.id:null;chrome.runtime.sendMessage({action:"GET_GROUPS_API",tabId:t},(e=>{if(chrome.runtime.lastError)ce("Lá»—i: "+chrome.runtime.lastError.message),toastr.error("Lá»—i: "+chrome.runtime.lastError.message);else if(e&&e.success){void 0!==x&&(x=1),toastr.success("en"===o?`Found ${e.count} groups!`:`ÄÃ£ tÃ¬m tháº¥y ${e.count} nhÃ³m!`);const t=e.data,n=["UID","NAME"];Array.isArray(t)?(window.currentGroupIds=t.map((e=>e.id&&e.id.startsWith("g")?e.id:"g"+e.id)),i().then((()=>{const e=t.map((e=>[e.id&&e.id.startsWith("g")?e.id:"g"+e.id,e.name||"No Name",e.tag||""]));pe([n,...e],"báº¡n bÃ¨")}))):(ce("Dá»¯ liá»‡u tráº£ vá» khÃ´ng Ä‘Ãºng Ä‘á»‹nh dáº¡ng."),toastr.error("Dá»¯ liá»‡u tráº£ vá» khÃ´ng Ä‘Ãºng Ä‘á»‹nh dáº¡ng."))}else ce("Tháº¥t báº¡i: "+(e?e.error:"Lá»—i khÃ´ng xÃ¡c Ä‘á»‹nh")),toastr.error("Tháº¥t báº¡i: "+(e?e.error:"Lá»—i khÃ´ng xÃ¡c Ä‘á»‹nh"))}))}))):2==e?(le("en"===o?"Fetching friends and groups...":"Äang láº¥y danh sÃ¡ch báº¡n bÃ¨ vÃ  nhÃ³m..."),void chrome.storage.local.get(["tabZalo"],(function(e){const t=e.tabZalo?e.tabZalo.id:null,n=e=>new Promise(((n,a)=>{chrome.runtime.sendMessage({action:e,tabId:t},(e=>{chrome.runtime.lastError?a(chrome.runtime.lastError.message):e&&e.success?n(e):a(e?e.error:"Unknown error")}))}));Promise.allSettled([n("GET_FRIENDS_API"),n("GET_GROUPS_API")]).then((e=>{const t=e[0],n=e[1];let a=[],o=[];if("fulfilled"===t.status){const e=t.value.data;Array.isArray(e)&&a.push(...e.map((e=>({id:e.userId||e.uid,name:e.displayName||e.name||"No Name",tag:e.tag||"",type:"friend"}))))}else o.push("Friends: "+t.reason);if("fulfilled"===n.status){const e=n.value.data;Array.isArray(e)&&a.push(...e.map((e=>({id:e.id&&e.id.startsWith("g")?e.id:"g"+e.id,name:e.name||"No Name",tag:e.tag||"",type:"group"}))))}else o.push("Groups: "+n.reason);a.length>0?(toastr.success(`ÄÃ£ tÃ¬m tháº¥y ${a.length} má»¥c (Báº¡n bÃ¨ + NhÃ³m)!`),o.length>0&&toastr.warning("Má»™t sá»‘ dá»¯ liá»‡u khÃ´ng láº¥y Ä‘Æ°á»£c: "+o.join("; ")),window.currentGroupIds=[],a.sort(((e,t)=>e.name.localeCompare(t.name))),i().then((()=>{const e=[["UID","NAME"],...a.map((e=>[e.id,e.name,e.tag]))];void 0!==x&&(x=0),pe(e,"báº¡n bÃ¨")}))):(ce("KhÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u hoáº·c cÃ³ lá»—i xáº£y ra."),o.length>0&&toastr.error("Lá»—i: "+o.join("; ")))}))}))):void chrome.storage.local.get(["tabZalo"],(function(t){const n=t.tabZalo.id;chrome.tabs.sendMessage(n,{task:"GET_LIST_FRIEDITEM",option:e})}))})),window.fetchGroupMembers=function(e){if(!e)return void console.error("fetchGroupMembers called with empty groupId");const t=e.startsWith("g")?e.substring(1):e;le("en"===o?"Fetching group members...":"Äang láº¥y danh sÃ¡ch thÃ nh viÃªn nhÃ³m..."),chrome.storage.local.get(["tabZalo"],(function(e){const n=e.tabZalo?e.tabZalo.id:null;chrome.runtime.sendMessage({action:"OPEN_GROUP_CHAT",tabId:n,groupId:t},(e=>{if(chrome.runtime.lastError)ce("Lá»—i: "+chrome.runtime.lastError.message),toastr.error("Lá»—i: "+chrome.runtime.lastError.message);else if(e&&e.success){toastr.success("en"===o?`Found ${e.count} members!`:`ÄÃ£ tÃ¬m tháº¥y ${e.count} thÃ nh viÃªn!`);const t=e.data,n=["UID","NAME"];if(Array.isArray(t)){const e=[n,...t.map((e=>[e.id||"",e.name||"No Name",e.tag||""]))];void 0!==x&&(x=0),pe(e,"báº¡n bÃ¨")}else ce("Dá»¯ liá»‡u tráº£ vá» khÃ´ng Ä‘Ãºng Ä‘á»‹nh dáº¡ng."),toastr.error("Dá»¯ liá»‡u tráº£ vá» khÃ´ng Ä‘Ãºng Ä‘á»‹nh dáº¡ng.")}else ce("Tháº¥t báº¡i: "+(e?e.error:"Lá»—i khÃ´ng xÃ¡c Ä‘á»‹nh")),toastr.error("Tháº¥t báº¡i: "+(e?e.error:"Lá»—i khÃ´ng xÃ¡c Ä‘á»‹nh"))}))}))},$("#delay, #delay1, #delay2, #delay3").on("change",oe),$("#chkKetBan, #chkTuDongKetBan, #chkDoiTen, #chkKetBanNhom").on("ifChanged",(function(e){oe()})),$("#chkKiemTraHopLe").on("ifChanged",(function(e){oe()})),$("#chkShowModal").on("ifChanged",(function(e){var t=$("#chkShowModal").iCheck("update")[0].checked;t?toastr.info(""+("en"===o?"Successfully enabled show modal.":"ÄÃ£ báº­t show modal thÃ nh cÃ´ng, báº¡n Æ¡i.")):toastr.error(""+("en"===o?"Successfully disabled show modal.":"ÄÃ£ táº¯t áº©n show modal, báº¡n Æ¡i.")),chrome.storage.local.get(["tabZalo"],(function(e){const n=e.tabZalo.id;chrome.tabs.sendMessage(n,{task:"REQUEST_SHOW_MODAL",isShowModal:t})}))})),$("#chkAutoScroll").on("ifChanged",(function(e){$("#chkAutoScroll").iCheck("update")[0].checked?toastr.info(""+("en"===o?"Auto-scroll mode enabled.":"ÄÃ£ báº­t cháº¿ Ä‘á»™ tá»± Ä‘á»™ng cuá»™n, báº¡n Æ¡i.")):toastr.error(""+("en"===o?"Auto-scroll mode disabled.":"ÄÃ£ táº¯t cháº¿ Ä‘á»™ tá»± Ä‘á»™ng cuá»™n, báº¡n Æ¡i."))})),u.addEventListener("click",(()=>{var e=function(){var e=document.querySelector("table");if(!e)return[];var t=e.querySelector("#dataTableContainer tbody");if(!t)return[];var n=t.querySelectorAll("tr"),o=[];return n.forEach((e=>{var t=e.querySelector('td:nth-child(1) input[type="checkbox"]');if(t&&t.checked)if(0==a){var n=[e.querySelector("td:nth-child(2)").textContent,e.querySelector("td:nth-child(3)").textContent];o.push(n)}else n=[re(e,2),re(e,3),re(e,4),re(e,5),re(e,6),re(e,7)],o.push(n)})),JSON.stringify(o),o}();let t=0;if($("#dataTableContainer thead").length&&$("#dataTableContainer thead th:nth-child(3)").each((function(){var e=$(this).text().trim();"ná»™i dung"==e.toLowerCase()&&(t=1)})),0!==e.length){chrome.storage.local.set({DanhSach:e});var n=$("#delay").val(),r=$("#delay1").val(),s=$("#delay2").val(),i=$("#delay3").val();if(""==n.trim()||Number(n)<=0)return"en"==o?toastr.error("Invalid configuration input: not a number or <= 0."):toastr.error("ThÃ´ng sá»‘ nháº­p cáº¥u hÃ¬nh khÃ´ng há»£p lá»‡, khÃ´ng pháº£i sá»‘, hoáº·c < 0, em trai."),void $("#delay").focus();if(""==r.trim()||Number(r)<=0)return"en"==o?toastr.error("Invalid configuration input: not a number or <= 0."):toastr.error("ThÃ´ng sá»‘ nháº­p cáº¥u hÃ¬nh khÃ´ng há»£p lá»‡, khÃ´ng pháº£i sá»‘, hoáº·c < 0, em trai."),void $("#delay1").focus();if(""==s.trim()||Number(s)<=0)return"en"==o?toastr.error("Invalid configuration input: not a number or <= 0."):toastr.error("ThÃ´ng sá»‘ nháº­p cáº¥u hÃ¬nh khÃ´ng há»£p lá»‡, khÃ´ng pháº£i sá»‘, hoáº·c < 0, em trai."),void $("#delay2").focus();if(""==i.trim()||Number(i)<=0)return"en"==o?toastr.error("Invalid configuration input: not a number or <= 0."):toastr.error("ThÃ´ng sá»‘ nháº­p cáº¥u hÃ¬nh khÃ´ng há»£p lá»‡, khÃ´ng pháº£i sá»‘, hoáº·c < 0, em trai."),void $("#delay3").focus();oe();var d=$("#tagSelect").val();chrome.storage.local.set({IS_PHAT_CODE:t}),chrome.storage.local.set({IS_GUI_HOA_DON:a}),chrome.storage.local.set({TAG_PHANLOAI:d}),document.querySelectorAll("td:nth-child(4)").forEach((function(e){}));var l=$("#chkKetBan").iCheck("update")[0].checked,p=$("#chkKiemTraHopLe").iCheck("update")[0].checked;l&&p?"en"==o?toastr.error("Please select only one function: either phone number validation or add friend."):toastr.error("Vui lÃ²ng chá»‰ chá»n 1 trong 2 chá»©c nÄƒng kiá»ƒm tra sá»‘ Ä‘iá»‡n thoáº¡i hoáº·c kÃªt báº¡n."):chrome.storage.local.get("DanhSach",(function(e){if(0==e.DanhSach.length)return void("en"==o?toastr.error("You haven't selected any list to send messages."):toastr.error("Báº¡n chÆ°a chá»n danh sÃ¡ch Ä‘á»ƒ gá»Ÿi tin nháº¯n."));var n=e.DanhSach,r=c.value,s=$("#chkKiemTraHopLe").iCheck("update")[0].checked,i=$("#chkKetBan").iCheck("update")[0].checked;if(!1===s&&!1===i&&0===t&&0==r.length)return"en"==o?toastr.error("You haven't entered the message content."):toastr.error("ChÆ°a nháº­p ná»™i dung tin nháº¯n, báº¡n Æ¡i."),void c.focus();const d=ne;u.style.display="none",m.style.display="block";let l=$("#tableCount").text().toLowerCase(),p=l.includes("friends")||l.includes("báº¡n bÃ¨")?"BAN_BE":"KHACH_HANG";e={phone:n,message:r};const g=[];(d.length>0?Array.from(d).forEach((t=>{const n=new FileReader;n.onload=()=>{g.push({fileData:n.result,fileName:t.name}),g.length===d.length&&chrome.runtime.sendMessage({task:"SEND_MESSAGE_TO_FRIENDS",data:e,files:g,type:p})},n.readAsDataURL(t)})):chrome.runtime.sendMessage({task:"SEND_MESSAGE_TO_FRIENDS",data:e,files:[],type:p}),1==a)?document.querySelectorAll(".htCore tbody tr td:nth-child(8)").forEach((function(e){e.textContent=""})):document.querySelectorAll(".htCore tbody tr td:nth-child(4)").forEach((function(e){e.textContent=""}))}))}else"en"==o?toastr.error("You haven't selected any list to perform."):toastr.error("Báº¡n chÆ°a chá»n danh sÃ¡ch Ä‘á»ƒ thá»±c hiá»‡n.")})),m.addEventListener("click",(()=>{u.style.display="block",m.style.display="none","en"==o?toastr.success("Successfully stopped the execution."):toastr.success("ÄÃ£ dá»«ng thá»±c hiá»‡n thÃ nh cÃ´ng, báº¡n Æ¡i."),chrome.runtime.sendMessage({task:"stop_send_message"})})),B.addEventListener("click",(function(){a=0,O.click()})),T.addEventListener("click",(function(){a=1,O.click()})),D.addEventListener("click",(function(){M.click()})),M.addEventListener("change",(function(e){ne=Array.from(e.target.files),ie(),se()})),function(){const e=localStorage.getItem("saved_selected_files");if(e)try{const t=JSON.parse(e);ne=t.map((e=>function(e,t){for(var n=e.split(","),a=n[0].match(/:(.*?);/)[1],o=atob(n[1]),r=o.length,s=new Uint8Array(r);r--;)s[r]=o.charCodeAt(r);return new File([s],t,{type:a})}(e.data,e.name))),ie()}catch(e){console.error("Error loading images from localStorage:",e),localStorage.removeItem("saved_selected_files")}}(),O.addEventListener("change",(function(e){var t=e.target.files[0],n=new FileReader;if(t){var o=t.name.split(".").pop().toLowerCase();n.onload=function(e){var t=e.target.result;if("txt"===o)t.includes("|")?function(e){var t=e.split("\n").map((function(e){var t=e.split("|").map((function(e){return e.trim()}));return 2===t.length&&t[1].length>0?t:null})).filter((function(e){return null!==e})),n=new Set;t=t.filter((function(e){var t=e[0];return!n.has(t)&&(n.add(t),!0)})),pe([["Phone","Ná»™i dung"],...t],"khÃ¡ch hÃ ng")}(t):function(e){var t=e.split("\n").map((function(e){return e.split(",").map((function(e){return e.trim()}))})).filter((function(e){return e.length>0&&e.some((function(e){return e.length>0}))})),n=new Set;t=t.filter((function(e){if(e.length>0){var t=e[0];return!n.has(t)&&(n.add(t),!0)}return!1})),pe([["Phone","Name"],...t],"khÃ¡ch hÃ ng")}(t);else if("xlsx"===o){var n=XLSX.read(new Uint8Array(t),{type:"array"}),r=n.SheetNames[0],s=n.Sheets[r],i=XLSX.utils.sheet_to_json(s,{header:1});if(1==a)return void de(t);"ná»™i dung"==i[0][1].trim().toLowerCase()?function(e){var t=XLSX.read(new Uint8Array(e),{type:"array"}),n=t.SheetNames[0],a=t.Sheets[n],o=XLSX.utils.sheet_to_json(a,{header:1}),r=new Set;o=o.filter((e=>e.length>=2&&e[1].trim().length>0&&(e[0]=String(e[0]).trim(),!r.has(e[0])&&(r.add(e[0]),!0)))),pe([...o],"khÃ¡ch hÃ ng")}(t):function(e){var t=XLSX.read(new Uint8Array(e),{type:"array"}),n=t.SheetNames[0],a=t.Sheets[n],o=XLSX.utils.sheet_to_json(a,{header:1}),r=new Set;(o=o.filter((e=>e.length>0&&(e[0]=String(e[0]).trim(),!r.has(e[0])&&(r.add(e[0]),!0))))).map((function(e){return{phoneNumber:e[0]}})),pe(o,"khÃ¡ch hÃ ng")}(t)}},"txt"===o?n.readAsText(t):"xlsx"===o&&n.readAsArrayBuffer(t),O.value=""}})),$(document).on("click",".splitDataBtn",(function(){const e=function(){const e=document.querySelector(".myTable tbody");return e?Array.from(e.querySelectorAll("tr")).map((e=>{const t=e.querySelectorAll("td");return{uid:t[1]?.innerText.trim(),name:t[2]?.innerText.trim()}})).filter((e=>e.uid&&e.name)):[]}();0!==e.length?Swal.fire({title:`<span style="font-size: 16px; color: #fff">${"en"===o?"Split Data":"Chia tÃ¡ch dá»¯ liá»‡u"}</span>`,html:`\n        <input id="swal-input1" type="number" placeholder="${"en"===o?"Number of rows per chunk":"Sá»‘ dÃ²ng má»—i pháº§n"}" class="swal2-input text-xs" min="1">\n        <input id="swal-input2" type="text" placeholder="${"en"===o?"Alias name (group)":"TÃªn alias (group)"}" class="swal2-input text-xs">\n      `,focusConfirm:!1,showCancelButton:!0,showCloseButton:!0,showDenyButton:!0,confirmButtonText:`<span class="text-xs"><i class="fa fa-scissors" aria-hidden="true"></i> ${"en"===o?"Split Data":"Chia dá»¯ liá»‡u"}</span>`,denyButtonText:`<span id="btnMoDanhSach" class="text-xs"><i class="fa fa-table" aria-hidden="true"></i> ${"en"===o?"Open List":"Má»Ÿ danh sÃ¡ch"}</span>`,cancelButtonText:`<span>${"en"===o?"Close":"ÄÃ³ng"}</span>`,customClass:{popup:"text-xs"},preConfirm:()=>{const e=document.getElementById("swal-input1").value,t=document.getElementById("swal-input2").value;return(!e||e<=0)&&Swal.showValidationMessage("Vui lÃ²ng nháº­p sá»‘ dÆ°Æ¡ng cho sá»‘ dÃ²ng má»—i pháº§n!"),t||Swal.showValidationMessage("Vui lÃ²ng nháº­p tÃªn alias (group)!"),{rowsPerChunk:parseInt(e,10),alias:t.trim()}}}).then((t=>{if(t.isDenied)showChunksPopup();else if(t.isConfirmed){const{rowsPerChunk:n,alias:a}=t.value,o=function(e,t){const n=[];for(let a=0;a<e.length;a+=t)n.push(e.slice(a,a+t));return n}(e.filter((e=>"TÃ i khoáº£n bá»‹ khoÃ¡"!==e.name&&"TÃ i khoáº£n ngá»«ng hoáº¡t Ä‘á»™ng"!==e.name&&"Deactivated"!==e.name)),n);!function(e,t){const n=`Group_${t}_`;let a=Object.keys(localStorage).filter((e=>e.startsWith(n))).length;e.forEach(((e,t)=>{const o=`${n}${a+t+1}`;localStorage.setItem(o,JSON.stringify(e))}))}(o,a),Swal.fire({icon:"success",title:`Dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c chia nhá» thÃ nh ${o.length} pháº§n trong group "${a}"`,timer:1500,showConfirmButton:!1,customClass:{popup:"text-md"}}).then((()=>{showChunksPopup()}))}})):Swal.fire({text:"en"===o?"No data in the table!":"KhÃ´ng cÃ³ dá»¯ liá»‡u trong báº£ng!",icon:"info",confirmButtonText:'<span class="text-xs">OK</span>',customClass:{popup:"text-xs"}})})),window.showChunksPopup=function(){const e=Object.keys(localStorage).filter((e=>e.startsWith("Group_")));if(0===e.length)return void Swal.fire({text:"KhÃ´ng cÃ³ dá»¯ liá»‡u Ä‘Ã£ chia nhá».",icon:"info",confirmButtonText:'<span class="text-xs">OK</span>',customClass:{popup:"text-xs"}});e.sort(((e,t)=>{const n=e.split("_"),a=t.split("_"),o=n.slice(1,n.length-1).join("_"),r=a.slice(1,a.length-1).join("_"),s=parseInt(n[n.length-1],10),i=parseInt(a[a.length-1],10);return o===r?s-i:o.localeCompare(r)}));const t={};e.forEach((e=>{const n=e.split("_")[1];t[n]||(t[n]=[]),t[n].push(e)}));const n=Object.keys(t).sort(((e,t)=>e.localeCompare(t)));let a='<div class="space-y-2 text-xs text-left">';n.forEach((e=>{t[e].sort(((e,t)=>parseInt(e.split("_")[2],10)-parseInt(t.split("_")[2],10))),a+=`<div class="border p-2 rounded bg-gray-50 dark:bg-gray-700">\n          <div class="flex justify-between items-center mb-2">\n            <span class="font-bold" style="color: blue;">${"en"===o?"Data Group: ":"NhÃ³m dá»¯ liá»‡u: "}${e}</span>\n            <button data-alias="${e}" class="delete-group-btn bg-gray-600 hover:bg-gray-700 text-white text-xs px-2 py-1 rounded">\n              ${"en"===o?"Delete group":"XÃ³a group"}\n            </button>\n          </div>`,t[e].forEach((e=>{const t=JSON.parse(localStorage.getItem(e));a+=`\n          <div class="flex items-center justify-between border p-1 rounded bg-gray-100 dark:bg-gray-800">\n            <div class="flex items-center space-x-2" style="width: 300px;">\n              <input type="checkbox" class="chunk-checkbox" data-key="${e}">\n              <span style="color: #000;">${e}</span>\n            </div>\n            <div class="flex items-center space-x-2 w-full">\n              <span class="ml-auto" style="color: #000;">${"en"===o?"Rows: ":"Sá»‘ dÃ²ng: "}${t.length}</span>\n              <button data-key="${e}" data-length="${t.length}" class="choose-btn bg-green-500 hover:bg-green-600 text-white text-xs px-2 py-1 rounded">\n                ${"en"===o?"Select":"Chá»n"}\n              </button>\n               <button data-key="${e}" data-length="${t.length}" class="choose-delete-btn bg-blue-500 hover:bg-blue-600 text-white text-xs px-2 py-1 rounded">\n                ${"en"===o?"Select and delete":"Chá»n vÃ  xÃ³a"}\n              </button>\n              <button data-key="${e}" class="delete-btn bg-red-500 hover:bg-red-600 text-white text-xs px-2 py-1 rounded">\n                ${"en"===o?"Delete":"XÃ³a"}\n              </button>\n            </div>\n          </div>`})),a+="</div>"})),a+="</div>",a+=`\n       <div class="mt-4 text-center space-x-2">\n        <button id="selectMultipleBtn" class="bg-blue-500 hover:bg-blue-600 text-white text-xs px-3 py-1 rounded">\n          <i class="fa fa-check-circle-o" aria-hidden="true"></i> ${"en"===o?"Select selected groups":"Chá»n cÃ¡c group Ä‘Ã£ chá»n"}\n        </button>\n        <button id="deleteMultipleBtn" class="bg-red-600 hover:bg-red-700 text-white text-xs px-3 py-1 rounded">\n          <i class="fa fa-trash-o" aria-hidden="true"></i> ${"en"===o?"Delete selected groups":"XÃ³a cÃ¡c group Ä‘Ã£ chá»n"}\n        </button>\n      </div>`,Swal.fire({title:`<span style="color: #fff; font-size: 16px;">${"en"===o?"Data List":"Danh sÃ¡ch dá»¯ liá»‡u"}</span>`,html:a,showConfirmButton:!1,width:"600px",showDenyButton:!0,showCloseButton:!0,denyButtonText:`<span class="text-xs"><i class="fa fa-trash-o" aria-hidden="true"></i> ${"en"===o?"Delete All":"XÃ³a háº¿t táº¥t cáº£"}</span>`,customClass:{popup:"text-xs"},preDeny:()=>(Swal.fire({title:""+("en"===o?"Confirm":"XÃ¡c nháº­n"),text:""+("en"===o?"Are you sure you want to delete all groups?":"Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a háº¿t táº¥t cáº£ cÃ¡c group khÃ´ng?"),icon:"warning",showCancelButton:!0,confirmButtonText:"XÃ³a háº¿t",cancelButtonText:"Há»§y"}).then((t=>{t.isConfirmed&&(e.forEach((e=>localStorage.removeItem(e))),Swal.fire({icon:"success",title:"Deleted All",timer:1e3,showConfirmButton:!1}),showChunksPopup())})),!1),didOpen:()=>{Swal.getPopup().querySelectorAll(".choose-btn").forEach((e=>{e.addEventListener("click",(e=>{const t=e.target.getAttribute("data-key"),n=JSON.parse(localStorage.getItem(t)),a=n.map((e=>[e.uid,e.name,""]));$("#total_item").html(`(0/${n.length}) - ${t}`),pe([["UID","NAME"],...a],"báº¡n bÃ¨"),Swal.close()}))})),Swal.getPopup().querySelectorAll(".choose-delete-btn").forEach((e=>{e.addEventListener("click",(e=>{const t=e.target.getAttribute("data-key");Swal.fire({title:"Confirm",text:`Select and Delete ${t}?`,showCancelButton:!0,icon:"question"}).then((e=>{if(e.isConfirmed){pe([["UID","NAME"],...JSON.parse(localStorage.getItem(t)).map((e=>[e.uid,e.name,""]))],"báº¡n bÃ¨"),ue(t),Swal.close()}}))}))})),Swal.getPopup().querySelectorAll(".delete-btn").forEach((e=>{e.addEventListener("click",(e=>{ue(e.target.getAttribute("data-key")),showChunksPopup()}))})),Swal.getPopup().querySelector("#selectMultipleBtn").addEventListener("click",(()=>{const e=Array.from(Swal.getPopup().querySelectorAll(".chunk-checkbox:checked")).map((e=>e.getAttribute("data-key")));if(e.length>0){let t=[];e.forEach((e=>{t=t.concat(JSON.parse(localStorage.getItem(e)))}));pe([["UID","NAME"],...t.map((e=>[e.uid,e.name,""]))],"báº¡n bÃ¨"),Swal.close()}})),Swal.getPopup().querySelector("#deleteMultipleBtn").addEventListener("click",(()=>{const e=Array.from(Swal.getPopup().querySelectorAll(".chunk-checkbox:checked")).map((e=>e.getAttribute("data-key")));e.length>0&&(e.forEach((e=>ue(e))),showChunksPopup())})),Swal.getPopup().querySelectorAll(".delete-group-btn").forEach((e=>{e.addEventListener("click",(e=>{!function(e){const t=`Group_${e}_`;Object.keys(localStorage).filter((e=>e.startsWith(t))).forEach((e=>localStorage.removeItem(e)))}(e.target.getAttribute("data-alias")),showChunksPopup()}))}))}})}}))})();